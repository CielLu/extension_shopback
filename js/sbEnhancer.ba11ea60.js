webpackJsonp([9],{0:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=r(52);n.FONT_FAMILY="Roboto, Helvetica, arial, sans-serif",n.ACTIVATE_TAOBAO_PRODUCT_FROM_SB="ACTIVATE_TAOBAO_PRODUCT_FROM_SB",n.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS",n.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR",n.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS",n.FETCH_TAOBAO_PRODUCT_DEEP_LINK_ERROR="FETCH_TAOBAO_PRODUCT_DEEP_LINK_ERROR",n.DETECT_STAND_DOWN_AFFILIATE_NETWORK="DETECT_STAND_DOWN_AFFILIATE_NETWORK",n.DETACH_STAND_DOWN_AFFILIATE_NETWORK="DETACH_STAND_DOWN_AFFILIATE_NETWORK",n.CLOSE_ACTIVATED_MERCHANT_NOTIFIER="CLOSE_ACTIVATED_MERCHANT_NOTIFIER",n.DELETE_EXPIRED_ACTIVATED_MERCHANT="DELETE_EXPIRED_ACTIVATED_MERCHANT",n.VISIT_ACTIVATED_MERCHANT_NOTIFIER="VISIT_ACTIVATED_MERCHANT_NOTIFIER",n.GET_EXTENSION_SETTINGS_SUCCEESS="GET_EXTENSION_SETTINGS_SUCCEESS",n.t="ps",n.START_ACTIVATE_TAOBAO_PRODUCT="START_ACTIVATE_TAOBAO_PRODUCT",n.STAND_DOWN_MERCHANT_NOTIFIER="STAND_DOWN_MERCHANT_NOTIFIER",n.FETCH_TOP_MERCHANTS_SUCCESS="FETCH_TOP_MERCHANTS_SUCCESS",n.CLEAR_DIRTY_LOGIN_FROM_MENU="CLEAR_DIRTY_LOGIN_FROM_MENU",n.STAND_UP_MERCHANT_NOTIFIER="STAND_UP_MERCHANT_NOTIFIER",n.FETCH_TAOBAO_PRODUCT_ERROR="FETCH_TAOBAO_PRODUCT_ERROR",n.CAPTURE_MERCHANT_PAGE_HTML="CAPTURE_MERCHANT_PAGE_HTML",n.OPEN_BROWESER_SETTING_PAGE="OPEN_BROWESER_SETTING_PAGE",n.DEACTIVATE_TAOBAO_PRODUCT="DEACTIVATE_TAOBAO_PRODUCT",n.FETCH_TOP_MERCHANTS_ERROR="FETCH_TOP_MERCHANTS_ERROR",n.REFETCH_MERCHANTS_SUCCESS="REFETCH_MERCHANTS_SUCCESS",n.n="ll",n.r="pwd",n.DETECCT_PERMISSION_CHANGE="DETECCT_PERMISSION_CHANGE",n.CLOSE_PERMISSION_NOTIFIER="CLOSE_PERMISSION_NOTIFIER",n.RESET_PERMISSION_NOTIFIER="RESET_PERMISSION_NOTIFIER",n.CLEAN_INVALID_PERMISSION="CLEAN_INVALID_PERMISSION",n.CLOSE_MERCHANT_NOTIFIER="CLOSE_MERCHANT_NOTIFIER",n.FETCH_USER_INFO_SUCCESS="FETCH_USER_INFO_SUCCESS",n.FETCH_MERCHANTS_SUCCESS="FETCH_MERCHANTS_SUCCESS",n.SYNC_USER_FROM_SHOPBACK="SYNC_USER_FROM_SHOPBACK",n.DETECT_SB_REDIRECT_PAGE="DETECT_SB_REDIRECT_PAGE",n.OPEN_TAOBAO_SEARCH_BAR="OPEN_TAOBAO_SEARCH_BAR",n.e="cp",n.FETCH_MERCHANTS_ERROR="FETCH_MERCHANTS_ERROR",n.FETCH_USER_INFO_ERROR="FETCH_USER_INFO_ERROR",n.DIRTY_LOGIN_FROM_MENU="DIRTY_LOGIN_FROM_MENU",n.FETCH_SETTINGS_ERROR="FETCH_SETTINGS_ERROR",n.FETCH_TOP_MERCHANTS="FETCH_TOP_MERCHANTS",n.FETCH_DEALS_SUCCESS="FETCH_DEALS_SUCCESS",n.DEEP_LINK_REDIRECT="DEEP_LINK_REDIRECT",n.ADD_DIRTY_REDIRECT="ADD_DIRTY_REDIRECT",n.FETCH_DEALS_ERROR="FETCH_DEALS_ERROR",n.CLEAN_ACTIVATION="CLEAN_ACTIVATION",n.FETCH_CC_SUCCESS="FETCH_CC_SUCCESS",n.DROP_COOKIE_DONE="DROP_COOKIE_DONE",n.SET_COOKIE_DONE="SET_COOKIE_DONE",n.SET_COOKIE_FAIL="SET_COOKIE_FAIL",n.i="netstat",n.DISABLE_TRACKING="DISABLE_TRACKING",n.ENABLE_TRACKING="ENABLE_TRACKING",n.TOGGLE_TRACKING="TOGGLE_TRACKING",n.FETCH_USER_INFO="FETCH_USER_INFO",n.FETCH_CC_ERROR="FETCH_CC_ERROR",n.START_ACTIVATE="START_ACTIVATE",n.GEN_SB_EXT_ID="GEN_SB_EXT_ID",n.OPEN_POPUP_UI="OPEN_POPUP_UI",n.LOGIN_NOT_OK="LOGIN_NOT_OK",n.FETCH_DEALS="FETCH_DEALS",n.SWITCH_USER="SWITCH_USER",n.DE_ACTIVATE="DE_ACTIVATE",n.o="mv",n.API_ERROR="API_ERROR",n.LOGIN_OK="LOGIN_OK",n.LOGOUT="LOGOUT",n.OPEN_NEW_TAB="OPEN_NEW_TAB",n.CLOSE_TAB="CLOSE_TAB",n.REFRESH_ACCESS_TOKEN_SUCCESS="REFRESH_ACCESS_TOKEN_SUCCESS",n.TOGGLE_LOGGER="TOGGLE_LOGGER",n.EVENT_EXT_CLICK="EVENT_EXT_CLICK",n.EVENT_EXT_LOGIN="EVENT_EXT_LOGIN",n.EVENT_EXT_SEARCH="EVENT_EXT_SEARCH",n.EVENT_EXT_UPDATED="EVENT_EXT_UPDATED",n.EVENT_EXT_REDIRECT="EVENT_EXT_REDIRECT",n.EVENT_EXT_MENU_OPEN="EVENT_EXT_MENU_OPEN",n.EVENT_EXT_INSTALLED="EVENT_EXT_INSTALLED",n.EVENT_EXT_PAGE_VISITED="EVENT_EXT_PAGE_VISITED",n.EVENT_EXT_SERP_VISITED="EVENT_EXT_SERP_VISITED",n.EVENT_EXT_SERP_CLICKED="EVENT_EXT_SERP_CLICKED",n.EVENT_EXT_NOTIFIER_PROMPT="EVENT_EXT_NOTIFIER_PROMPT",n.EVENT_EXT_APPLY_COUPON_CODE="EVENT_EXT_APPLY_COUPON_CODE",n.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT="EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT",n.EVENT_EXT_ERROR_OCCURED="EVENT_EXT_ERROR_OCCURED",n.EVENT_EXT_MANUAL_APPLY_COUPON_CODE="EVENT_EXT_MANUAL_APPLY_COUPON_CODE",n.DEFAULT_COUNTRY="COM",n.ACTIVATE_FROM_POPUP="ACTIVATE_FROM_POPUP",n.MENU_STORE="Menu Store",n.MENU_ACCOUNT_LOGIN="Menu_Account_Login",n.MENU_ACCOUNT_SWITCH_POPUP="Menu_Account_Country_Switch_Popup",n.POPUP_CUSTOM_LOGOUT_EVENT="LOGOUT",n.POPUP_CUSTOM_LOGIN_EVENT="LOGIN_DIRECTLY",n.POPUP_CUSTOM_LOGIN="NON_LOGIN_USER_TO_LOGIN",n.POPUP_CUSTOM_SEARCH_TAOBAO="CLICK_TO_SEARCH",n.POPUP_CUSTOM_ACTIVATE_EVENT="ACTIVATE_FROM_MENU",n.POPUP_CUSTOM_OPEN_COUNTRY_SELECTOR="OPEN_COUNTRY_SELECTOR",n.POPUP_CUSTOM_CHOOSE_COUNTRY="POPUP_CUSTOM_CHOOSE_COUNTRY",n.POPUP_CUSTOM_CHANGE_TAB_EVENT="TAB_CHANGE",n.POPUP_CUSTOM_GO_WITHDRAW="GO_TO_WITHDRAW",n.POPUP_CUSTOM_GO_OVERVIEW="GO_TO_OVERVIEW",n.POPUP_CUSTOM_GO_REFER="GO_TO_REFER",n.POPUP_CUSTOM_GO_FAQ="GO_TO_FAQ",n.POPUP_CUSTOM_GO_RATE="GO_TO_RATE",n.POPUP_CUSTOM_CANCEL_SWITCH="CANCEL_SWITCH",n.POPUP_CUSTOM_MENU_CAMPAIGN_PROMPT="POPUP_CUSTOM_MENU_CAMPAIGN_PROMPT",n.POPUP_CUSTOM_MENU_CAMPAIGN_CLOSE="POPUP_CUSTOM_MENU_CAMPAIGN_CLOSE",n.POPUP_CUSTOM_MENU_CAMPAIGN_CLICK="POPUP_CUSTOM_MENU_CAMPAIGN_CLICK",n.TIME_TO_CLOSE_ACTIVATED_NOTIFIER=1e4,n.ACTIVATED_EXPIRED_MS=e.ACTIVATED_EXPIRED_MS,n.ACTIVATED_EXPIRED_MS_FOR_TAOBAO=e.ACTIVATED_EXPIRED_MS_FOR_TAOBAO,n.REFETCH_MERCHANT_INTERVAL_MS=3e5,n.REFETCH_SETTING_INTERVAL_MS=18e5,n.STAND_DOWN_MERCHANT_NOTIFIER_TIMER_MS=864e5,n.PERMISSION_NOTIFIER_TTL=e.PERMISSION_NOTIFIER_TTL,n.CASHBACK_STATUS_UNAVAILABLE="unavailable",n.CASHBACK_STATUS_AVAILABLE="available",n.CASHBACK_STATUS_ACTIVATED="activated",n.CASHBACK_STATUS_FETCHING="fetching",n.CASHBACK_STATUS_TAOBAO_API_DOWN="down",n.ACTIVATE_STATE_NOT_ACTIVATED="ACTIVATE_STATE_NOT_ACTIVATED",n.ACTIVATE_STATE_ACTIVATING="ACTIVATE_STATE_ACTIVATING",n.ACTIVATE_STATE_ACTIVATED="ACTIVATE_STATE_ACTIVATED",n.DEFAULT_DISABLE_REASON="2",n.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED="TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED",n.TAOBAO_TOGGLE_SEARCH_BOX="TAOBAO_TOGGLE_SEARCH_BOX",n.TAOBAO_OPEN_NOTIFIER="TAOBAO_OPEN_NOTIFIER",n.TAOBAO_CLOSE_NOTIFIER="TAOBAO_CLOSE_NOTIFIER",n.TAOBAO_OPEN_CONFIRMATION_NOTIFIER="TAOBAO_OPEN_CONFIRMATION_NOTIFIER",n.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER="TAOBAO_CLOSE_CONFIRMATION_NOTIFIER",n.TAOBAO_OPEN_API_DOWN_NOTIFIER="TAOBAO_OPEN_API_DOWN_NOTIFIER",n.TAOBAO_CLOSE_API_DOWN_NOTIFIER="TAOBAO_CLOSE_API_DOWN_NOTIFIER",n.TAOBAO_MATERIAL_LIB_TYPE_HAS_CASHBACK=["1","1,2"],n.SHOPBACK_TAOBAO_CART="shopback-taobao-cart",n.GET_TAB_OF_CONTENT_SCRIPT="GET_TAB_OF_CONTENT_SCRIPT",n.SET_ICON_BADGE_TEXT="SET_ICON_BADGE_TEXT",n.COUNTRIES=["au","id","my","ph","sg","th","tw"],n.u=0,n.c=1,n.COUNTRY_LOCALES={au:"en-AU",id:"id",my:"ms-MY",ph:"en",sg:"en-SG",th:"th",tw:"en"},n.COUNTRY_CURRENCY_CODES={au:"AUD",id:"IDR",my:"MYR",ph:"PHP",sg:"SGD",th:"THB",tw:"NTD"},n.TOP_MERCHANT_TAB="topMerchants",n.COUPONS_TAB="coupons",n.MY_ACCOUNT_TAB="myAccount",n.UTM_BE_NOTIFIER_CASHBACK="be_cashback_notifier",n.s="be_disable_notifier",n.UTM_BE_CONFIRM_NOTIFIER="be_confirmation_notifier",n.UTM_BE_MENU_CASHBACK="be_menu_getcashback",n.UTM_BE_MENU_LOGIN_CASHBACK="be_menu_logintogetcashback",n.UTM_BE_MENU_STORE_NONLOGIN="be_menu_store_nonlogin",n.UTM_BE_MENU_STORE="be_menu_store",n.UTM_BE_LOGIN_NOTIFIER="be_login_notifier",n.UTM_BE_TAOBAO_LOGIN_CASHBACK_NOTIFIER="be_taobao_login_cashback_notifier",n.UTM_BE_TAOBAO_SEARCH="be_taobao_searchbar",n.UTM_BE_TAOBAO_CASHBACK_NOTIFIER="be_taobao_cashback_notifier",n.UTM_BE_TAOBAO_LOGIN_SEARCHBAR="be_taobao_login_searchbar",n.HEIGHT_OF_NORMAL_MENU=468,n.HEIGHT_OF_MERCHANT_MENU=537,n.HEIGHT_OF_TAOBAO_MENU=603,n.ACTIVATED_NOTIFIER_NOT_YET_VISITED=0,n.ACTIVATED_NOTIFIER_VISITED=1,n.ACTIVATED_NOTIFIER_CLOSED=2,n.SENTRY_ERROR_LOGGING="SENTRY_ERROR_LOGGING",n.SERP_LIST=[{domain:"yahoo",rx:"search\\.yahoo\\.com\\/",pattern:"h3.title > a",href:"=(http[^/]*)",searchInputPattern:"div#sbq-wrap > #yschsp"},{domain:"bing",rx:"\\.bing\\.com\\/search.*[&?]q=([^&]*)",pattern:'#b_results>.b_algo, #b_results>li, #b_results h2 a, div[class="sb_tlst"] * a',searchInputPattern:"#sb_form_q"},{domain:"google",rx:"^https?:\\/\\/(?:www\\.|encrypted\\.)?google\\.[\\w\\.]{2,6}.*",pattern:"div.rc > .r > a",searchInputPattern:".gLFyf"}],n.OTHER_SERP_PATTERN_LIST=[".ebates-serp","#gym_serp"],n.OPEN_BROWSER_WINDOW="OPEN_BROWSER_WINDOW",n.COUNTRY_BOOKING_IDENTIFIER={au:{aid:"1465791"},id:{aid:"1691096"},my:{aid:"1691091"},ph:{aid:"1244848"},sg:{aid:"1691090"},th:{aid:"1275028"},tw:{aid:"1244849"},com:{aid:"1691090"}},n.ICON_BADGE_BACKGROUND_COLOR="#fbb215",n.COUPON_NOTIFIER_DIV_ID="shopback-coupon-notifier",n.COUPON_APPLIER_DIV_ID="shopback-coupon-applier",n.CASHBACK_NOTIFIER_DIV_ID="shopback-cashback-notifier",n.POPUP_SEARCH_MERCHANT_INPUT_BOX_ID="shopback-popup-search-input-box",n.TAOBAO_NAVIGATOR_DIV_ID="shopback-taobao-navigator",n.IS_FIREFOX=-1===navigator.userAgent.indexOf("Chrome"),n.ACCESS_TOKEN_NAME="sbet",n.SECONDS_OF_ONE_YEAR=31536e3,n.HEADERS={X_SHOPBACK_LAST_CC:"X-SHOPBACK-LAST-CC",X_SHOPBACK_IRONGATE_ENABLED:"X-SHOPBACK-IRONGATE-ENABLED",X_SHOPBACK_DOMAIN:"X-SHOPBACK-DOMAIN",X_SHOPBACK_CLIENT_USER_AGENT:"X-SHOPBACK-CLIENT-USER-AGENT",X_SHOPBACK_ACCESS_TOKEN:"X-SHOPBACK-ACCESS-TOKEN",X_SHOPBACK_REFRESH_TOKEN:"X-SHOPBACK-REFRESH-TOKEN",CONTENT_TYPE:"Content-Type",ACCEPT:"Accept"},n.DEFAULT_EVENT_REASON="For more information, please visit",n.DEFAULT_USER_DATA_POLICY_URL="https://support.shopback.sg/hc/en-us/articles/360039652893",n.EVENT_REASONS_MAP={EVENT_EXT_INSTALLED:"To report ShopBack installs for product analytics. For more information, please visit",EVENT_EXT_PAGE_VISITED:"To look up domain to determine if it is a site ShopBack supports and determine appropriate ShopBack behavior. For more information, please visit",EVENT_EXT_NOTIFIER_PROMPT:"To report first interaction with ShopBack for product analytics. For more information, please visit",EVENT_EXT_REDIRECT:"To report affiliate tagging for product analytics. For more information, please visit",EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT:"To report affiliate activation to verify ShopBack is performing as expected. For more information, please visit",EVENT_EXT_MENU_OPEN:"To report ShopBack manually opened for product analytics. For more information, please visit",EVENT_EXT_CLICK:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_SEARCH:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_ERROR_OCCURED:"To report when ShopBack is not performing as expected. For more information, please visit",EVENT_EXT_LOGIN:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_UPDATED:"To report version update for product analytics. For more information, please visit",EVENT_EXT_APPLY_COUPON_CODE:"To report coupon application status for product analytics. For more information, please visit",EVENT_EXT_MANUAL_APPLY_COUPON_CODE:"To report coupon application status for product analytics. For more information, please visit",EVENT_EXT_SERP_VISITED:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_SERP_CLICKED:"To report interactions with ShopBack for product analytics. For more information, please visit"},n.USER_DATA_POLICY_PAGE_URLS={au:"https://support.shopback.com.au/hc/en-us/articles/360039114834",tw:"https://support.shopback.com.tw/hc/zh-tw/articles/360039187814",id:"https://support.shopback.co.id/hc/id/articles/360039941853",my:"https://support.shopback.my/hc/en-us/articles/360026274913",sg:"https://support.shopback.sg/hc/en-us/articles/360039652893",ph:"https://support.shopback.ph/hc/en-us/articles/115010370828",th:"https://support.shopback.co.th/hc/th/articles/360037977973"}},10:function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},101:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=l(r(38)),i=l(r(75)),o=l(r(5));n.fetchMerchants=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.DEFAULT_COUNTRY,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(r,e){var o;return(0,u.fetchWithRetry)((0,f.getMerchantsAPI)(t,{confirmation:!0,disableReason:!0,metaInfo:!0},(0,h.ironGateEnabled)(e())),{headers:(o={},(0,i.default)(o,s.HEADERS.X_SHOPBACK_LAST_CC,t),(0,i.default)(o,s.HEADERS.X_SHOPBACK_IRONGATE_ENABLED,(0,h.ironGateEnabled)(e())),o),retryOnHttpStatus:[500,502,503,504]}).then(function(t){return t.json()}).then(function(i){r(function(t,n,r){return{type:n?s.REFETCH_MERCHANTS_SUCCESS:s.FETCH_MERCHANTS_SUCCESS,payload:{cc:r,merchants:t,activateX:browser.i18n.getMessage("notifier_cashback_activate"),reActivateX:browser.i18n.getMessage("disabler_cashback_activate"),loginToActivateX:browser.i18n.getMessage("notifier_log_in_first"),cashbackHeader:browser.i18n.getMessage("popup_header_cashback"),serpCashbackInfo:browser.i18n.getMessage("serp_cashback_info"),cashbackModifiers:{"<":browser.i18n.getMessage("notifier_cashback_modifier_up_to"),"<=":browser.i18n.getMessage("notifier_cashback_modifier_up_to"),"=":""}}}}(v(i,(0,h.ironGateEnabled)(e())),n,t))}).catch(function(t){var n=t.message;r((0,a.apiError)({errorType:s.FETCH_MERCHANTS_ERROR,message:n}))})}},n.standDownMerchantNotifier=function(t){var n=t.merchantId;return{type:s.STAND_DOWN_MERCHANT_NOTIFIER,payload:{merchantId:n}}},n.standUpMerchantNotifier=function(t){var n=t.merchantId;return{type:s.STAND_UP_MERCHANT_NOTIFIER,payload:{merchantId:n}}},n.closeMerchantNotifier=function(t){var n=t.merchantId;return{type:s.CLOSE_MERCHANT_NOTIFIER,payload:{merchantId:n}}},n.uiCloseMerchantNotifier=function(t){return{type:s.CLOSE_MERCHANT_NOTIFIER,merchantId:t}},n.fetchTopMerchants=function(){return function(t,n){var r;return fetch((0,f.getMerchantsAPI)(n().cc,{top:!0},(0,h.ironGateEnabled)(n())),{headers:(r={},(0,i.default)(r,s.HEADERS.X_SHOPBACK_LAST_CC,n().cc),(0,i.default)(r,s.HEADERS.X_SHOPBACK_IRONGATE_ENABLED,(0,h.ironGateEnabled)(n())),r)}).then(u.handleErrors).then(function(t){return t.json()}).then(function(r){var e;t((e=v(r,(0,h.ironGateEnabled)(n())),{type:s.FETCH_TOP_MERCHANTS_SUCCESS,payload:e}))}).catch(function(n){var r=n.message;t((0,a.apiError)({errorType:s.FETCH_TOP_MERCHANTS_ERROR,message:r}))})}},n.uiFetchTopMerchants=function(){return{type:s.FETCH_TOP_MERCHANTS}},n.deActivate=function(t){return{type:s.DE_ACTIVATE,payload:(0,o.default)({},t)}},n.uiDeActivate=function(t){return{type:s.DE_ACTIVATE,merchantId:t}},n.startActivate=function(t){return function(n){return browser.tabs.query({active:!0,currentWindow:!0}).then(function(r){var i=(0,e.default)(r,1),o=i[0];n({type:s.START_ACTIVATE,payload:{tabId:o.id,referrer:t.forceToSetReferrer?t.prevUrl||o.url:null,merchantId:t.merchantId}}),n({type:s.ADD_DIRTY_REDIRECT,payload:{tabId:o.id,from:t.from,merchantId:t.merchantId}})})}},n.uiStartActivate=function(t){return(0,o.default)({type:s.START_ACTIVATE},t)},n.deleteExpiredActivatedMerchant=function(t){return{type:s.DELETE_EXPIRED_ACTIVATED_MERCHANT,payload:{merchant:t}}},n.closeActivatedMerchantNotifier=d,n.uiCloseActivatedMerchantNotifier=function(t){return{type:s.CLOSE_ACTIVATED_MERCHANT_NOTIFIER,merchantId:t}},n.detectSBRedirectPage=function(t){return{type:s.DETECT_SB_REDIRECT_PAGE,payload:(0,o.default)({},t)}},n.uiDetectSBRedirectPage=function(t){return(0,o.default)({type:s.DETECT_SB_REDIRECT_PAGE},t)},n.visitActivatedMerchantNotifier=function(t){var n=t.merchant;return function(t,r){var e=(0,c.getActivatedMerchantInfo)(r(),{merchant:n});return e&&e.visited===s.ACTIVATED_NOTIFIER_NOT_YET_VISITED?(t({type:s.VISIT_ACTIVATED_MERCHANT_NOTIFIER,payload:{merchantId:n.id}}),new Promise(function(r){setTimeout(function(){t(d({merchantId:n.id})),r()},s.TIME_TO_CLOSE_ACTIVATED_NOTIFIER)})):Promise.resolve()}},n.uiVisitActivatedMerchantNotifier=function(t){return{type:s.VISIT_ACTIVATED_MERCHANT_NOTIFIER,merchant:t}},n.p=function(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(e,i){return t.isTaobao||(0,p.h)(i(),{merchant:t})&&!(0,c.l)(i(),{merchant:t})?Promise.resolve({}):e({type:s.i,payload:{merchantId:t.id,focusing:r,tabId:n}})}};var u=r(63),c=r(29),a=r(45),s=r(0),f=r(19),p=r(29),h=r(109);function l(t){return t&&t.__esModule?t:{default:t}}function v(t,n){return t.map(function(t){var r=void 0;try{RegExp(t.url_pattern),r=t.url_pattern}catch(n){console.log("Incorrect url_pattern: "+t.url_pattern),r=""}return(0,o.default)({},t,{id:n?t.merchantId:t.id,url_pattern:r})})}function d(t){var n=t.merchantId;return{type:s.CLOSE_ACTIVATED_MERCHANT_NOTIFIER,payload:{merchantId:n}}}},104:function(t,n,r){(function(n){var e=r(114),i="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},o=i.Raven,u=new e;u.noConflict=function(){return i.Raven=o,u},u.afterLoad(),t.exports=u,t.exports.Client=e}).call(n,r(20))},105:function(t,n,r){"use strict";n.__esModule=!0,n.default=function(t,n){var r={};for(var e in t)n.indexOf(e)>=0||Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=t[e]);return r}},106:function(t,n,r){r(107);var e=r(2).Object;t.exports=function(t,n,r){return e.defineProperty(t,n,r)}},107:function(t,n,r){var e=r(13);e(e.S+e.F*!r(6),"Object",{defineProperty:r(8).f})},108:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getCloseTaoBaoNotifierAt=n.isTaoBaoShoppingCartPage=n.shouldFetchTaoBaoProductCashbackStatus=n.isProductActivatedByAiTaoBaoSearch=n.isReferrerTaoBaoCouponPage=n.isReferrerAiTaoBao=n.isReferrerHasValidSearchKeyParam=n.shouldDisplay=n.urlContainsAliTrackParam=n.isTaoBaoProductPage=n.getTaoBaoProductIds=n.getTaoBaoProducts=n.getTaoBaoProduct=n.isTaoBaoApiDown=n.isTaoBaoConfirmationNotifierOpened=n.isTaoBaoNotifierOpened=n.isTaoBaoSearchBoxOpened=n.getTaoBaoProductIdByUrl=n.getActivatedProductIdByTab=n.getTaoBaoShoppingCartPagePatterns=n.getTaoBaoProductPagePatterns=n.getTaoBaoApiSettings=n.getTaoBaoSettings=void 0;var e=r(17),i=function(t,n){return n.url},o=function(t,n){return n.referrer},u=function(t){return t.taoBao},c=n.getTaoBaoSettings=function(t){return t.settings.taoBao},a=(n.getTaoBaoApiSettings=function(t){return t.settings.taoBao.api},n.getTaoBaoProductPagePatterns=function(t){return t.settings.taoBao.productPagePatterns}),s=n.getTaoBaoShoppingCartPagePatterns=function(t){return t.settings.taoBao.shoppingCartPagePatterns},f=(n.getActivatedProductIdByTab=(0,e.createSelector)([u,function(t,n){return n.tabId}],function(t,n){return t.activatedProductIdInTab[n]}),n.getTaoBaoProductIdByUrl=(0,e.createSelector)([i],function(t){return new URL(t).searchParams.get("id")||""})),p=(n.isTaoBaoSearchBoxOpened=(0,e.createSelector)([u],function(t){return!!t.searchBoxOpened}),n.isTaoBaoNotifierOpened=(0,e.createSelector)([u],function(t){return!!t.notifierOpened}),n.isTaoBaoConfirmationNotifierOpened=(0,e.createSelector)([u],function(t){return!!t.confirmationNotifierOpened}),n.isTaoBaoApiDown=(0,e.createSelector)([u],function(t){return!!t.taoBaoApiDown}),n.getTaoBaoProduct=(0,e.createSelector)([u,f],function(t,n){return t.products[n]})),h=(n.getTaoBaoProducts=(0,e.createSelector)([u],function(t){return t.products}),n.getTaoBaoProductIds=(0,e.createSelector)([u],function(t){return Object.keys(t.products)}),n.isTaoBaoProductPage=(0,e.createSelector)([a,f,i],function(t,n,r){return!(!n||!t.some(function(t){return new RegExp(t).test(r)}))})),l=n.urlContainsAliTrackParam=(0,e.createSelector)([c,i],function(t,n){var r=new URL(n);return r.searchParams.has(t.aliTrackIdParamKey)&&r.searchParams.get(t.aliTrackIdParamKey).startsWith(t.aliTrackIdParamValue)}),v=(n.shouldDisplay=(0,e.createSelector)([function(t,n){return n.merchant}],function(t){return!(!t||!t.popup_enabled)}),n.isReferrerHasValidSearchKeyParam=(0,e.createSelector)([o],function(t){return!(!t||!new URL(t).searchParams.get("key"))})),d=n.isReferrerAiTaoBao=(0,e.createSelector)([c,o],function(t,n){return new RegExp(t.aiTaoBaoSearchPattern).test(n)}),_=n.isReferrerTaoBaoCouponPage=(0,e.createSelector)([c,o],function(t,n){return new RegExp(t.taoBaoCouponPageUrlPattern).test(n)}),E=n.isProductActivatedByAiTaoBaoSearch=(0,e.createSelector)([l,d,_,v],function(t,n,r,e){return!(!t||!(n&&e||r))});n.shouldFetchTaoBaoProductCashbackStatus=(0,e.createSelector)([h,p,E],function(t,n,r){return!(!t||n||r)}),n.isTaoBaoShoppingCartPage=(0,e.createSelector)([s,i],function(t,n){return t.some(function(t){return new RegExp(t).test(n)})}),n.getCloseTaoBaoNotifierAt=(0,e.createSelector)([u],function(t){return t.closeTaoBaoNotifierAt})},109:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shouldFetchSettings=n.taoBaoLinkEnabled=n.couponsEnabled=n.ironGateEnabled=void 0;var e=r(17),i=r(0),o=function(t){return t.cc},u=function(t){return t.settings.serviceEnableCountry},c=(0,e.createSelector)([u],function(t){return t.ironGate}),a=(0,e.createSelector)([u],function(t){return t.coupons}),s=(0,e.createSelector)([u],function(t){return t.taoBaoLink});n.ironGateEnabled=(0,e.createSelector)([o,c],function(t,n){return n.some(function(n){return n.toUpperCase()===t.toUpperCase()})}),n.couponsEnabled=(0,e.createSelector)([o,a],function(t,n){return n.some(function(n){return n.toUpperCase()===t.toUpperCase()})}),n.taoBaoLinkEnabled=(0,e.createSelector)([o,s],function(t,n){return n.some(function(n){return n.toUpperCase()===t.toUpperCase()})}),n.shouldFetchSettings=(0,e.createSelector)([function(t){return t.settings},function(t,n){return n.now}],function(t,n){if(!t)return!0;var r=t.fetchedAt;return"number"!=typeof r||n-r>i.REFETCH_SETTING_INTERVAL_MS})},110:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isLoggerEnabled=void 0;var e=r(17);n.isLoggerEnabled=(0,e.createSelector)([function(t){return t.extension}],function(t){return!!t.loggerEnabled})},113:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sendToSentry=void 0;var e,i=r(104),o=(e=i)&&e.__esModule?e:{default:e};n.sendToSentry=function(t){t instanceof Error?o.default.captureException(t):t instanceof Response&&o.default.captureMessage("Error : "+t.status+" "+t.statusText)}},114:function(t,n,r){(function(n){var e=r(115),i=r(71),o=r(116),u=r(117),c=r(55),a=c.isError,s=c.isObject,f=c.isPlainObject,p=c.isErrorEvent,h=c.isUndefined,l=c.isFunction,v=c.isString,d=c.isArray,_=c.isEmptyObject,E=c.each,m=c.objectMerge,T=c.truncate,b=c.objectFrozen,y=c.hasKey,O=c.joinRegExp,I=c.urlencode,g=c.uuid4,S=c.htmlTreeAsString,R=c.isSameException,w=c.isSameStacktrace,A=c.parseUrl,C=c.fill,N=c.supportsFetch,k=c.supportsReferrerPolicy,P=c.serializeKeysForMessage,j=c.serializeException,L=c.sanitize,F=r(118).wrapMethod,D="source protocol user pass host port path".split(" "),M=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function U(){return+new Date}var H="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},x=H.document,B=H.navigator;function X(t,n){return l(n)?function(r){return n(r,t)}:n}function K(){for(var t in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!h(x),this._hasNavigator=!h(B),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={release:H.SENTRY_RELEASE&&H.SENTRY_RELEASE.id,logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],headers:null,collectWindowErrors:!0,captureUnhandledRejections:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1,sanitizeKeys:[]},this._fetchDefaults={method:"POST",keepalive:!0,referrerPolicy:k()?"origin":""},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=H.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=U(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=H.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[t]=this._originalConsole[t]}K.prototype={VERSION:"3.24.1",debug:!1,TraceKit:e,config:function(t,n){var r=this;if(r._globalServer)return this._logDebug("error","Error: Raven has already been configured"),r;if(!t)return r;var i=r._globalOptions;n&&E(n,function(t,n){"tags"===t||"extra"===t||"user"===t?r._globalContext[t]=n:i[t]=n}),r.setDSN(t),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=O(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&O(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&O(i.whitelistUrls),i.includePaths=O(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var o={xhr:!0,console:!0,dom:!0,location:!0,sentry:!0},u=i.autoBreadcrumbs;"[object Object]"==={}.toString.call(u)?u=m(o,u):!1!==u&&(u=o),i.autoBreadcrumbs=u;var c={tryCatch:!0},a=i.instrument;return"[object Object]"==={}.toString.call(a)?a=m(c,a):!1!==a&&(a=c),i.instrument=a,e.collectWindowErrors=!!i.collectWindowErrors,r},install:function(){var t=this;return t.isSetup()&&!t._isRavenInstalled&&(e.report.subscribe(function(){t._handleOnErrorStackInfo.apply(t,arguments)}),t._globalOptions.captureUnhandledRejections&&t._attachPromiseRejectionHandler(),t._patchFunctionToString(),t._globalOptions.instrument&&t._globalOptions.instrument.tryCatch&&t._instrumentTryCatch(),t._globalOptions.autoBreadcrumbs&&t._instrumentBreadcrumbs(),t._drainPlugins(),t._isRavenInstalled=!0),Error.stackTraceLimit=t._globalOptions.stackTraceLimit,this},setDSN:function(t){var n=this._parseDSN(t),r=n.path.lastIndexOf("/"),e=n.path.substr(1,r);this._dsn=t,this._globalKey=n.user,this._globalSecret=n.pass&&n.pass.substr(1),this._globalProject=n.path.substr(r+1),this._globalServer=this._getGlobalServer(n),this._globalEndpoint=this._globalServer+"/"+e+"api/"+this._globalProject+"/store/",this._resetBackoff()},context:function(t,n,r){return l(t)&&(r=n||[],n=t,t=void 0),this.wrap(t,n).apply(this,r)},wrap:function(t,n,r){var e=this;if(h(n)&&!l(t))return t;if(l(t)&&(n=t,t=void 0),!l(n))return n;try{if(n.__raven__)return n;if(n.__raven_wrapper__)return n.__raven_wrapper__}catch(t){return n}function i(){var i=[],o=arguments.length,u=!t||t&&!1!==t.deep;for(r&&l(r)&&r.apply(this,arguments);o--;)i[o]=u?e.wrap(t,arguments[o]):arguments[o];try{return n.apply(this,i)}catch(n){throw e._ignoreNextOnError(),e.captureException(n,t),n}}for(var o in n)y(n,o)&&(i[o]=n[o]);return i.prototype=n.prototype,n.__raven_wrapper__=i,i.__raven__=!0,i.__orig__=n,i},uninstall:function(){return e.report.uninstall(),this._detachPromiseRejectionHandler(),this._unpatchFunctionToString(),this._restoreBuiltIns(),this._restoreConsole(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},_promiseRejectionHandler:function(t){this._logDebug("debug","Raven caught unhandled promise rejection:",t),this.captureException(t.reason,{extra:{unhandledPromiseRejection:!0}})},_attachPromiseRejectionHandler:function(){return this._promiseRejectionHandler=this._promiseRejectionHandler.bind(this),H.addEventListener&&H.addEventListener("unhandledrejection",this._promiseRejectionHandler),this},_detachPromiseRejectionHandler:function(){return H.removeEventListener&&H.removeEventListener("unhandledrejection",this._promiseRejectionHandler),this},captureException:function(t,n){if(n=m({trimHeadFrames:0},n||{}),p(t)&&t.error)t=t.error;else if(a(t))t=t;else{if(!f(t))return this.captureMessage(t,m(n,{stacktrace:!0,trimHeadFrames:n.trimHeadFrames+1}));n=this._getCaptureExceptionOptionsFromPlainObject(n,t),t=new Error(n.message)}this._lastCapturedException=t;try{var r=e.computeStackTrace(t);this._handleStackInfo(r,n)}catch(n){if(t!==n)throw n}return this},_getCaptureExceptionOptionsFromPlainObject:function(t,n){var r=Object.keys(n).sort(),e=m(t,{message:"Non-Error exception captured with keys: "+P(r),fingerprint:[o(r)],extra:t.extra||{}});return e.extra.__serialized__=j(n),e},captureMessage:function(t,n){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t)){var r,i=m({message:t+=""},n=n||{});try{throw new Error(t)}catch(t){r=t}r.name=null;var o=e.computeStackTrace(r),u=d(o.stack)&&o.stack[1],c=u&&u.url||"";if((!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(c))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(c))){if(this._globalOptions.stacktrace||n&&n.stacktrace){i.fingerprint=null==i.fingerprint?t:i.fingerprint,(n=m({trimHeadFrames:0},n)).trimHeadFrames+=1;var a=this._prepareFrames(o,n);i.stacktrace={frames:a.reverse()}}return i.fingerprint&&(i.fingerprint=d(i.fingerprint)?i.fingerprint:[i.fingerprint]),this._send(i),this}}},captureBreadcrumb:function(t){var n=m({timestamp:U()/1e3},t);if(l(this._globalOptions.breadcrumbCallback)){var r=this._globalOptions.breadcrumbCallback(n);if(s(r)&&!_(r))n=r;else if(!1===r)return this}return this._breadcrumbs.push(n),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(t){var n=[].slice.call(arguments,1);return this._plugins.push([t,n]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(t){return this._globalContext.user=t,this},setExtraContext:function(t){return this._mergeContext("extra",t),this},setTagsContext:function(t){return this._mergeContext("tags",t),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(i(this._globalContext))},setEnvironment:function(t){return this._globalOptions.environment=t,this},setRelease:function(t){return this._globalOptions.release=t,this},setDataCallback:function(t){var n=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=X(n,t),this},setBreadcrumbCallback:function(t){var n=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=X(n,t),this},setShouldSendCallback:function(t){var n=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=X(n,t),this},setTransport:function(t){return this._globalOptions.transport=t,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var t=H.RavenConfig;t&&this.config(t.dsn,t.config).install()},showReportDialog:function(t){if(x){var n=(t=t||{}).eventId||this.lastEventId();if(!n)throw new u("Missing eventId");var r=t.dsn||this._dsn;if(!r)throw new u("Missing DSN");var e=encodeURIComponent,i="";i+="?eventId="+e(n),i+="&dsn="+e(r);var o=t.user||this._globalContext.user;o&&(o.name&&(i+="&name="+e(o.name)),o.email&&(i+="&email="+e(o.email)));var c=this._getGlobalServer(this._parseDSN(r)),a=x.createElement("script");a.async=!0,a.src=c+"/api/embed/error-page/"+i,(x.head||x.body).appendChild(a)}},_ignoreNextOnError:function(){var t=this;this._ignoreOnError+=1,setTimeout(function(){t._ignoreOnError-=1})},_triggerEvent:function(t,n){var r,e;if(this._hasDocument){for(e in n=n||{},t="raven"+t.substr(0,1).toUpperCase()+t.substr(1),x.createEvent?(r=x.createEvent("HTMLEvents")).initEvent(t,!0,!0):(r=x.createEventObject()).eventType=t,n)y(n,e)&&(r[e]=n[e]);if(x.createEvent)x.dispatchEvent(r);else try{x.fireEvent("on"+r.eventType.toLowerCase(),r)}catch(t){}}},_breadcrumbEventHandler:function(t){var n=this;return function(r){if(n._keypressTimeout=null,n._lastCapturedEvent!==r){var e;n._lastCapturedEvent=r;try{e=S(r.target)}catch(t){e="<unknown>"}n.captureBreadcrumb({category:"ui."+t,message:e})}}},_keypressEventHandler:function(){var t=this;return function(n){var r;try{r=n.target}catch(t){return}var e=r&&r.tagName;if(e&&("INPUT"===e||"TEXTAREA"===e||r.isContentEditable)){var i=t._keypressTimeout;i||t._breadcrumbEventHandler("input")(n),clearTimeout(i),t._keypressTimeout=setTimeout(function(){t._keypressTimeout=null},1e3)}}},_captureUrlChange:function(t,n){var r=A(this._location.href),e=A(n),i=A(t);this._lastHref=n,r.protocol===e.protocol&&r.host===e.host&&(n=e.relative),r.protocol===i.protocol&&r.host===i.host&&(t=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:n,from:t}})},_patchFunctionToString:function(){var t=this;t._originalFunctionToString=Function.prototype.toString,Function.prototype.toString=function(){return"function"==typeof this&&this.__raven__?t._originalFunctionToString.apply(this.__orig__,arguments):t._originalFunctionToString.apply(this,arguments)}},_unpatchFunctionToString:function(){this._originalFunctionToString&&(Function.prototype.toString=this._originalFunctionToString)},_instrumentTryCatch:function(){var t=this,n=t._wrappedBuiltIns;function r(n){return function(r,e){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var u=i[0];return l(u)&&(i[0]=t.wrap(u)),n.apply?n.apply(this,i):n(i[0],i[1])}}var e=this._globalOptions.autoBreadcrumbs;function i(r){var i=H[r]&&H[r].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(C(i,"addEventListener",function(n){return function(i,o,u,c){try{o&&o.handleEvent&&(o.handleEvent=t.wrap(o.handleEvent))}catch(t){}var a,s,f;return e&&e.dom&&("EventTarget"===r||"Node"===r)&&(s=t._breadcrumbEventHandler("click"),f=t._keypressEventHandler(),a=function(t){if(t){var n;try{n=t.type}catch(t){return}return"click"===n?s(t):"keypress"===n?f(t):void 0}}),n.call(this,i,t.wrap(o,void 0,a),u,c)}},n),C(i,"removeEventListener",function(t){return function(n,r,e,i){try{r=r&&(r.__raven_wrapper__?r.__raven_wrapper__:r)}catch(t){}return t.call(this,n,r,e,i)}},n))}C(H,"setTimeout",r,n),C(H,"setInterval",r,n),H.requestAnimationFrame&&C(H,"requestAnimationFrame",function(n){return function(r){return n(t.wrap(r))}},n);for(var o=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],u=0;u<o.length;u++)i(o[u])},_instrumentBreadcrumbs:function(){var t=this,n=this._globalOptions.autoBreadcrumbs,r=t._wrappedBuiltIns;function e(n,r){n in r&&l(r[n])&&C(r,n,function(n){return t.wrap(n)})}if(n.xhr&&"XMLHttpRequest"in H){var i=H.XMLHttpRequest&&H.XMLHttpRequest.prototype;C(i,"open",function(n){return function(r,e){return v(e)&&-1===e.indexOf(t._globalKey)&&(this.__raven_xhr={method:r,url:e,status_code:null}),n.apply(this,arguments)}},r),C(i,"send",function(n){return function(){var r=this;function i(){if(r.__raven_xhr&&4===r.readyState){try{r.__raven_xhr.status_code=r.status}catch(t){}t.captureBreadcrumb({type:"http",category:"xhr",data:r.__raven_xhr})}}for(var o=["onload","onerror","onprogress"],u=0;u<o.length;u++)e(o[u],r);return"onreadystatechange"in r&&l(r.onreadystatechange)?C(r,"onreadystatechange",function(n){return t.wrap(n,void 0,i)}):r.onreadystatechange=i,n.apply(this,arguments)}},r)}n.xhr&&N()&&C(H,"fetch",function(n){return function(){for(var r=new Array(arguments.length),e=0;e<r.length;++e)r[e]=arguments[e];var i,o=r[0],u="GET";if("string"==typeof o?i=o:"Request"in H&&o instanceof H.Request?(i=o.url,o.method&&(u=o.method)):i=""+o,-1!==i.indexOf(t._globalKey))return n.apply(this,r);r[1]&&r[1].method&&(u=r[1].method);var c={method:u,url:i,status_code:null};return n.apply(this,r).then(function(n){return c.status_code=n.status,t.captureBreadcrumb({type:"http",category:"fetch",data:c}),n})}},r),n.dom&&this._hasDocument&&(x.addEventListener?(x.addEventListener("click",t._breadcrumbEventHandler("click"),!1),x.addEventListener("keypress",t._keypressEventHandler(),!1)):x.attachEvent&&(x.attachEvent("onclick",t._breadcrumbEventHandler("click")),x.attachEvent("onkeypress",t._keypressEventHandler())));var o=H.chrome,u=!(o&&o.app&&o.app.runtime)&&H.history&&history.pushState&&history.replaceState;if(n.location&&u){var c=H.onpopstate;H.onpopstate=function(){var n=t._location.href;if(t._captureUrlChange(t._lastHref,n),c)return c.apply(this,arguments)};var a=function(n){return function(){var r=arguments.length>2?arguments[2]:void 0;return r&&t._captureUrlChange(t._lastHref,r+""),n.apply(this,arguments)}};C(history,"pushState",a,r),C(history,"replaceState",a,r)}if(n.console&&"console"in H&&console.log){var s=function(n,r){t.captureBreadcrumb({message:n,level:r.level,category:"console"})};E(["debug","info","warn","error","log"],function(t,n){F(console,n,s)})}},_restoreBuiltIns:function(){for(var t;this._wrappedBuiltIns.length;){var n=(t=this._wrappedBuiltIns.shift())[0],r=t[1],e=t[2];n[r]=e}},_restoreConsole:function(){for(var t in this._originalConsoleMethods)this._originalConsole[t]=this._originalConsoleMethods[t]},_drainPlugins:function(){var t=this;E(this._plugins,function(n,r){var e=r[0],i=r[1];e.apply(t,[t].concat(i))})},_parseDSN:function(t){var n=M.exec(t),r={},e=7;try{for(;e--;)r[D[e]]=n[e]||""}catch(n){throw new u("Invalid DSN: "+t)}if(r.pass&&!this._globalOptions.allowSecretKey)throw new u("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return r},_getGlobalServer:function(t){var n="//"+t.host+(t.port?":"+t.port:"");return t.protocol&&(n=t.protocol+":"+n),n},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(t,n){var r=this._prepareFrames(t,n);this._triggerEvent("handle",{stackInfo:t,options:n}),this._processException(t.name,t.message,t.url,t.lineno,r,n)},_prepareFrames:function(t,n){var r=this,e=[];if(t.stack&&t.stack.length&&(E(t.stack,function(n,i){var o=r._normalizeFrame(i,t.url);o&&e.push(o)}),n&&n.trimHeadFrames))for(var i=0;i<n.trimHeadFrames&&i<e.length;i++)e[i].in_app=!1;return e=e.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(t,n){var r={filename:t.url,lineno:t.line,colno:t.column,function:t.func||"?"};return t.url||(r.filename=n),r.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(r.filename)||/(Raven|TraceKit)\./.test(r.function)||/raven\.(min\.)?js$/.test(r.filename)),r},_processException:function(t,n,r,e,i,o){var u,c=(t?t+": ":"")+(n||"");if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(n)&&!this._globalOptions.ignoreErrors.test(c))&&(i&&i.length?(r=i[0].filename||r,i.reverse(),u={frames:i}):r&&(u={frames:[{filename:r,lineno:e,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(r))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(r)))){var a=m({exception:{values:[{type:t,value:n,stacktrace:u}]},culprit:r},o);this._send(a)}},_trimPacket:function(t){var n=this._globalOptions.maxMessageLength;if(t.message&&(t.message=T(t.message,n)),t.exception){var r=t.exception.values[0];r.value=T(r.value,n)}var e=t.request;return e&&(e.url&&(e.url=T(e.url,this._globalOptions.maxUrlLength)),e.Referer&&(e.Referer=T(e.Referer,this._globalOptions.maxUrlLength))),t.breadcrumbs&&t.breadcrumbs.values&&this._trimBreadcrumbs(t.breadcrumbs),t},_trimBreadcrumbs:function(t){for(var n,r,e,i=["to","from","url"],o=0;o<t.values.length;++o)if((r=t.values[o]).hasOwnProperty("data")&&s(r.data)&&!b(r.data)){e=m({},r.data);for(var u=0;u<i.length;++u)n=i[u],e.hasOwnProperty(n)&&e[n]&&(e[n]=T(e[n],this._globalOptions.maxUrlLength));t.values[o].data=e}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var t={};return this._hasNavigator&&B.userAgent&&(t.headers={"User-Agent":navigator.userAgent}),H.location&&H.location.href&&(t.url=H.location.href),this._hasDocument&&x.referrer&&(t.headers||(t.headers={}),t.headers.Referer=x.referrer),t}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&U()-this._backoffStart<this._backoffDuration},_isRepeatData:function(t){var n=this._lastData;return!(!n||t.message!==n.message||t.culprit!==n.culprit)&&(t.stacktrace||n.stacktrace?w(t.stacktrace,n.stacktrace):!t.exception&&!n.exception||R(t.exception,n.exception))},_setBackoffState:function(t){if(!this._shouldBackoff()){var n=t.status;if(400===n||401===n||429===n){var r;try{r=N()?t.headers.get("Retry-After"):t.getResponseHeader("Retry-After"),r=1e3*parseInt(r,10)}catch(t){}this._backoffDuration=r||(2*this._backoffDuration||1e3),this._backoffStart=U()}}},_send:function(t){var n=this._globalOptions,r={project:this._globalProject,logger:n.logger,platform:"javascript"},e=this._getHttpData();e&&(r.request=e),t.trimHeadFrames&&delete t.trimHeadFrames,(t=m(r,t)).tags=m(m({},this._globalContext.tags),t.tags),t.extra=m(m({},this._globalContext.extra),t.extra),t.extra["session:duration"]=U()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(t.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),this._globalContext.user&&(t.user=this._globalContext.user),n.environment&&(t.environment=n.environment),n.release&&(t.release=n.release),n.serverName&&(t.server_name=n.serverName),t=this._sanitizeData(t),Object.keys(t).forEach(function(n){(null==t[n]||""===t[n]||_(t[n]))&&delete t[n]}),l(n.dataCallback)&&(t=n.dataCallback(t)||t),t&&!_(t)&&(l(n.shouldSendCallback)&&!n.shouldSendCallback(t)||(this._shouldBackoff()?this._logDebug("warn","Raven dropped error due to backoff: ",t):"number"==typeof n.sampleRate?Math.random()<n.sampleRate&&this._sendProcessedPayload(t):this._sendProcessedPayload(t)))},_sanitizeData:function(t){return L(t,this._globalOptions.sanitizeKeys)},_getUuid:function(){return g()},_sendProcessedPayload:function(t,n){var r=this,e=this._globalOptions;if(this.isSetup())if(t=this._trimPacket(t),this._globalOptions.allowDuplicates||!this._isRepeatData(t)){this._lastEventId=t.event_id||(t.event_id=this._getUuid()),this._lastData=t,this._logDebug("debug","Raven about to send:",t);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var o=t.exception&&t.exception.values[0];this._globalOptions.autoBreadcrumbs&&this._globalOptions.autoBreadcrumbs.sentry&&this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:t.message,event_id:t.event_id,level:t.level||"error"});var u=this._globalEndpoint;(e.transport||this._makeRequest).call(this,{url:u,auth:i,data:t,options:e,onSuccess:function(){r._resetBackoff(),r._triggerEvent("success",{data:t,src:u}),n&&n()},onError:function(e){r._logDebug("error","Raven transport failed to send: ",e),e.request&&r._setBackoffState(e.request),r._triggerEvent("failure",{data:t,src:u}),e=e||new Error("Raven send failed (no additional details provided)"),n&&n(e)}})}else this._logDebug("warn","Raven dropped repeat event: ",t)},_makeRequest:function(t){var n=t.url+"?"+I(t.auth),r=null,e={};if(t.options.headers&&(r=this._evaluateHash(t.options.headers)),t.options.fetchParameters&&(e=this._evaluateHash(t.options.fetchParameters)),N()){e.body=i(t.data);var o=m({},this._fetchDefaults),u=m(o,e);return r&&(u.headers=r),H.fetch(n,u).then(function(n){if(n.ok)t.onSuccess&&t.onSuccess();else{var r=new Error("Sentry error code: "+n.status);r.request=n,t.onError&&t.onError(r)}}).catch(function(){t.onError&&t.onError(new Error("Sentry error code: network unavailable"))})}var c=H.XMLHttpRequest&&new H.XMLHttpRequest;c&&(("withCredentials"in c||"undefined"!=typeof XDomainRequest)&&("withCredentials"in c?c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status)t.onSuccess&&t.onSuccess();else if(t.onError){var n=new Error("Sentry error code: "+c.status);n.request=c,t.onError(n)}}:(c=new XDomainRequest,n=n.replace(/^https?:/,""),t.onSuccess&&(c.onload=t.onSuccess),t.onError&&(c.onerror=function(){var n=new Error("Sentry error code: XDomainRequest");n.request=c,t.onError(n)})),c.open("POST",n),r&&E(r,function(t,n){c.setRequestHeader(t,n)}),c.send(i(t.data))))},_evaluateHash:function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var e=t[r];n[r]="function"==typeof e?e():e}return n},_logDebug:function(t){this._originalConsoleMethods[t]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[t],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(t,n){h(n)?delete this._globalContext[t]:this._globalContext[t]=m(this._globalContext[t]||{},n)}},K.prototype.setUser=K.prototype.setUserContext,K.prototype.setReleaseContext=K.prototype.setRelease,t.exports=K}).call(n,r(20))},115:function(t,n,r){(function(n){var e=r(55),i={collectWindowErrors:!0,debug:!1},o="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},u=[].slice,c="?",a=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function s(){return"undefined"==typeof document||null==document.location?"":document.location.href}i.report=function(){var t,n,r=[],f=null,p=null,h=null;function l(t,n){var e=null;if(!n||i.collectWindowErrors){for(var o in r)if(r.hasOwnProperty(o))try{r[o].apply(null,[t].concat(u.call(arguments,2)))}catch(t){e=t}if(e)throw e}}function v(n,r,o,u,f){var p=e.isErrorEvent(f)?f.error:f,v=e.isErrorEvent(n)?n.message:n;if(h)i.computeStackTrace.augmentStackTraceWithInitialElement(h,r,o,v),d();else if(p&&e.isError(p))l(i.computeStackTrace(p),!0);else{var _,E={url:r,line:o,column:u},m=void 0;if("[object String]"==={}.toString.call(v))(_=v.match(a))&&(m=_[1],v=_[2]);E.func=c,l({name:m,message:v,url:s(),stack:[E]},!0)}return!!t&&t.apply(this,arguments)}function d(){var t=h,n=f;f=null,h=null,p=null,l.apply(null,[t,!1].concat(n))}function _(t,n){var r=u.call(arguments,1);if(h){if(p===t)return;d()}var e=i.computeStackTrace(t);if(h=e,p=t,f=r,setTimeout(function(){p===t&&d()},e.incomplete?2e3:0),!1!==n)throw t}return _.subscribe=function(e){n||(t=o.onerror,o.onerror=v,n=!0),r.push(e)},_.unsubscribe=function(t){for(var n=r.length-1;n>=0;--n)r[n]===t&&r.splice(n,1)},_.uninstall=function(){n&&(o.onerror=t,n=!1,t=void 0),r=[]},_}(),i.computeStackTrace=function(){function t(t){if(void 0!==t.stack&&t.stack){for(var n,r,e,i=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,u=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,a=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,f=/\((\S*)(?::(\d+))(?::(\d+))\)/,p=t.stack.split("\n"),h=[],l=(/^(.*) is undefined$/.exec(t.message),0),v=p.length;l<v;++l){if(r=i.exec(p[l])){var d=r[2]&&0===r[2].indexOf("native");r[2]&&0===r[2].indexOf("eval")&&(n=f.exec(r[2]))&&(r[2]=n[1],r[3]=n[2],r[4]=n[3]),e={url:d?null:r[2],func:r[1]||c,args:d?[r[2]]:[],line:r[3]?+r[3]:null,column:r[4]?+r[4]:null}}else if(r=o.exec(p[l]))e={url:r[2],func:r[1]||c,args:[],line:+r[3],column:r[4]?+r[4]:null};else{if(!(r=u.exec(p[l])))continue;r[3]&&r[3].indexOf(" > eval")>-1&&(n=a.exec(r[3]))?(r[3]=n[1],r[4]=n[2],r[5]=null):0!==l||r[5]||void 0===t.columnNumber||(h[0].column=t.columnNumber+1),e={url:r[3],func:r[1]||c,args:r[2]?r[2].split(","):[],line:r[4]?+r[4]:null,column:r[5]?+r[5]:null}}!e.func&&e.line&&(e.func=c),h.push(e)}return h.length?{name:t.name,message:t.message,url:s(),stack:h}:null}}function n(t,n,r,e){var i={url:n,line:r};if(i.url&&i.line){if(t.incomplete=!1,i.func||(i.func=c),t.stack.length>0&&t.stack[0].url===i.url){if(t.stack[0].line===i.line)return!1;if(!t.stack[0].line&&t.stack[0].func===i.func)return t.stack[0].line=i.line,!1}return t.stack.unshift(i),t.partial=!0,!0}return t.incomplete=!0,!1}function r(t,o){for(var u,a,f=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,p=[],h={},l=!1,v=r.caller;v&&!l;v=v.caller)if(v!==e&&v!==i.report){if(a={url:null,func:c,line:null,column:null},v.name?a.func=v.name:(u=f.exec(v.toString()))&&(a.func=u[1]),void 0===a.func)try{a.func=u.input.substring(0,u.input.indexOf("{"))}catch(t){}h[""+v]?l=!0:h[""+v]=!0,p.push(a)}o&&p.splice(0,o);var d={name:t.name,message:t.message,url:s(),stack:p};return n(d,t.sourceURL||t.fileName,t.line||t.lineNumber,t.message||t.description),d}function e(n,e){var o=null;e=null==e?0:+e;try{if(o=t(n))return o}catch(t){if(i.debug)throw t}try{if(o=r(n,e+1))return o}catch(t){if(i.debug)throw t}return{name:n.name,message:n.message,url:s()}}return e.augmentStackTraceWithInitialElement=n,e.computeStackTraceFromStackProp=t,e}(),t.exports=i}).call(n,r(20))},116:function(t,n){function r(t,n){var r=(65535&t)+(65535&n);return(t>>16)+(n>>16)+(r>>16)<<16|65535&r}function e(t,n,e,i,o,u){return r((c=r(r(n,t),r(i,u)))<<(a=o)|c>>>32-a,e);var c,a}function i(t,n,r,i,o,u,c){return e(n&r|~n&i,t,n,o,u,c)}function o(t,n,r,i,o,u,c){return e(n&i|r&~i,t,n,o,u,c)}function u(t,n,r,i,o,u,c){return e(n^r^i,t,n,o,u,c)}function c(t,n,r,i,o,u,c){return e(r^(n|~i),t,n,o,u,c)}function a(t,n){var e,a,s,f,p;t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;var h=1732584193,l=-271733879,v=-1732584194,d=271733878;for(e=0;e<t.length;e+=16)a=h,s=l,f=v,p=d,l=c(l=c(l=c(l=c(l=u(l=u(l=u(l=u(l=o(l=o(l=o(l=o(l=i(l=i(l=i(l=i(l,v=i(v,d=i(d,h=i(h,l,v,d,t[e],7,-680876936),l,v,t[e+1],12,-389564586),h,l,t[e+2],17,606105819),d,h,t[e+3],22,-1044525330),v=i(v,d=i(d,h=i(h,l,v,d,t[e+4],7,-176418897),l,v,t[e+5],12,1200080426),h,l,t[e+6],17,-1473231341),d,h,t[e+7],22,-45705983),v=i(v,d=i(d,h=i(h,l,v,d,t[e+8],7,1770035416),l,v,t[e+9],12,-1958414417),h,l,t[e+10],17,-42063),d,h,t[e+11],22,-1990404162),v=i(v,d=i(d,h=i(h,l,v,d,t[e+12],7,1804603682),l,v,t[e+13],12,-40341101),h,l,t[e+14],17,-1502002290),d,h,t[e+15],22,1236535329),v=o(v,d=o(d,h=o(h,l,v,d,t[e+1],5,-165796510),l,v,t[e+6],9,-1069501632),h,l,t[e+11],14,643717713),d,h,t[e],20,-373897302),v=o(v,d=o(d,h=o(h,l,v,d,t[e+5],5,-701558691),l,v,t[e+10],9,38016083),h,l,t[e+15],14,-660478335),d,h,t[e+4],20,-405537848),v=o(v,d=o(d,h=o(h,l,v,d,t[e+9],5,568446438),l,v,t[e+14],9,-1019803690),h,l,t[e+3],14,-187363961),d,h,t[e+8],20,1163531501),v=o(v,d=o(d,h=o(h,l,v,d,t[e+13],5,-1444681467),l,v,t[e+2],9,-51403784),h,l,t[e+7],14,1735328473),d,h,t[e+12],20,-1926607734),v=u(v,d=u(d,h=u(h,l,v,d,t[e+5],4,-378558),l,v,t[e+8],11,-2022574463),h,l,t[e+11],16,1839030562),d,h,t[e+14],23,-35309556),v=u(v,d=u(d,h=u(h,l,v,d,t[e+1],4,-1530992060),l,v,t[e+4],11,1272893353),h,l,t[e+7],16,-155497632),d,h,t[e+10],23,-1094730640),v=u(v,d=u(d,h=u(h,l,v,d,t[e+13],4,681279174),l,v,t[e],11,-358537222),h,l,t[e+3],16,-722521979),d,h,t[e+6],23,76029189),v=u(v,d=u(d,h=u(h,l,v,d,t[e+9],4,-640364487),l,v,t[e+12],11,-421815835),h,l,t[e+15],16,530742520),d,h,t[e+2],23,-995338651),v=c(v,d=c(d,h=c(h,l,v,d,t[e],6,-198630844),l,v,t[e+7],10,1126891415),h,l,t[e+14],15,-1416354905),d,h,t[e+5],21,-57434055),v=c(v,d=c(d,h=c(h,l,v,d,t[e+12],6,1700485571),l,v,t[e+3],10,-1894986606),h,l,t[e+10],15,-1051523),d,h,t[e+1],21,-2054922799),v=c(v,d=c(d,h=c(h,l,v,d,t[e+8],6,1873313359),l,v,t[e+15],10,-30611744),h,l,t[e+6],15,-1560198380),d,h,t[e+13],21,1309151649),v=c(v,d=c(d,h=c(h,l,v,d,t[e+4],6,-145523070),l,v,t[e+11],10,-1120210379),h,l,t[e+2],15,718787259),d,h,t[e+9],21,-343485551),h=r(h,a),l=r(l,s),v=r(v,f),d=r(d,p);return[h,l,v,d]}function s(t){var n,r="",e=32*t.length;for(n=0;n<e;n+=8)r+=String.fromCharCode(t[n>>5]>>>n%32&255);return r}function f(t){var n,r=[];for(r[(t.length>>2)-1]=void 0,n=0;n<r.length;n+=1)r[n]=0;var e=8*t.length;for(n=0;n<e;n+=8)r[n>>5]|=(255&t.charCodeAt(n/8))<<n%32;return r}function p(t){var n,r,e="";for(r=0;r<t.length;r+=1)n=t.charCodeAt(r),e+="0123456789abcdef".charAt(n>>>4&15)+"0123456789abcdef".charAt(15&n);return e}function h(t){return unescape(encodeURIComponent(t))}function l(t){return function(t){return s(a(f(t),8*t.length))}(h(t))}function v(t,n){return function(t,n){var r,e,i=f(t),o=[],u=[];for(o[15]=u[15]=void 0,i.length>16&&(i=a(i,8*t.length)),r=0;r<16;r+=1)o[r]=909522486^i[r],u[r]=1549556828^i[r];return e=a(o.concat(f(n)),512+8*n.length),s(a(u.concat(e),640))}(h(t),h(n))}t.exports=function(t,n,r){return n?r?v(n,t):p(v(n,t)):r?l(t):p(l(t))}},117:function(t,n){function r(t){this.name="RavenConfigError",this.message=t}r.prototype=new Error,r.prototype.constructor=r,t.exports=r},118:function(t,n,r){var e=r(55);t.exports={wrapMethod:function(t,n,r){var i=t[n],o=t;if(n in t){var u="warn"===n?"warning":n;t[n]=function(){var t=[].slice.call(arguments),c=e.safeJoin(t," "),a={level:u,logger:"console",extra:{arguments:t}};"assert"===n?!1===t[0]&&(c="Assertion failed: "+(e.safeJoin(t.slice(1)," ")||"console.assert"),a.extra.arguments=t.slice(1),r&&r(c,a)):r&&r(c,a),i&&Function.prototype.apply.call(i,o,t)}}}}},119:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.findLoginHistory=n.isLogoutAllSBAccount=n.isLoginByCC=n.isLoggedIn=void 0;var e=r(17),i=r(0),o=function(t){return t.user},u=function(t,n){return n.cc};n.isLoggedIn=(0,e.createSelector)([o],function(t){return!!t.token}),n.isLoginByCC=(0,e.createSelector)([o,u],function(t,n){return!!t.loginHistories[n]}),n.isLogoutAllSBAccount=(0,e.createSelector)([u],function(t){return t===i.DEFAULT_COUNTRY}),n.findLoginHistory=(0,e.createSelector)([o,u],function(t,n){return t.loginHistories[n]})},12:function(t,n,r){var e=r(8),i=r(22);t.exports=r(6)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},13:function(t,n,r){var e=r(4),i=r(2),o=r(46),u=r(12),c=r(10),a=function(t,n,r){var s,f,p,h=t&a.F,l=t&a.G,v=t&a.S,d=t&a.P,_=t&a.B,E=t&a.W,m=l?i:i[n]||(i[n]={}),T=m.prototype,b=l?e:v?e[n]:(e[n]||{}).prototype;for(s in l&&(r=n),r)(f=!h&&b&&void 0!==b[s])&&c(m,s)||(p=f?b[s]:r[s],m[s]=l&&"function"!=typeof b[s]?r[s]:_&&f?o(p,e):E&&b[s]==p?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n.prototype=t.prototype,n}(p):d&&"function"==typeof p?o(Function.call,p):p,d&&((m.virtual||(m.virtual={}))[s]=p,t&a.R&&T&&!T[s]&&u(T,s,p)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},14:function(t,n){t.exports={}},149:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.YYYYMMDD=n.toSBFormat=void 0;var e,i=r(1),o=(e=i)&&e.__esModule?e:{default:e};function u(t){return(t<10?"0":"")+t}n.toSBFormat=function(t){if(!(t instanceof Date))throw new Error("Invalid Date object");return t.getUTCFullYear()+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+" "+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())},n.YYYYMMDD=function(t){return(0,o.default)(t).format("L")}},15:function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},157:function(t,n,r){"use strict";(function(t){t.browser||(t.browser=r(196))}).call(n,r(20))},158:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.closeTab=n.uiOpenNewTab=n.openNewTab=void 0;var e=r(0);n.openNewTab=function(t){var n=t.openUrl,r=t.active,i=t.autoClose,o=void 0===i||i;return function(t){return browser.tabs.create({active:r,url:n}).then(function(n){return!!o&&t({type:e.OPEN_NEW_TAB,payload:{tabId:n.id}})})}},n.uiOpenNewTab=function(t){var n=t.openUrl,r=t.active,i=t.autoClose,o=void 0===i||i;return{type:e.OPEN_NEW_TAB,openUrl:n,active:r,autoClose:o}},n.closeTab=function(t){var n=t.tabId;return function(t){return browser.tabs.remove(n).then(function(){return t({type:e.CLOSE_TAB,payload:{tabId:n}})})}}},16:function(t,n,r){var e=r(53),i=r(33);t.exports=function(t){return e(i(t))}},163:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isProductFetchedFromTaoBao=n.getProductListMap=n.getCartIdByProductListElem=n.getProductIdByProductLinkElem=n.getProductInfoElem=n.getProductLinkElem=n.redirectToDeepLink=n.getTaoBaoProductDeepLink=n.taoBaoProductHasCashback=void 0;var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(206),c=r(45),a=r(43),s=r(108),f=r(149),p=r(63),h=r(0);var l=function(t,n){return t&&Object.prototype.hasOwnProperty.call(t,"results")&&Object.keys(t.results).length>0&&Object.prototype.hasOwnProperty.call(t.results,n)&&Array.isArray(t.results[n])&&t.results[n].length>0},v=function(t){var n=t.error_response;return n?Promise.reject({message:n.sub_code}):Promise.resolve(t)},d=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.DEFAULT_COUNTRY,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=r.method.replace(/^taobao\./,"").replace(/\./g,"_")+"_response",i=t.appKey[n],c=t.appSecret[n],a=t.adzoneId[n],s=(0,o.default)({},t.methods.common.params,r,{timestamp:(0,f.toSBFormat)(new Date),app_key:i,adzone_id:a});s.sign=function(t,n){var r="";return Object.keys(n).sort().forEach(function(t){var e=n[t];r+=t+e}),r=""+t+r+t,(0,u.MD5)(r).toString().toUpperCase()}(c,s);var l=new URL(t.url);Object.keys(s).forEach(function(t){var n=s[t];l.searchParams.set(t,n)});var d={method:t.httpMethod,headers:{"Content-Type":t.contentType},body:l.searchParams};return(0,p.fetchWithRetry)(t.url,d).then(function(t){return t.json()}).then(v).then(function(t){return t[e]}).catch(function(t){return Promise.reject({message:t.message})})},_=(n.taoBaoProductHasCashback=function(t,n,r){return d(r,n.toLowerCase(),(0,o.default)({},r.methods.getCashBackStatus.params,{num_iids:t})).then(function(t){var n=r.methods.getCashBackStatus.resultKey;return l(t,n)&&t.results[n][0]&&t.results[n][0].material_lib_type&&h.TAOBAO_MATERIAL_LIB_TYPE_HAS_CASHBACK.includes(t.results[n][0].material_lib_type)}).catch(function(t){return t.message!==r.methods.getCashBackStatus.errorCodes.noResult&&t.message!==r.methods.getCashBackStatus.errorCodes.rateLimitExceeded&&t.message!==r.methods.getCashBackStatus.errorCodes.internalError&&Promise.reject({message:t.message})})},n.getTaoBaoProductDeepLink=function(t,n,r){return d(r,n.toLowerCase(),(0,o.default)({},r.methods.getDeepLink.params,{num_iids:t})).then(function(t){var n=r.methods.getDeepLink.resultKey;return l(t,n)&&t.results[n][0].click_url?t.results[n][0].click_url:""}).catch(function(t){return Promise.reject({message:t.message})})},n.redirectToDeepLink=function(t,n,r){var e=t.getState(),i=(0,a.matchMerchant)(e,{url:n}),o=(0,s.getActivatedProductIdByTab)(e,{tabId:r});if(i&&i.isTaobao&&o){var u=(0,s.getTaoBaoSettings)(e).aiTaoBaoSearchPattern;if(!new RegExp(u).test(n))return!1;var f=new URL(n).searchParams.get("unid");if(!f)return!1;var p=e.taoBao.products[o];if(!p)return!1;if(p.activateState!==h.ACTIVATE_STATE_ACTIVATING)return!1;if(p.redirectedToDeepLink)return!1;if(!p.deepLink)return!1;t.dispatch((0,c.uiDeepLinkRedirect)({productId:o,tabId:r}));var l=new URL(p.deepLink);return l.searchParams.append("unid",f),window.location.replace(l.href),!0}return!1},n.getProductLinkElem=function(t,n){return t.querySelector(n)}),E=n.getProductInfoElem=function(t,n){return t.querySelector(n)},m=n.getProductIdByProductLinkElem=function(t){if(!t)return"";var n=t.getAttribute("href");return n.startsWith("//")&&(n="https:"+n),new URL(n).searchParams.get("id")||""},T=n.getCartIdByProductListElem=function(t){return t.split("_")[2].trim()};n.getProductListMap=function(t,n,r){return t.map(function(t){return{productList:t,productInfo:E(t,r),productId:m(_(t,n)),cartId:T(t.id)}})},n.isProductFetchedFromTaoBao=function(t){return!!(t&&Object.prototype.hasOwnProperty.call(t,"activateState")&&Object.prototype.hasOwnProperty.call(t,"hasCashback")&&Object.prototype.hasOwnProperty.call(t,"deepLink"))}},177:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=s(r(5)),i=s(r(38));n.toggleTaoBaoSearchBox=function(){return{type:c.TAOBAO_TOGGLE_SEARCH_BOX}},n.uiToggleTaoBaoSearchBox=function(){return{type:c.TAOBAO_TOGGLE_SEARCH_BOX}},n.openTaoBaoNotifier=function(){return{type:c.TAOBAO_OPEN_NOTIFIER}},n.uiOpenTaoBaoNotifier=function(){return{type:c.TAOBAO_OPEN_NOTIFIER}},n.closeTaoBaoNotifier=function(){return{type:c.TAOBAO_CLOSE_NOTIFIER}},n.uiCloseTaoBaoNotifier=function(){return{type:c.TAOBAO_CLOSE_NOTIFIER}},n.closeTaoBaoConfirmationNotifier=function(){return{type:c.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER}},n.uiCloseTaoBaoConfirmationNotifier=function(){return{type:c.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER}},n.openTaoBaoConfirmationNotifier=function(){return{type:c.TAOBAO_OPEN_CONFIRMATION_NOTIFIER}},n.uiOpenTaoBaoConfirmationNotifier=function(){return{type:c.TAOBAO_OPEN_CONFIRMATION_NOTIFIER}},n.openTaoBaoApiDownNotifier=function(){return{type:c.TAOBAO_OPEN_API_DOWN_NOTIFIER}},n.uiOpenTaoBaoApiDownNotifier=function(){return{type:c.TAOBAO_OPEN_API_DOWN_NOTIFIER}},n.closeTaoBaoApiDownNotifier=function(){return{type:c.TAOBAO_CLOSE_API_DOWN_NOTIFIER}},n.uiCloseTaoBaoApiDownNotifier=function(){return{type:c.TAOBAO_CLOSE_API_DOWN_NOTIFIER}},n.fetchTaoBaoProductCashbackStatusSuccess=f,n.fetchTaoBaoProductCashbackStatus=function(t){var n=t.productId;return function(t,r){var e=r(),s=e.cc,p=(0,o.getTaoBaoSettings)(e),h=p.api;return(0,u.taoBaoProductHasCashback)(n,s,h).then(function(t){return t?Promise.all([t,(0,u.getTaoBaoProductDeepLink)(n,s,h)]):Promise.resolve([t,""])}).then(function(r){var e=(0,i.default)(r,2),o=e[0],u=e[1];t(f(n,o,u))}).catch(function(n){var r=n.message;t((0,a.apiError)({errorType:c.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR,message:r}))})}},n.uiFetchTaoBaoProductCashbackStatus=function(t){return{type:c.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS,productId:t}},n.deactivateTaoBaoProduct=function(t){var n=t.productId;return{type:c.DEACTIVATE_TAOBAO_PRODUCT,payload:{productId:n}}},n.uiDeactivateTaoBaoProduct=function(t){return{type:c.DEACTIVATE_TAOBAO_PRODUCT,productId:t}},n.startActivateTaoBaoProduct=function(t){return{type:c.START_ACTIVATE_TAOBAO_PRODUCT,payload:{tabId:t.tabId,productId:t.productId}}},n.uiStartActivateTaoBaoProduct=function(t){return(0,e.default)({type:c.START_ACTIVATE_TAOBAO_PRODUCT},t)},n.setProductFromAiTaoBaoSearchToActivated=function(t){var n=t.productId;return{type:c.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED,payload:{productId:n}}},n.uiSetProductFromAiTaoBaoSearchToActivated=function(t){return{type:c.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED,productId:t}},n.activateTaoBaoProductFromSB=function(t){var n=t.productId;return{type:c.ACTIVATE_TAOBAO_PRODUCT_FROM_SB,payload:{productId:n}}},n.uiActivateTaoBaoProductFromSB=function(t){return{type:c.ACTIVATE_TAOBAO_PRODUCT_FROM_SB,productId:t}};var o=r(108),u=r(163),c=r(0),a=r(45);function s(t){return t&&t.__esModule?t:{default:t}}function f(t,n,r){return{type:c.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS,payload:{productId:t,hasCashback:n,deepLink:r}}}},18:function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},183:function(t,n,r){(function(t){!function(t){var n=function(){try{return!!Symbol.iterator}catch(t){return!1}}(),r=function(t){var r={next:function(){var n=t.shift();return{done:void 0===n,value:n}}};return n&&(r[Symbol.iterator]=function(){return r}),r},e=function(t){return encodeURIComponent(t).replace(/%20/g,"+")},i=function(t){return decodeURIComponent(t).replace(/\+/g," ")};"URLSearchParams"in t&&"a=1"===new URLSearchParams("?a=1").toString()||function(){var o=function(t){if(Object.defineProperty(this,"_entries",{value:{}}),"string"==typeof t){if(""!==t)for(var n,r=(t=t.replace(/^\?/,"")).split("&"),e=0;e<r.length;e++)n=r[e].split("="),this.append(i(n[0]),n.length>1?i(n[1]):"")}else if(t instanceof o){var u=this;t.forEach(function(t,n){u.append(t,n)})}},u=o.prototype;u.append=function(t,n){t in this._entries?this._entries[t].push(n.toString()):this._entries[t]=[n.toString()]},u.delete=function(t){delete this._entries[t]},u.get=function(t){return t in this._entries?this._entries[t][0]:null},u.getAll=function(t){return t in this._entries?this._entries[t].slice(0):[]},u.has=function(t){return t in this._entries},u.set=function(t,n){this._entries[t]=[n.toString()]},u.forEach=function(t,n){var r;for(var e in this._entries)if(this._entries.hasOwnProperty(e)){r=this._entries[e];for(var i=0;i<r.length;i++)t.call(n,r[i],e,this)}},u.keys=function(){var t=[];return this.forEach(function(n,r){t.push(r)}),r(t)},u.values=function(){var t=[];return this.forEach(function(n){t.push(n)}),r(t)},u.entries=function(){var t=[];return this.forEach(function(n,r){t.push([r,n])}),r(t)},n&&(u[Symbol.iterator]=u.entries),u.toString=function(){var t="";return this.forEach(function(n,r){t.length>0&&(t+="&"),t+=e(r)+"="+e(n)}),t},t.URLSearchParams=o}()}(void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this),function(t){if(function(){try{var t=new URL("b","http://a");return t.pathname="c%20d","http://a/c%20d"===t.href&&t.searchParams}catch(t){return!1}}()||function(){var n=t.URL,r=function(t,n){"string"!=typeof t&&(t=String(t));var r=document.implementation.createHTMLDocument("");if(window.doc=r,n){var e=r.createElement("base");e.href=n,r.head.appendChild(e)}var i=r.createElement("a");if(i.href=t,r.body.appendChild(i),i.href=i.href,":"===i.protocol||!/:/.test(i.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:i})},e=r.prototype;["hash","host","hostname","port","protocol","search"].forEach(function(t){!function(t){Object.defineProperty(e,t,{get:function(){return this._anchorElement[t]},set:function(n){this._anchorElement[t]=n},enumerable:!0})}(t)}),Object.defineProperties(e,{toString:{get:function(){var t=this;return function(){return t.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(t){this._anchorElement.href=t},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(t){this._anchorElement.pathname=t},enumerable:!0},origin:{get:function(){var t={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],n=this._anchorElement.port!=t&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(n?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(t){},enumerable:!0},username:{get:function(){return""},set:function(t){},enumerable:!0},searchParams:{get:function(){var t=new URLSearchParams(this.search),n=this;return["append","delete","set"].forEach(function(r){var e=t[r];t[r]=function(){e.apply(t,arguments),n.search=t.toString()}}),t},enumerable:!0}}),r.createObjectURL=function(t){return n.createObjectURL.apply(n,arguments)},r.revokeObjectURL=function(t){return n.revokeObjectURL.apply(n,arguments)},t.URL=r}(),void 0!==t.location&&!("origin"in t.location)){var n=function(){return t.location.protocol+"//"+t.location.hostname+(t.location.port?":"+t.location.port:"")};try{Object.defineProperty(t.location,"origin",{get:n,enumerable:!0})}catch(r){setInterval(function(){t.location.origin=n()},100)}}}(void 0!==t?t:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this)}).call(n,r(20))},19:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isYahooRedirectUrl=n.patchCouponStatsAPI=n.getTrendingCouponsAPI=n.getCouponReportIssuePage=n.getCouponCodesNotWorkPage=n.isSBHomePage=n.getHtmlParseServiceUrl=n.getCouponsByMerchantAPI=n.getDealsAPI=n.getEventTrackingAPI=n.getSettingsAPI=n.getMerchantsAPI=n.getRefreshTokenAPI=n.getAccountAPI=n.getTaobaoGuidePage=n.getLinkTaoBaoToActivatePage=n.getLoginToActivatePage=n.getFAQPage=n.getReferPage=n.getOverviewPage=n.getWithdrawPage=n.getLogoutPage=n.getLoginPage=n.getHomePage=n.getTaobaoActivatePage=n.getActivatePage=n.getUrlDomain=n.getHelpCenterFromCC=n.getExtensionStoreFromCC=n.getDomainFromCC=n.getCCFromDomain=n.listWebsiteLoginAPIPatterns=n.getHost=n.isSBPage=n.isLoginPage=n.isProductRedirectPage=n.isMerchantRedirectPage=n.isRedirectPage=void 0;var e=r(0),i=r(52);n.default=i;n.isRedirectPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1];return n.includes(i.SB_WEBSITE_XX[t]+"/redirect/alink")||n.includes(i.SB_WEBSITE_XX[t]+"/product/redirect/plink")},n.isMerchantRedirectPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(i.SB_WEBSITE_XX[t]+"/redirect/alink")},n.isProductRedirectPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1];return n.includes(i.SB_WEBSITE_XX[t]+"/product/redirect/plink")||new URL(n).searchParams.get("storeId")},n.isLoginPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(i.SB_WEBSITE_XX[t]+"/login")},n.isSBPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(""+i.SB_WEBSITE_XX[t])};var o=n.getHost=function(t){return"https://"+((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{api:!0}).api?i.API_HOST_XX:i.SB_WEBSITE_XX)[function(t){return i.API_HOST_XX[t]?t:e.DEFAULT_COUNTRY}(t)]},u=(n.listWebsiteLoginAPIPatterns=function(){return Object.keys(i.SB_WEBSITE_XX).reduce(function(t,n){return t.push("*://"+i.SB_WEBSITE_XX[n]+"/account/login","*://"+i.SB_WEBSITE_XX[n]+"/account/authenticateWithFacebook")&&t},[])},n.getCCFromDomain=function(t){var n=t.split(".");return n[n.length-1].toUpperCase()},n.getDomainFromCC=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_WEBSITE_XX[t]},n.getExtensionStoreFromCC=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return e.IS_FIREFOX?i.EXTENSION_STORES.FIREFOX:i.EXTENSION_STORES[t]},n.getHelpCenterFromCC=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.HELP_CENTER[t]},n.getUrlDomain=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/(?:https?:\/\/)?(?:\w+:\/)?[^:?#/\s]*?([^.\s]+\.(?:[a-z]{2,}|co\.uk|org\.uk|ac\.uk|org\.au|com\.au))(?:[:?#/]|$)/gi.exec(t)},n.getActivatePage=function(t,n){var r=new URL(t);return r.searchParams.has("utm_medium")&&"be"!==r.searchParams.get("utm_medium")||r.searchParams.set("utm_medium",n),r.href}),c=n.getTaobaoActivatePage=function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.UTM_BE_TAOBAO_SEARCH,o=encodeURIComponent(r),u=new URL(t);return u.searchParams.set("storeId",n),u.searchParams.set("search",o),u.searchParams.set("utm_medium",i),u.toString()},a=n.getHomePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return""+o(t,{api:!1})};n.getLoginPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/login"},n.getLogoutPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/logout"},n.getWithdrawPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/payment"},n.getOverviewPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/cashback"},n.getReferPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/referral/invite"},n.getFAQPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/cashback-button/how-it-works"},n.getLoginToActivatePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1],r=arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(n&&r){var a=new URL(u(n,r)),s=""+a.pathname+a.search;i&&c&&(s+="&from_taobao");var f=encodeURIComponent(s);return o(t,{api:!1})+"/login?redirect="+f}return o(t,{api:!1})+"/login"},n.getLinkTaoBaoToActivatePage=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=e&&i?c(n,e,i,r):u(n,r),s=new URL(a),f=""+s.pathname+s.search,p=encodeURIComponent(f);return o(t,{api:!1})+"/taobao/link?redirect="+p},n.getTaobaoGuidePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t,{api:!1})+"/taobao#guide"},n.getAccountAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t)+"/api/v2/accounts/me"},n.getRefreshTokenAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t)+"/members/me/refresh-jwt-token"},n.getMerchantsAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?new URL(o(t)+"/api/v2/stores"):new URL(o(t)+"/api/stores");return n.confirmation&&r.push("confirmation-urls"),n.disableReason&&r.push("cashback-disable-reasons"),n.metaInfo?r.push("store-meta-info"):n.top&&i.searchParams.set("top","true"),r.length>0&&i.searchParams.set("metadata",r.join(",")),i.toString()},n.getSettingsAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t)+"/api/settings"},n.getEventTrackingAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1];return n===e.EVENT_EXT_INSTALLED?o(t)+"/api/events/ext-installed":n===e.EVENT_EXT_PAGE_VISITED?o(t)+"/api/events/ext-page-visited":n===e.EVENT_EXT_NOTIFIER_PROMPT?o(t)+"/api/events/ext-notifier-prompt":n===e.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT?o(t)+"/api/events/ext-notifier-activated":n===e.EVENT_EXT_SEARCH?o(t)+"/api/events/ext-search":n===e.EVENT_EXT_CLICK?o(t)+"/api/events/ext-click":n===e.EVENT_EXT_REDIRECT?o(t)+"/api/events/ext-redirect":n===e.EVENT_EXT_LOGIN?o(t)+"/api/events/ext-login":n===e.EVENT_EXT_MENU_OPEN?o(t)+"/api/events/ext-menu-open":n===e.EVENT_EXT_UPDATED?o(t)+"/api/events/ext-updated":n===e.EVENT_EXT_SERP_VISITED?o(t)+"/api/events/ext-serp-view":n===e.EVENT_EXT_SERP_CLICKED?o(t)+"/api/events/ext-serp-click":n===e.EVENT_EXT_APPLY_COUPON_CODE?o(t)+"/api/events/ext-apply-coupon-code":n===e.EVENT_EXT_ERROR_OCCURED?o(t)+"/api/events/ext-error":n===e.EVENT_EXT_MANUAL_APPLY_COUPON_CODE?o(t)+"/api/events/ext-success-code":""},n.getDealsAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1];return isNaN(parseInt(n,10))?o(t)+"/deals?top=true":o(t)+"/deals?store_id="+n},n.getCouponsByMerchantAPI=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_COUNTRY;return o(n)+"/api/v2/coupons/merchant/"+t},n.getHtmlParseServiceUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t)+"/api/parsers/html"},n.isSBHomePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1],r=new URL(n),i=new URL(a(t));return r.href===i.href},n.getCouponCodesNotWorkPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_HELP_CENTER_COUPON_CODES_NOT_WORK_XX[t]},n.getCouponReportIssuePage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_COUPONS_REPORT_ISSUE_XX[t]},n.getTrendingCouponsAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(t)+"/api/v1/coupons/trending-codes"},n.patchCouponStatsAPI=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,n=arguments[1];return o(t)+"/api/v1/coupons/"+n},n.isYahooRedirectUrl=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!t&&/r\.search\.yahoo\.com/.test(t)}},2:function(t,n){var r=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},22:function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},23:function(t,n){t.exports=!0},247:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isTabReadyToBeClosed=void 0;var e=r(17);n.isTabReadyToBeClosed=(0,e.createSelector)([function(t){return t.readyToBeClosedTabs},function(t,n){return n.tabId}],function(t,n){return!!t[n]})},255:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=h(r(5)),i=h(r(75));n.loginOK=l,n.loginNotOK=v,n.logout=d,n.uiLogout=function(t){return{type:f.LOGOUT,cc:t}},n.dropSBCookie=_,n.setSBCookie=E,n.fetchUser=T,n.uiFetchUser=function(){return{type:f.FETCH_USER_INFO}},n.syncUserFromShopBack=function(t){var n=t.profileId,r=t.userToken,e=t.userRefreshToken,i=t.userTokenDomain,o=t.url,u=t.tabId,c=void 0===u?-1:u;return function(t){var u=(0,p.getCCFromDomain)(i);return r?t(T(u,r,e,i)).then(function(){return t(l(u,n,r,e,i,c,o))}).catch(function(){return t(v(u,n))}):(0,p.isLoginPage)(u,o)?Promise.resolve():t(d({cc:u,profileId:n}))}},n.uiSyncUserFromShopBack=function(t){return(0,e.default)({type:f.SYNC_USER_FROM_SHOPBACK},t)},n.uiSwitchUser=function(t){return{type:f.SWITCH_USER,cc:t}},n.switchUser=function(t){var n=t.cc;return function(t,r){var e=(0,o.findLoginHistory)(r(),{cc:n});return t({type:f.SWITCH_USER,payload:{cc:n}}),t(T(n,e.token,e.refreshToken,e.tokenDomain))}};var o=r(119),u=r(63),c=r(247),a=r(158),s=r(45),f=r(0),p=r(19);function h(t){return t&&t.__esModule?t:{default:t}}function l(t,n,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,u=arguments[6];return function(s,h){(0,c.isTabReadyToBeClosed)(h(),{tabId:o})&&(0,p.isSBHomePage)(t,u)&&s((0,a.closeTab)({tabId:o})),s({type:f.LOGIN_OK,payload:{cc:t,profileId:n,token:r,refreshToken:e,tokenDomain:i}}),browser.tabs.sendMessage(o,{action:f.LOGIN_OK}).catch(function(){})}}function v(t,n){return{type:f.LOGIN_NOT_OK,payload:{cc:t,profileId:n}}}function d(t){return{type:f.LOGOUT,payload:t}}function _(t){var n=t.cc;return function(t){return browser.cookies.remove({url:(0,p.getHomePage)(n),name:f.ACCESS_TOKEN_NAME}).then(function(){return t({type:f.DROP_COOKIE_DONE})}).catch(function(){return t({type:f.DROP_COOKIE_DONE})})}}function E(t){var n=t.cc,r=t.accessToken;return function(t){return browser.cookies.set({url:(0,p.getHomePage)(n),name:f.ACCESS_TOKEN_NAME,value:r,expirationDate:parseInt(Date.now()/1e3,10)+f.SECONDS_OF_ONE_YEAR,sameSite:"lax"}).then(function(){return t({type:f.SET_COOKIE_DONE})}).catch(function(){return t({type:f.SET_COOKIE_FAIL})})}}var m=function(t,n){var r,e=n.token,o=n.refreshToken,u=n.tokenDomain,c=(0,p.getAccountAPI)(t),a={headers:(r={},(0,i.default)(r,f.HEADERS.X_SHOPBACK_LAST_CC,t),(0,i.default)(r,f.HEADERS.X_SHOPBACK_DOMAIN,u),(0,i.default)(r,f.HEADERS.X_SHOPBACK_CLIENT_USER_AGENT,navigator.userAgent),(0,i.default)(r,f.HEADERS.X_SHOPBACK_ACCESS_TOKEN,e),(0,i.default)(r,f.HEADERS.X_SHOPBACK_REFRESH_TOKEN,o),r)};return fetch(c,a)};function T(t,n,r,e){return function(i,o){var c=n?{token:n,refreshToken:r,tokenDomain:e}:o().user,a=(t||o().cc).toUpperCase();return m(a,c).then(function(t){return 401===t.status&&(i(d({cc:a})),i(_({cc:a}))),t}).then(u.handleErrors).then(function(t){return t.json()}).then(function(t){var n,r;t.newAccessToken&&(i((n=t.newAccessToken,{type:f.REFRESH_ACCESS_TOKEN_SUCCESS,payload:{token:n}})),i(E({cc:a,accessToken:t.newAccessToken}))),i((r=t,{type:f.FETCH_USER_INFO_SUCCESS,payload:{user:r}}))}).catch(function(t){var n=t.message;return i((0,s.apiError)({errorType:f.FETCH_USER_INFO_ERROR,message:n})),Promise.reject({message:n})})}}},26:function(t,n,r){var e=r(60),i=r(42);t.exports=Object.keys||function(t){return e(t,i)}},27:function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},28:function(t,n,r){"use strict";var e=r(88)(!0);r(54)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},29:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getActivatedMerchantInfo=n.l=n.h=n.v=n.isActivateFromPartnership=n.isActivated=n.getActivatedTimeByMerchant=n.findByExt=void 0;var e=r(17),i=function(t){return t.activation.byExt},o=function(t,n){return n.merchant},u=n.findByExt=function(t,n){return t.activation.byExt[n.merchantId]},c=(n.getActivatedTimeByMerchant=(0,e.createSelector)([o,i],function(t,n){return n[t.id]?n[t.id].activatedAt:null}),n.isActivated=(0,e.createSelector)([o,i],function(t,n){return!!t&&!(!n[t.id]||!n[t.id].activated)})),a=(n.isActivateFromPartnership=(0,e.createSelector)([o,i],function(t,n){return!!t&&!(!n[t.id]||void 0===n[t.id].partnershipId)}),n.v=(0,e.createSelector)([o,i],function(t,n){if(!t)return!1;var r=n[t.id];return!!(r&&r.disabled&&r.focusing)})),s=n.h=(0,e.createSelector)([o,i],function(t,n){return!!t&&!(!n[t.id]||!n[t.id].disabled)});n.l=(0,e.createSelector)([s,a],function(t,n){return t&&!n}),n.getActivatedMerchantInfo=(0,e.createSelector)([c,o,function(t){return t}],function(t,n,r){if(t)return u(r,{merchantId:n.id})})},3:function(t,n,r){var e=r(41)("wks"),i=r(27),o=r(4).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},32:function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},33:function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},34:function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},347:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uiSetIconBadgeText=n.getTabOfContentScript=void 0,r(157);var e=r(0);n.getTabOfContentScript=function(){return browser.runtime.sendMessage({action:e.GET_TAB_OF_CONTENT_SCRIPT})},n.uiSetIconBadgeText=function(t){return browser.runtime.sendMessage({action:e.SET_ICON_BADGE_TEXT,totalCodes:t})}},35:function(t,n,r){var e=r(41)("keys"),i=r(27);t.exports=function(t){return e[t]||(e[t]=i(t))}},36:function(t,n){n.f={}.propertyIsEnumerable},37:function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},38:function(t,n,r){"use strict";n.__esModule=!0;var e=o(r(78)),i=o(r(90));function o(t){return t&&t.__esModule?t:{default:t}}n.default=function(){return function(t,n){if(Array.isArray(t))return t;if((0,e.default)(Object(t)))return function(t,n){var r=[],e=!0,o=!1,u=void 0;try{for(var c,a=(0,i.default)(t);!(e=(c=a.next()).done)&&(r.push(c.value),!n||r.length!==n);e=!0);}catch(t){o=!0,u=t}finally{try{!e&&a.return&&a.return()}finally{if(o)throw u}}return r}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},39:function(t,n,r){r(80);for(var e=r(4),i=r(12),o=r(14),u=r(3)("toStringTag"),c="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),a=0;a<c.length;a++){var s=c[a],f=e[s],p=f&&f.prototype;p&&!p[u]&&i(p,u,s),o[s]=o.Array}},4:function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},40:function(t,n,r){var e=r(8).f,i=r(10),o=r(3)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},41:function(t,n,r){var e=r(2),i=r(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:e.version,mode:r(23)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},42:function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},43:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getMerchantByAffiliateId=n.shouldFetchMerchants=n.getMerchantMetaHash=n.getMerchantOfSerpMap=n.merchantHasCashback=n.getStandDownNotifierTimerId=n.isReloadNecessaryMerchant=n.transformWithPartnership=n.mapReason=n.d=n.findPartnershipMerchant=n.findMerchant=n.matchConfirmPage=n.isInConfirmPage=n.matchMerchant=n.findTaobaoRelatedMerchant=void 0;var e=s(r(5)),i=s(r(38)),o=r(17),u=r(0),c=r(29),a=r(19);function s(t){return t&&t.__esModule?t:{default:t}}var f=function(t){return t.merchants.all},p=function(t,n){return n.url},h=function(t,n){return n.id};n.findTaobaoRelatedMerchant=(0,o.createSelector)([f],function(t){return t.filter(function(t){return t.isTaobao})});var l=n.matchMerchant=(0,o.createSelector)([f,p,function(t,n){return(0,a.getUrlDomain)(n.url)}],function(t,n,r){if(r){var e=(0,i.default)(r,2),o=e[0],u=e[1],c=t.filter(function(t){return t.rx=t.url_pattern?new RegExp(t.url_pattern):null,(o.indexOf(t.url_domain)>=0||u.indexOf(t.url_domain)>=0)&&t.rx&&t.rx.test(n)});if(c.length)return a=c,s=(0,i.default)(a,1)[0],a.forEach(function(t){t.rx>s.rx&&(s=t)}),s}var a,s;return null}),v=n.isInConfirmPage=(0,o.createSelector)([function(t,n){return n.merchant},p],function(t,n){return!!t&&(t.metadata.confirmation_urls.length>0&&t.metadata.confirmation_urls.some(function(t){return new RegExp(t).test(n)}))}),d=(n.matchConfirmPage=(0,o.createSelector)([f,p],function(t,n){return t.find(function(t){return v({},{merchant:t,url:n})})}),n.findMerchant=(0,o.createSelector)([f,h],function(t,n){return t.find(function(t){return t.id===n})})),_=(n.findPartnershipMerchant=(0,o.createSelector)([f,h],function(t,n){return t.find(function(t){var r=Object.keys(t.partnership_stores);return r.length>0&&r.indexOf(""+n)>-1})}),n.d=(0,o.createSelector)([function(t){return t},function(t,n){return n.referrer},function(t,n){return n.merchant}],function(t,n,r){var e=l(t,{url:n});return r.metadata.check_referrer&&!(0,a.isSBPage)(t.cc,n)&&!(e&&e.id===r.id)}),n.mapReason=(0,o.createSelector)([function(t){return t.settings.cashbackDisableReasons},function(t,n){return n.merchant}],function(t,n){return n?t[n.metadata.cashback_disable_reasons]||t[u.DEFAULT_DISABLE_REASON]:null}),n.transformWithPartnership=(0,o.createSelector)([function(t){return t},function(t,n){return n.merchant},c.isActivateFromPartnership,function(t,n){return n.activated},function(t,n){return n.disabled}],function(t,n,r,i,o){if(!n||!r)return n;if(i||o){var u=(0,c.findByExt)(t,{merchantId:n.id}),a=(0,e.default)({},n),s=n.partnership_stores[u.partnershipId];return a.activation_url=s.activation_url,a.cashback_amount=s.cashback_amount,a.cashbackHeader=s.cashbackHeader,a.reActivateX=s.reActivateX,a}return n}),n.isReloadNecessaryMerchant=(0,o.createSelector)([function(t,n){return n.merchant}],function(t){return t&&t.metadata.reload_tabs}),n.getStandDownNotifierTimerId=(0,o.createSelector)([d],function(t){return t&&t.standDownTimerId}),n.merchantHasCashback=(0,o.createSelector)([d],function(t){return!(!t||!t.cashback)&&!!parseFloat(t.cashback.amount)}));n.getMerchantOfSerpMap=(0,o.createSelector)([function(t,n){return n.links.filter(function(t){return!t.getAttribute("shopback-serp")})},function(t){return t}],function(t,n){var r=[];return t.forEach(function(t){var e=t.getAttribute("href");if((0,a.isYahooRedirectUrl)(e)){var i=new URL(e).pathname.split("/").find(function(t){return t.startsWith("RU=")});i&&(e=decodeURIComponent(i.split("=").pop()))}var o=l(n,{url:e});o&&!1!==o.isSerpEnabled&&_(n,{id:o.id})&&r.push({link:t,merchant:o})}),r}),n.getMerchantMetaHash=(0,o.createSelector)([f],function(t){var n={};return t.forEach(function(t){n[t.id]={logoUrl:t.logo_url,activationUrl:t.activation_url,hasCashBack:!!t.cashback&&!!parseFloat(t.cashback.amount)}}),n}),n.shouldFetchMerchants=(0,o.createSelector)([function(t){return t.merchants},function(t,n){return n.now}],function(t,n){if(!t)return!0;var r=t.fetchedAt;return"number"!=typeof r||n-r>u.REFETCH_MERCHANT_INTERVAL_MS}),n.getMerchantByAffiliateId=(0,o.createSelector)([f,function(t,n){return n.affiliateId}],function(t,n){return t.find(function(t){return t.affiliated_id===n})})},45:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uiDirtyLoginFromMenu=n.dirtyLoginFromMenu=n.clearDirtyLoginFromMenu=n.cleanActivation=n.uiPopupOpen=n.popupOpen=n.uiDeepLinkRedirect=n.deepLinkRedirect=n.apiError=void 0;var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);n.apiError=function(t){return{type:u.API_ERROR,payload:t}},n.deepLinkRedirect=function(t){var n=t.merchantId,r=t.productId,e=t.tabId;return{type:u.DEEP_LINK_REDIRECT,payload:{merchantId:n,productId:r,tabId:e}}},n.uiDeepLinkRedirect=function(t){var n=t.merchantId,r=t.productId,e=t.tabId;return{type:u.DEEP_LINK_REDIRECT,merchantId:n,productId:r,tabId:e}},n.popupOpen=function(){return{type:u.OPEN_POPUP_UI}},n.uiPopupOpen=function(){return{type:u.OPEN_POPUP_UI}},n.cleanActivation=function(){return{type:u.CLEAN_ACTIVATION}},n.clearDirtyLoginFromMenu=function(t){return{type:u.CLEAR_DIRTY_LOGIN_FROM_MENU,payload:{from:t}}},n.dirtyLoginFromMenu=function(t){return{type:u.DIRTY_LOGIN_FROM_MENU,payload:(0,o.default)({},t)}},n.uiDirtyLoginFromMenu=function(t){return{type:u.DIRTY_LOGIN_FROM_MENU,from:t}}},46:function(t,n,r){var e=r(65);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},47:function(t,n,r){var e=r(15);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},48:function(t,n,r){var e=r(9),i=r(84),o=r(42),u=r(35)("IE_PROTO"),c=function(){},a=function(){var t,n=r(50)("iframe"),e=o.length;for(n.style.display="none",r(73).appendChild(n),n.src="javascript:",(t=n.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a.prototype[o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c.prototype=e(t),r=new c,c.prototype=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},49:function(t,n){n.f=Object.getOwnPropertySymbols},5:function(t,n,r){"use strict";n.__esModule=!0;var e,i=r(93),o=(e=i)&&e.__esModule?e:{default:e};n.default=o.default||function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])}return t}},50:function(t,n,r){var e=r(15),i=r(4).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},51:function(t,n,r){var e=r(32),i=r(3)("toStringTag"),o="Arguments"==e(function(){return arguments}());t.exports=function(t){var n,r,u;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=Object(t),i))?r:o?e(n):"Object"==(u=e(n))&&"function"==typeof n.callee?"Arguments":u}},52:function(t,n){t.exports={URL_AFTER_INSTALL:"https://www.shopback.com/cashback-button/success",URL_AFTER_UNINSTALL:"https://www.shopback.com/uninstall",URL_COUNTRY_CODE:"https://api.shopback.com/location/countrycode",API_HOST_XX:{COM:"api.shopback.com",SG:"api.shopback.sg",MY:"api.shopback.my",PH:"api.shopback.ph",ID:"api.shopback.co.id",IN:"api.shopback.in",TW:"api.shopback.com.tw",AU:"api.shopback.com.au",TH:"api.myshopback.co.th"},SB_WEBSITE_XX:{COM:"www.shopback.com",SG:"www.shopback.sg",MY:"www.shopback.my",PH:"www.shopback.ph",ID:"www.shopback.co.id",IN:"www.shopback.in",TW:"www.shopback.com.tw",AU:"www.shopback.com.au",TH:"www.shopback.co.th"},EXTENSION_STORES:{COM:"https://chrome.google.com/webstore/detail/shopback-cashback-button/clomojagppekiladdknhnpjoihabjmnm",SG:"https://chrome.google.com/webstore/detail/shopback-cashback-button/hjngckebbndpdeeakdgohmcdnecidcjk",MY:"https://chrome.google.com/webstore/detail/shopback-cashback-button/fgobhpdfgjoognbahjpeabmlheajfpik",PH:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ngeinbnbakgkpcmokhonplkllgbnohoo",ID:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ambfhpcdfdlobjbckfbajgdoohfhaahn",TW:"https://chrome.google.com/webstore/detail/shopback-%E7%8F%BE%E9%87%91%E5%9B%9E%E9%A5%8B%E5%B0%8F%E5%B9%AB%E6%89%8B/djjjmdgomejlopjnccoejdhgjmiappap",AU:"https://chrome.google.com/webstore/detail/shopback-cashback-button/dlkceoecbkpgngncmlcbmcnedjkpihni",TH:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ccbgpokbhaoahpebadnnjeoamielibki",FIREFOX:"https://addons.mozilla.org/en-US/firefox/addon/shopback-cashback-button"},HELP_CENTER:{COM:"https://shopback.zendesk.com/hc/en-us/articles/215540757",SG:"https://support.shopback.sg/hc/en-us/articles/115010365348",MY:"https://support.shopback.my/hc/en-us/articles/115010204007",PH:"https://support.shopback.ph/hc/en-us/articles/115010204547",ID:"https://support.shopback.co.id/hc/en-us/articles/115010369648",TW:"https://support.shopback.com.tw/hc/zh-tw/articles/360013698513",AU:"https://support.shopback.com.au/hc/en-us/articles/360001888848",TH:"https://support.shopback.co.th/hc/th/articles/360013913233"},SB_HELP_CENTER_COUPON_CODES_NOT_WORK_XX:{COM:"https://support.shopback.sg/hc/en-us/articles/360025371214",SG:"https://support.shopback.sg/hc/en-us/articles/360025371214",MY:"https://support.shopback.sg/hc/en-us/articles/360025371214",PH:"https://support.shopback.sg/hc/en-us/articles/360025371214",ID:"https://support.shopback.sg/hc/en-us/articles/360025371214",IN:"https://support.shopback.sg/hc/en-us/articles/360025371214",TW:"https://support.shopback.sg/hc/en-us/articles/360025371214",AU:"https://support.shopback.sg/hc/en-us/articles/360025371214",TH:"https://support.shopback.sg/hc/en-us/articles/360025371214"},SB_COUPONS_REPORT_ISSUE_XX:{COM:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",SG:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",MY:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",PH:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",ID:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",IN:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",TW:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",AU:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",TH:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform"},ACTIVATED_EXPIRED_MS:36e5,ACTIVATED_EXPIRED_MS_FOR_TAOBAO:864e5,PERMISSION_NOTIFIER_TTL:36e5,SENTRY_DSN:"https://5740ea62fe804eeaa16f0b7c55d9f521@sentry.io/1189626",SENTRY_SAMPLE_RATE:.2}},53:function(t,n,r){var e=r(32);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},54:function(t,n,r){"use strict";var e=r(23),i=r(13),o=r(59),u=r(12),c=r(14),a=r(83),s=r(40),f=r(87),p=r(3)("iterator"),h=!([].keys&&"next"in[].keys()),l=function(){return this};t.exports=function(t,n,r,v,d,_,E){a(r,n,v);var m,T,b,y=function(t){if(!h&&t in S)return S[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},O=n+" Iterator",I="values"==d,g=!1,S=t.prototype,R=S[p]||S["@@iterator"]||d&&S[d],w=R||y(d),A=d?I?y("entries"):w:void 0,C="Array"==n&&S.entries||R;if(C&&(b=f(C.call(new t)))!==Object.prototype&&b.next&&(s(b,O,!0),e||"function"==typeof b[p]||u(b,p,l)),I&&R&&"values"!==R.name&&(g=!0,w=function(){return R.call(this)}),e&&!E||!h&&!g&&S[p]||u(S,p,w),c[n]=w,c[O]=l,d)if(m={values:I?w:y("values"),keys:_?w:y("keys"),entries:A},E)for(T in m)T in S||o(S,T,m[T]);else i(i.P+i.F*(h||g),n,m);return m}},55:function(t,n,r){(function(n){var e=r(71),i="undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{};function o(t){return void 0===t}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t){return"[object String]"===Object.prototype.toString.call(t)}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(){try{return new ErrorEvent(""),!0}catch(t){return!1}}function f(){if(!("fetch"in i))return!1;try{return new Headers,new Request(""),new Response,!0}catch(t){return!1}}function p(t,n){var r,e;if(o(t.length))for(r in t)h(t,r)&&n.call(null,r,t[r]);else if(e=t.length)for(r=0;r<e;r++)n.call(null,r,t[r])}function h(t,n){return Object.prototype.hasOwnProperty.call(t,n)}function l(t){for(var n,r=[],e=0,i=t.length;e<i;e++)c(n=t[e])?r.push(n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):n&&n.source&&r.push(n.source);return new RegExp(r.join("|"),"i")}function v(t){var n,r,e,i,o,u=[];if(!t||!t.tagName)return"";if(u.push(t.tagName.toLowerCase()),t.id&&u.push("#"+t.id),(n=t.className)&&c(n))for(r=n.split(/\s+/),o=0;o<r.length;o++)u.push("."+r[o]);var a=["type","name","title","alt"];for(o=0;o<a.length;o++)e=a[o],(i=t.getAttribute(e))&&u.push("["+e+'="'+i+'"]');return u.join("")}function d(t,n){return!!(!!t^!!n)}function _(t,n){if(d(t,n))return!1;var r,e,i=t.frames,o=n.frames;if(i.length!==o.length)return!1;for(var u=0;u<i.length;u++)if(r=i[u],e=o[u],r.filename!==e.filename||r.lineno!==e.lineno||r.colno!==e.colno||r.function!==e.function)return!1;return!0}var E=3,m=51200,T=40;function b(t){return function(t){return~-encodeURI(t).split(/%..|./).length}(JSON.stringify(t))}function y(t){if("string"==typeof t)return t.length<=40?t:t.substr(0,39)+"…";if("number"==typeof t||"boolean"==typeof t||void 0===t)return t;var n=Object.prototype.toString.call(t);return"[object Object]"===n?"[Object]":"[object Array]"===n?"[Array]":"[object Function]"===n?t.name?"[Function: "+t.name+"]":"[Function]":t}t.exports={isObject:function(t){return"object"==typeof t&&null!==t},isError:function(t){switch({}.toString.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return t instanceof Error}},isErrorEvent:function(t){return s()&&"[object ErrorEvent]"==={}.toString.call(t)},isUndefined:o,isFunction:function(t){return"function"==typeof t},isPlainObject:u,isString:c,isArray:a,isEmptyObject:function(t){if(!u(t))return!1;for(var n in t)if(t.hasOwnProperty(n))return!1;return!0},supportsErrorEvent:s,supportsFetch:f,supportsReferrerPolicy:function(){if(!f())return!1;try{return new Request("pickleRick",{referrerPolicy:"origin"}),!0}catch(t){return!1}},supportsPromiseRejectionEvent:function(){return"function"==typeof PromiseRejectionEvent},wrappedCallback:function(t){return function(n,r){var e=t(n)||n;return r&&r(e)||e}},each:p,objectMerge:function(t,n){return n?(p(n,function(n,r){t[n]=r}),t):t},truncate:function(t,n){return!n||t.length<=n?t:t.substr(0,n)+"…"},objectFrozen:function(t){return!!Object.isFrozen&&Object.isFrozen(t)},hasKey:h,joinRegExp:l,urlencode:function(t){var n=[];return p(t,function(t,r){n.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}),n.join("&")},uuid4:function(){var t=i.crypto||i.msCrypto;if(!o(t)&&t.getRandomValues){var n=new Uint16Array(8);t.getRandomValues(n),n[3]=4095&n[3]|16384,n[4]=16383&n[4]|32768;var r=function(t){for(var n=t.toString(16);n.length<4;)n="0"+n;return n};return r(n[0])+r(n[1])+r(n[2])+r(n[3])+r(n[4])+r(n[5])+r(n[6])+r(n[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0;return("x"===t?n:3&n|8).toString(16)})},htmlTreeAsString:function(t){for(var n,r=[],e=0,i=0,o=" > ".length;t&&e++<5&&!("html"===(n=v(t))||e>1&&i+r.length*o+n.length>=80);)r.push(n),i+=n.length,t=t.parentNode;return r.reverse().join(" > ")},htmlElementAsString:v,isSameException:function(t,n){return!d(t,n)&&(t=t.values[0],n=n.values[0],t.type===n.type&&t.value===n.value&&(r=t.stacktrace,e=n.stacktrace,(!o(r)||!o(e))&&_(t.stacktrace,n.stacktrace)));var r,e},isSameStacktrace:_,parseUrl:function(t){if("string"!=typeof t)return{};var n=t.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/),r=n[6]||"",e=n[8]||"";return{protocol:n[2],host:n[4],path:n[5],relative:n[5]+r+e}},fill:function(t,n,r,e){if(null!=t){var i=t[n];t[n]=r(i),t[n].__raven__=!0,t[n].__orig__=i,e&&e.push([t,n,i])}},safeJoin:function(t,n){if(!a(t))return"";for(var r=[],e=0;e<t.length;e++)try{r.push(String(t[e]))}catch(t){r.push("[value cannot be serialized]")}return r.join(n)},serializeException:function t(n,r,i){if(!u(n))return n;i="number"!=typeof(r="number"!=typeof r?E:r)?m:i;var o=function t(n,r){return 0===r?y(n):u(n)?Object.keys(n).reduce(function(e,i){return e[i]=t(n[i],r-1),e},{}):Array.isArray(n)?n.map(function(n){return t(n,r-1)}):y(n)}(n,r);return b(e(o))>i?t(n,r-1):o},serializeKeysForMessage:function(t,n){if("number"==typeof t||"string"==typeof t)return t.toString();if(!Array.isArray(t))return"";if(0===(t=t.filter(function(t){return"string"==typeof t})).length)return"[object has no keys]";if(n="number"!=typeof n?T:n,t[0].length>=n)return t[0];for(var r=t.length;r>0;r--){var e=t.slice(0,r).join(", ");if(!(e.length>n))return r===t.length?e:e+"…"}return""},sanitize:function(t,n){if(!a(n)||a(n)&&0===n.length)return t;var r,i=l(n),o="********";try{r=JSON.parse(e(t))}catch(n){return t}return function t(n){return a(n)?n.map(function(n){return t(n)}):u(n)?Object.keys(n).reduce(function(r,e){return i.test(e)?r[e]=o:r[e]=t(n[e]),r},{}):n}(r)}}}).call(n,r(20))},58:function(t,n,r){t.exports=!r(6)&&!r(18)(function(){return 7!=Object.defineProperty(r(50)("div"),"a",{get:function(){return 7}}).a})},59:function(t,n,r){t.exports=r(12)},6:function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},60:function(t,n,r){var e=r(10),i=r(16),o=r(85)(!1),u=r(35)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),a=0,s=[];for(r in c)r!=u&&e(c,r)&&s.push(r);for(;n.length>a;)e(c,r=n[a++])&&(~o(s,r)||s.push(r));return s}},63:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.fetchWithRetry=n.handleErrors=void 0;var e=r(113);n.handleErrors=function(t){if(!t.ok)throw(0,e.sendToSentry)(t),Error(t.statusText);return t},n.fetchWithRetry=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.retries||3,i=n.retryDelay||1e3,o=n.retryOnHttpStatus;o=o instanceof Array?o:[];var u=function(t,n){var r=n-1;setTimeout(function(){t(r)},i)};return new Promise(function(i,c){!function r(a){fetch(t,n).then(function(t){t.ok||t.redirected||(0,e.sendToSentry)(t),o&&-1===o.indexOf(t.status)?i(t):a>0?u(r,a):c(t)}).catch(function(t){(0,e.sendToSentry)(t),a>0?u(r,a):c(t)})}(r)})}},64:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.logger=void 0;var e,i=r(1),o=(e=i)&&e.__esModule?e:{default:e},u=r(110),c=r(0);var a=n.logger={info:function(t,n){if((0,u.isLoggerEnabled)(t.getState())){var r={message:n,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};console.groupCollapsed(n,r.timeStamp),console.trace(),console.info(r),console.groupEnd()}},warn:function(t,n){if((0,u.isLoggerEnabled)(t.getState())){var r={message:n,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};c.IS_FIREFOX?(console.groupCollapsed(n,r.timeStamp),console.trace(),console.warn(r),console.groupEnd()):console.warn(r)}},error:function(t,n){if((0,u.isLoggerEnabled)(t.getState())){var r={message:n,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};console.error(r)}}};n.default=a},65:function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},66:function(t,n,r){var e=r(34),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},67:function(t,n,r){var e=r(51),i=r(3)("iterator"),o=r(14);t.exports=r(2).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},69:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.uiTrackExtManualSuccessfulCode=n.trackExtManualSuccessfulCode=n.uiTrackExtErrorOccured=n.trackExtErrorOccured=n.uiTrackExtApplyCouponCode=n.trackExtApplyCouponCode=n.uiTrackExtSerpClicked=n.trackExtSerpClicked=n.uiTrackExtSerpVisited=n.trackExtSerpVisited=n.uiTrackExtMenuOpen=n.trackExtMenuOpen=n.uiTrackExtSwitchLogin=n.trackExtSwitchLogin=n.uiTrackExtRedirect=n.trackExtRedirect=n.uiTrackExtClick=n.trackExtClick=n.uiTrackExtSearch=n.trackExtSearch=n.uiTrackExtNotifierActivatedPrompt=n.trackExtNotifierActivatedPrompt=n.uiTrackExtNotifierPrompt=n.trackExtNotifierPrompt=n.uiTrackExtPageVisited=n.trackExtPageVisited=n.trackExtLogin=n.trackExtUpdated=n.trackExtInstalled=void 0;var e=u(r(105)),i=u(r(5)),o=function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n.default=t,n}(r(0));function u(t){return t&&t.__esModule?t:{default:t}}n.trackExtInstalled=function(){return{type:o.EVENT_EXT_INSTALLED,payload:{message:"cute whale born"}}},n.trackExtUpdated=function(){return{type:o.EVENT_EXT_UPDATED,payload:{message:"little whale grow"}}},n.trackExtLogin=function(t,n,r,e){return{type:o.EVENT_EXT_LOGIN,payload:{location:t,countrySelected:n,status:r,url:e}}},n.trackExtPageVisited=function(t){return{type:o.EVENT_EXT_PAGE_VISITED,payload:(0,i.default)({},t)}},n.uiTrackExtPageVisited=function(t,n,r){return{type:o.EVENT_EXT_PAGE_VISITED,url:n,storeId:t,referrerUrl:r}};n.trackExtNotifierPrompt=function(t){var n=t.propertyType,r=(0,e.default)(t,["propertyType"]);return{type:o.EVENT_EXT_NOTIFIER_PROMPT,payload:(0,i.default)({},r,{type:n})}};n.uiTrackExtNotifierPrompt=function(t,n,r){return{type:o.EVENT_EXT_NOTIFIER_PROMPT,propertyType:t,storeId:n,url:r}},n.trackExtNotifierActivatedPrompt=function(t){return{type:o.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT,payload:(0,i.default)({},t)}},n.uiTrackExtNotifierActivatedPrompt=function(t,n){return{type:o.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT,storeId:t,url:n}},n.trackExtSearch=function(t){return{type:o.EVENT_EXT_SEARCH,payload:(0,i.default)({},t)}},n.uiTrackExtSearch=function(t,n,r,e){return{type:o.EVENT_EXT_SEARCH,storeId:r,url:e,location:t,searchTerm:n}},n.trackExtClick=function(t){return{type:o.EVENT_EXT_CLICK,payload:(0,i.default)({},t)}},n.uiTrackExtClick=function(t,n,r,e,u,c,a,s,f){var p={type:o.EVENT_EXT_CLICK,componentName:t,objectName:n,objectPosition:r,objectType:e,objectId:u,objectDestinationUrl:c,storeId:a,url:s};return f?(0,i.default)({},p,{applyingId:f}):p},n.trackExtRedirect=function(t){return{type:o.EVENT_EXT_REDIRECT,payload:(0,i.default)({},t)}},n.uiTrackExtRedirect=function(t){return(0,i.default)({type:o.EVENT_EXT_REDIRECT},t)},n.trackExtSwitchLogin=function(t){return{type:o.EVENT_EXT_LOGIN,payload:(0,i.default)({},t)}},n.uiTrackExtSwitchLogin=function(t,n,r,e){return{type:o.EVENT_EXT_LOGIN,location:t,countrySelected:n,status:r,url:e}},n.trackExtMenuOpen=function(t){return{type:o.EVENT_EXT_MENU_OPEN,payload:(0,i.default)({},t)}},n.uiTrackExtMenuOpen=function(t,n){return{type:o.EVENT_EXT_MENU_OPEN,storeId:t,url:n}},n.trackExtSerpVisited=function(t){return{type:o.EVENT_EXT_SERP_VISITED,payload:(0,i.default)({},t)}},n.uiTrackExtSerpVisited=function(t,n,r,e){return{type:o.EVENT_EXT_SERP_VISITED,serpDomain:t,url:n,searchKeyword:r,injectionCount:e}},n.trackExtSerpClicked=function(t){return{type:o.EVENT_EXT_SERP_CLICKED,payload:(0,i.default)({},t)}},n.uiTrackExtSerpClicked=function(t,n,r,e){return{type:o.EVENT_EXT_SERP_CLICKED,serpDomain:t,linkUrl:n,storeId:r,clickTarget:e}};n.trackExtApplyCouponCode=function(t){var n=t.applyType,r=(0,e.default)(t,["applyType"]);return{type:o.EVENT_EXT_APPLY_COUPON_CODE,payload:(0,i.default)({},r,{type:n})}};n.uiTrackExtApplyCouponCode=function(t){return(0,i.default)({type:o.EVENT_EXT_APPLY_COUPON_CODE},t)},n.trackExtErrorOccured=function(t){return{type:o.EVENT_EXT_ERROR_OCCURED,payload:(0,i.default)({},t)}},n.uiTrackExtErrorOccured=function(t,n,r,e,i,u,c){return{type:o.EVENT_EXT_ERROR_OCCURED,applyingId:t,location:n,errorCode:r,errorMessage:e,targetPattern:i,url:u,storeId:c}},n.trackExtManualSuccessfulCode=function(t,n){return{type:o.EVENT_EXT_MANUAL_APPLY_COUPON_CODE,payload:{storeId:t,successfulCode:n}}},n.uiTrackExtManualSuccessfulCode=function(t,n){return{type:o.EVENT_EXT_MANUAL_APPLY_COUPON_CODE,storeId:t,successfulCode:n}}},71:function(t,n){function r(t,n){for(var r=0;r<t.length;++r)if(t[r]===n)return r;return-1}function e(t,n){var e=[],i=[];return null==n&&(n=function(t,n){return e[0]===n?"[Circular ~]":"[Circular ~."+i.slice(0,r(e,n)).join(".")+"]"}),function(o,u){if(e.length>0){var c=r(e,this);~c?e.splice(c+1):e.push(this),~c?i.splice(c,1/0,o):i.push(o),~r(e,u)&&(u=n.call(this,o,u))}else e.push(u);return null==t?u instanceof Error?function(t){var n={stack:t.stack,message:t.message,name:t.name};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(u):u:t.call(this,o,u)}}(t.exports=function(t,n,r,i){return JSON.stringify(t,e(n,i),r)}).getSerialize=e},73:function(t,n,r){var e=r(4).document;t.exports=e&&e.documentElement},74:function(t,n,r){t.exports={default:r(106),__esModule:!0}},75:function(t,n,r){"use strict";n.__esModule=!0;var e,i=r(74),o=(e=i)&&e.__esModule?e:{default:e};n.default=function(t,n,r){return n in t?(0,o.default)(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}},78:function(t,n,r){t.exports={default:r(79),__esModule:!0}},79:function(t,n,r){r(39),r(28),t.exports=r(89)},8:function(t,n,r){var e=r(9),i=r(58),o=r(47),u=Object.defineProperty;n.f=r(6)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},80:function(t,n,r){"use strict";var e=r(81),i=r(82),o=r(14),u=r(16);t.exports=r(54)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):i(0,"keys"==n?r:"values"==n?t[r]:[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},81:function(t,n){t.exports=function(){}},82:function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},825:function(t,n,r){"use strict";var e=s(r(38));r(183);var i=r(156),o=r(347),u=s(r(64)),c=s(r(826)),a=s(r(827));function s(t){return t&&t.__esModule?t:{default:t}}Promise.all([(0,o.getTabOfContentScript)(),(0,i.createUIStore)()]).then(function(t){var n=(0,e.default)(t,2),r=n[0],i=n[1],o=window.location.href;u.default.info(i,"sbEnhancer url: "+o),(0,a.default)(i,o,r),(0,c.default)(i,o,r)})},826:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=c(r(38)),i=r(255),o=r(0),u=c(r(64));function c(t){return t&&t.__esModule?t:{default:t}}n.default=function(t,n,r){var c=t.getState().settings;u.default.info(t,"cookie checker launch"),u.default.info(t,"settings.sbSitePattern: "+c.sbSitePattern),c&&new RegExp(c.sbSitePattern).test(n)&&(u.default.info(t,"it is shopback website"),function(t,n,r,c){var a=void 0,s=void 0,f=void 0,p=document.location.host,h=!0,l=!1,v=void 0;try{for(var d,_=t[Symbol.iterator]();!(h=(d=_.next()).done);h=!0){var E=d.value.split("="),m=(0,e.default)(E,2),T=m[0],b=m[1];T===o.ACCESS_TOKEN_NAME?a=b:"profileID"===T?f=b:"sbrefresh"===T&&(s=b,u.default.info(r,"userRefreshToken: "+s))}}catch(t){l=!0,v=t}finally{try{!h&&_.return&&_.return()}finally{if(l)throw v}}r.dispatch((0,i.uiSyncUserFromShopBack)({profileId:f,userToken:a,userRefreshToken:s,userTokenDomain:p,url:n,tabId:c&&c.id}))}(document.cookie.split("; "),n,t,r))}},827:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getLoggedInListener=n.onMessage=void 0;var e,i=r(19),o=r(43),u=r(101),c=r(69),a=r(119),s=r(177),f=r(0),p=r(64),h=(e=p)&&e.__esModule?e:{default:e};var l=n.onMessage=function t(n){return function(r){if(r.source===window&&r.data&&r.data.storeId){var e=new URL(r.data.url).searchParams.get("num_iids");h.default.info(n,"event.data.url: "+r.data.url),h.default.info(n,"productId: "+e),e&&n.dispatch((0,s.uiActivateTaoBaoProductFromSB)(e)),window.removeEventListener("message",t)}}},v=void 0,d=n.getLoggedInListener=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.store,r=void 0===n?null:n,e=t.medium,i=void 0===e?"":e,o=t.storeaffiliateId,u=void 0===o?"":o,a=t.url,s=void 0===a?"":a,p=t.shoppingtripId,h=void 0===p?"":p,l=t.referrer,d=void 0===l?"":l,_=t.storeId,E=void 0===_?-1:_;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r&&t.action===f.LOGIN_OK&&(r.dispatch((0,c.uiTrackExtRedirect)({medium:i,storeaffiliateId:u,url:s,shoppingtripId:h,referrer:d,storeId:E})),browser.runtime.onMessage.removeListener(v))}};n.default=function(t,n,r){var e=t.getState(),s=e.cc,f=new URL(n),p=void 0,_=void 0;if(h.default.info(t,"redirect page inspector launch"),(0,i.isProductRedirectPage)(s,n)){if(h.default.info(t,"it is shopback product redirect page"),!(_=parseInt(f.searchParams.get("storeId"),10)))return void h.default.error(t,"Can not get storeId from product redirect url");if((p=(0,o.findMerchant)(e,{id:_}))&&p.isTaobao){window.addEventListener("message",l(t));var E=document.createElement("script");E.innerHTML='window.postMessage(window.bootstrapData, "*");',document.getElementById("sbStoreaffiliateId").appendChild(E)}}else{if(!(0,i.isMerchantRedirectPage)(s,n))return;h.default.info(t,"it is shopback general redirect page");var m=parseInt(f.pathname.split("/").pop(),10);if(h.default.info(t,"affiliateId: "+m),!(p=(0,o.getMerchantByAffiliateId)(e,{affiliateId:m})))return void h.default.error(t,"Can not map affiliateId to merchantId");_=p.id}h.default.info(t,"merchantId: "+_+" detected at redirect page");var T=document.referrer,b=document.getElementById("sbStoreaffiliateId").getAttribute("be"),y=document.getElementById("sbShoppingtripUuid").getAttribute("be"),O=f.searchParams.get("utm_medium");t.dispatch((0,u.uiDetectSBRedirectPage)({merchantId:_,tabId:r&&r.id,referrer:T,storeaffiliateId:b,shoppingtripId:y})),(0,a.isLoggedIn)(e)?t.dispatch((0,c.uiTrackExtRedirect)({medium:O,storeaffiliateId:b,url:n,shoppingtripId:y,referrer:T,storeId:_})):(v=d({store:t,medium:O,storeaffiliateId:b,url:n,shoppingtripId:y,referrer:T,storeId:_}),browser.runtime.onMessage.addListener(v))}},83:function(t,n,r){"use strict";var e=r(48),i=r(22),o=r(40),u={};r(12)(u,r(3)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},84:function(t,n,r){var e=r(8),i=r(9),o=r(26);t.exports=r(6)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,a=0;c>a;)e.f(t,r=u[a++],n[r]);return t}},85:function(t,n,r){var e=r(16),i=r(66),o=r(86);t.exports=function(t){return function(n,r,u){var c,a=e(n),s=i(a.length),f=o(u,s);if(t&&r!=r){for(;s>f;)if((c=a[f++])!=c)return!0}else for(;s>f;f++)if((t||f in a)&&a[f]===r)return t||f||0;return!t&&-1}}},86:function(t,n,r){var e=r(34),i=Math.max,o=Math.min;t.exports=function(t,n){return(t=e(t))<0?i(t+n,0):o(t,n)}},87:function(t,n,r){var e=r(10),i=r(37),o=r(35)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},88:function(t,n,r){var e=r(34),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),a=e(r),s=c.length;return a<0||a>=s?t?"":void 0:(o=c.charCodeAt(a))<55296||o>56319||a+1===s||(u=c.charCodeAt(a+1))<56320||u>57343?t?c.charAt(a):o:t?c.slice(a,a+2):u-56320+(o-55296<<10)+65536}}},89:function(t,n,r){var e=r(51),i=r(3)("iterator"),o=r(14);t.exports=r(2).isIterable=function(t){var n=Object(t);return void 0!==n[i]||"@@iterator"in n||o.hasOwnProperty(e(n))}},9:function(t,n,r){var e=r(15);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},90:function(t,n,r){t.exports={default:r(91),__esModule:!0}},91:function(t,n,r){r(39),r(28),t.exports=r(92)},92:function(t,n,r){var e=r(9),i=r(67);t.exports=r(2).getIterator=function(t){var n=i(t);if("function"!=typeof n)throw TypeError(t+" is not iterable!");return e(n.call(t))}},93:function(t,n,r){t.exports={default:r(94),__esModule:!0}},94:function(t,n,r){r(95),t.exports=r(2).Object.assign},95:function(t,n,r){var e=r(13);e(e.S+e.F,"Object",{assign:r(96)})},96:function(t,n,r){"use strict";var e=r(6),i=r(26),o=r(49),u=r(36),c=r(37),a=r(53),s=Object.assign;t.exports=!s||r(18)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=s({},t)[r]||Object.keys(s({},n)).join("")!=e})?function(t,n){for(var r=c(t),s=arguments.length,f=1,p=o.f,h=u.f;s>f;)for(var l,v=a(arguments[f++]),d=p?i(v).concat(p(v)):i(v),_=d.length,E=0;_>E;)l=d[E++],e&&!h.call(v,l)||(r[l]=v[l]);return r}:s}},[825]);