webpackJsonp([2],[function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(52);t.FONT_FAMILY="Roboto, Helvetica, arial, sans-serif",t.ACTIVATE_TAOBAO_PRODUCT_FROM_SB="ACTIVATE_TAOBAO_PRODUCT_FROM_SB",t.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS",t.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR",t.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS="FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS",t.FETCH_TAOBAO_PRODUCT_DEEP_LINK_ERROR="FETCH_TAOBAO_PRODUCT_DEEP_LINK_ERROR",t.DETECT_STAND_DOWN_AFFILIATE_NETWORK="DETECT_STAND_DOWN_AFFILIATE_NETWORK",t.DETACH_STAND_DOWN_AFFILIATE_NETWORK="DETACH_STAND_DOWN_AFFILIATE_NETWORK",t.CLOSE_ACTIVATED_MERCHANT_NOTIFIER="CLOSE_ACTIVATED_MERCHANT_NOTIFIER",t.DELETE_EXPIRED_ACTIVATED_MERCHANT="DELETE_EXPIRED_ACTIVATED_MERCHANT",t.VISIT_ACTIVATED_MERCHANT_NOTIFIER="VISIT_ACTIVATED_MERCHANT_NOTIFIER",t.GET_EXTENSION_SETTINGS_SUCCEESS="GET_EXTENSION_SETTINGS_SUCCEESS",t.n="ps",t.START_ACTIVATE_TAOBAO_PRODUCT="START_ACTIVATE_TAOBAO_PRODUCT",t.STAND_DOWN_MERCHANT_NOTIFIER="STAND_DOWN_MERCHANT_NOTIFIER",t.FETCH_TOP_MERCHANTS_SUCCESS="FETCH_TOP_MERCHANTS_SUCCESS",t.CLEAR_DIRTY_LOGIN_FROM_MENU="CLEAR_DIRTY_LOGIN_FROM_MENU",t.STAND_UP_MERCHANT_NOTIFIER="STAND_UP_MERCHANT_NOTIFIER",t.FETCH_TAOBAO_PRODUCT_ERROR="FETCH_TAOBAO_PRODUCT_ERROR",t.CAPTURE_MERCHANT_PAGE_HTML="CAPTURE_MERCHANT_PAGE_HTML",t.OPEN_BROWESER_SETTING_PAGE="OPEN_BROWESER_SETTING_PAGE",t.DEACTIVATE_TAOBAO_PRODUCT="DEACTIVATE_TAOBAO_PRODUCT",t.FETCH_TOP_MERCHANTS_ERROR="FETCH_TOP_MERCHANTS_ERROR",t.REFETCH_MERCHANTS_SUCCESS="REFETCH_MERCHANTS_SUCCESS",t.t="ll",t.r="pwd",t.DETECCT_PERMISSION_CHANGE="DETECCT_PERMISSION_CHANGE",t.CLOSE_PERMISSION_NOTIFIER="CLOSE_PERMISSION_NOTIFIER",t.RESET_PERMISSION_NOTIFIER="RESET_PERMISSION_NOTIFIER",t.CLEAN_INVALID_PERMISSION="CLEAN_INVALID_PERMISSION",t.CLOSE_MERCHANT_NOTIFIER="CLOSE_MERCHANT_NOTIFIER",t.FETCH_USER_INFO_SUCCESS="FETCH_USER_INFO_SUCCESS",t.FETCH_MERCHANTS_SUCCESS="FETCH_MERCHANTS_SUCCESS",t.SYNC_USER_FROM_SHOPBACK="SYNC_USER_FROM_SHOPBACK",t.DETECT_SB_REDIRECT_PAGE="DETECT_SB_REDIRECT_PAGE",t.OPEN_TAOBAO_SEARCH_BAR="OPEN_TAOBAO_SEARCH_BAR",t.e="cp",t.FETCH_MERCHANTS_ERROR="FETCH_MERCHANTS_ERROR",t.FETCH_USER_INFO_ERROR="FETCH_USER_INFO_ERROR",t.DIRTY_LOGIN_FROM_MENU="DIRTY_LOGIN_FROM_MENU",t.FETCH_SETTINGS_ERROR="FETCH_SETTINGS_ERROR",t.FETCH_TOP_MERCHANTS="FETCH_TOP_MERCHANTS",t.FETCH_DEALS_SUCCESS="FETCH_DEALS_SUCCESS",t.DEEP_LINK_REDIRECT="DEEP_LINK_REDIRECT",t.ADD_DIRTY_REDIRECT="ADD_DIRTY_REDIRECT",t.FETCH_DEALS_ERROR="FETCH_DEALS_ERROR",t.CLEAN_ACTIVATION="CLEAN_ACTIVATION",t.FETCH_CC_SUCCESS="FETCH_CC_SUCCESS",t.DROP_COOKIE_DONE="DROP_COOKIE_DONE",t.SET_COOKIE_DONE="SET_COOKIE_DONE",t.SET_COOKIE_FAIL="SET_COOKIE_FAIL",t.i="netstat",t.DISABLE_TRACKING="DISABLE_TRACKING",t.ENABLE_TRACKING="ENABLE_TRACKING",t.TOGGLE_TRACKING="TOGGLE_TRACKING",t.FETCH_USER_INFO="FETCH_USER_INFO",t.FETCH_CC_ERROR="FETCH_CC_ERROR",t.START_ACTIVATE="START_ACTIVATE",t.GEN_SB_EXT_ID="GEN_SB_EXT_ID",t.OPEN_POPUP_UI="OPEN_POPUP_UI",t.LOGIN_NOT_OK="LOGIN_NOT_OK",t.FETCH_DEALS="FETCH_DEALS",t.SWITCH_USER="SWITCH_USER",t.DE_ACTIVATE="DE_ACTIVATE",t.o="mv",t.API_ERROR="API_ERROR",t.LOGIN_OK="LOGIN_OK",t.LOGOUT="LOGOUT",t.OPEN_NEW_TAB="OPEN_NEW_TAB",t.CLOSE_TAB="CLOSE_TAB",t.REFRESH_ACCESS_TOKEN_SUCCESS="REFRESH_ACCESS_TOKEN_SUCCESS",t.TOGGLE_LOGGER="TOGGLE_LOGGER",t.EVENT_EXT_CLICK="EVENT_EXT_CLICK",t.EVENT_EXT_LOGIN="EVENT_EXT_LOGIN",t.EVENT_EXT_SEARCH="EVENT_EXT_SEARCH",t.EVENT_EXT_UPDATED="EVENT_EXT_UPDATED",t.EVENT_EXT_REDIRECT="EVENT_EXT_REDIRECT",t.EVENT_EXT_MENU_OPEN="EVENT_EXT_MENU_OPEN",t.EVENT_EXT_INSTALLED="EVENT_EXT_INSTALLED",t.EVENT_EXT_PAGE_VISITED="EVENT_EXT_PAGE_VISITED",t.EVENT_EXT_SERP_VISITED="EVENT_EXT_SERP_VISITED",t.EVENT_EXT_SERP_CLICKED="EVENT_EXT_SERP_CLICKED",t.EVENT_EXT_NOTIFIER_PROMPT="EVENT_EXT_NOTIFIER_PROMPT",t.EVENT_EXT_APPLY_COUPON_CODE="EVENT_EXT_APPLY_COUPON_CODE",t.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT="EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT",t.EVENT_EXT_ERROR_OCCURED="EVENT_EXT_ERROR_OCCURED",t.EVENT_EXT_MANUAL_APPLY_COUPON_CODE="EVENT_EXT_MANUAL_APPLY_COUPON_CODE",t.DEFAULT_COUNTRY="COM",t.ACTIVATE_FROM_POPUP="ACTIVATE_FROM_POPUP",t.MENU_STORE="Menu Store",t.MENU_ACCOUNT_LOGIN="Menu_Account_Login",t.MENU_ACCOUNT_SWITCH_POPUP="Menu_Account_Country_Switch_Popup",t.POPUP_CUSTOM_LOGOUT_EVENT="LOGOUT",t.POPUP_CUSTOM_LOGIN_EVENT="LOGIN_DIRECTLY",t.POPUP_CUSTOM_LOGIN="NON_LOGIN_USER_TO_LOGIN",t.POPUP_CUSTOM_SEARCH_TAOBAO="CLICK_TO_SEARCH",t.POPUP_CUSTOM_ACTIVATE_EVENT="ACTIVATE_FROM_MENU",t.POPUP_CUSTOM_OPEN_COUNTRY_SELECTOR="OPEN_COUNTRY_SELECTOR",t.POPUP_CUSTOM_CHOOSE_COUNTRY="POPUP_CUSTOM_CHOOSE_COUNTRY",t.POPUP_CUSTOM_CHANGE_TAB_EVENT="TAB_CHANGE",t.POPUP_CUSTOM_GO_WITHDRAW="GO_TO_WITHDRAW",t.POPUP_CUSTOM_GO_OVERVIEW="GO_TO_OVERVIEW",t.POPUP_CUSTOM_GO_REFER="GO_TO_REFER",t.POPUP_CUSTOM_GO_FAQ="GO_TO_FAQ",t.POPUP_CUSTOM_GO_RATE="GO_TO_RATE",t.POPUP_CUSTOM_CANCEL_SWITCH="CANCEL_SWITCH",t.POPUP_CUSTOM_MENU_CAMPAIGN_PROMPT="POPUP_CUSTOM_MENU_CAMPAIGN_PROMPT",t.POPUP_CUSTOM_MENU_CAMPAIGN_CLOSE="POPUP_CUSTOM_MENU_CAMPAIGN_CLOSE",t.POPUP_CUSTOM_MENU_CAMPAIGN_CLICK="POPUP_CUSTOM_MENU_CAMPAIGN_CLICK",t.TIME_TO_CLOSE_ACTIVATED_NOTIFIER=1e4,t.ACTIVATED_EXPIRED_MS=e.ACTIVATED_EXPIRED_MS,t.ACTIVATED_EXPIRED_MS_FOR_TAOBAO=e.ACTIVATED_EXPIRED_MS_FOR_TAOBAO,t.REFETCH_MERCHANT_INTERVAL_MS=3e5,t.REFETCH_SETTING_INTERVAL_MS=18e5,t.STAND_DOWN_MERCHANT_NOTIFIER_TIMER_MS=864e5,t.PERMISSION_NOTIFIER_TTL=e.PERMISSION_NOTIFIER_TTL,t.CASHBACK_STATUS_UNAVAILABLE="unavailable",t.CASHBACK_STATUS_AVAILABLE="available",t.CASHBACK_STATUS_ACTIVATED="activated",t.CASHBACK_STATUS_FETCHING="fetching",t.CASHBACK_STATUS_TAOBAO_API_DOWN="down",t.ACTIVATE_STATE_NOT_ACTIVATED="ACTIVATE_STATE_NOT_ACTIVATED",t.ACTIVATE_STATE_ACTIVATING="ACTIVATE_STATE_ACTIVATING",t.ACTIVATE_STATE_ACTIVATED="ACTIVATE_STATE_ACTIVATED",t.DEFAULT_DISABLE_REASON="2",t.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED="TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED",t.TAOBAO_TOGGLE_SEARCH_BOX="TAOBAO_TOGGLE_SEARCH_BOX",t.TAOBAO_OPEN_NOTIFIER="TAOBAO_OPEN_NOTIFIER",t.TAOBAO_CLOSE_NOTIFIER="TAOBAO_CLOSE_NOTIFIER",t.TAOBAO_OPEN_CONFIRMATION_NOTIFIER="TAOBAO_OPEN_CONFIRMATION_NOTIFIER",t.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER="TAOBAO_CLOSE_CONFIRMATION_NOTIFIER",t.TAOBAO_OPEN_API_DOWN_NOTIFIER="TAOBAO_OPEN_API_DOWN_NOTIFIER",t.TAOBAO_CLOSE_API_DOWN_NOTIFIER="TAOBAO_CLOSE_API_DOWN_NOTIFIER",t.TAOBAO_MATERIAL_LIB_TYPE_HAS_CASHBACK=["1","1,2"],t.SHOPBACK_TAOBAO_CART="shopback-taobao-cart",t.GET_TAB_OF_CONTENT_SCRIPT="GET_TAB_OF_CONTENT_SCRIPT",t.SET_ICON_BADGE_TEXT="SET_ICON_BADGE_TEXT",t.COUNTRIES=["au","id","my","ph","sg","th","tw"],t.u=0,t.c=1,t.COUNTRY_LOCALES={au:"en-AU",id:"id",my:"ms-MY",ph:"en",sg:"en-SG",th:"th",tw:"en"},t.COUNTRY_CURRENCY_CODES={au:"AUD",id:"IDR",my:"MYR",ph:"PHP",sg:"SGD",th:"THB",tw:"NTD"},t.TOP_MERCHANT_TAB="topMerchants",t.COUPONS_TAB="coupons",t.MY_ACCOUNT_TAB="myAccount",t.UTM_BE_NOTIFIER_CASHBACK="be_cashback_notifier",t.s="be_disable_notifier",t.UTM_BE_CONFIRM_NOTIFIER="be_confirmation_notifier",t.UTM_BE_MENU_CASHBACK="be_menu_getcashback",t.UTM_BE_MENU_LOGIN_CASHBACK="be_menu_logintogetcashback",t.UTM_BE_MENU_STORE_NONLOGIN="be_menu_store_nonlogin",t.UTM_BE_MENU_STORE="be_menu_store",t.UTM_BE_LOGIN_NOTIFIER="be_login_notifier",t.UTM_BE_TAOBAO_LOGIN_CASHBACK_NOTIFIER="be_taobao_login_cashback_notifier",t.UTM_BE_TAOBAO_SEARCH="be_taobao_searchbar",t.UTM_BE_TAOBAO_CASHBACK_NOTIFIER="be_taobao_cashback_notifier",t.UTM_BE_TAOBAO_LOGIN_SEARCHBAR="be_taobao_login_searchbar",t.HEIGHT_OF_NORMAL_MENU=468,t.HEIGHT_OF_MERCHANT_MENU=537,t.HEIGHT_OF_TAOBAO_MENU=603,t.ACTIVATED_NOTIFIER_NOT_YET_VISITED=0,t.ACTIVATED_NOTIFIER_VISITED=1,t.ACTIVATED_NOTIFIER_CLOSED=2,t.SENTRY_ERROR_LOGGING="SENTRY_ERROR_LOGGING",t.SERP_LIST=[{domain:"yahoo",rx:"search\\.yahoo\\.com\\/",pattern:"h3.title > a",href:"=(http[^/]*)",searchInputPattern:"div#sbq-wrap > #yschsp"},{domain:"bing",rx:"\\.bing\\.com\\/search.*[&?]q=([^&]*)",pattern:'#b_results>.b_algo, #b_results>li, #b_results h2 a, div[class="sb_tlst"] * a',searchInputPattern:"#sb_form_q"},{domain:"google",rx:"^https?:\\/\\/(?:www\\.|encrypted\\.)?google\\.[\\w\\.]{2,6}.*",pattern:"div.rc > .r > a",searchInputPattern:".gLFyf"}],t.OTHER_SERP_PATTERN_LIST=[".ebates-serp","#gym_serp"],t.OPEN_BROWSER_WINDOW="OPEN_BROWSER_WINDOW",t.COUNTRY_BOOKING_IDENTIFIER={au:{aid:"1465791"},id:{aid:"1691096"},my:{aid:"1691091"},ph:{aid:"1244848"},sg:{aid:"1691090"},th:{aid:"1275028"},tw:{aid:"1244849"},com:{aid:"1691090"}},t.ICON_BADGE_BACKGROUND_COLOR="#fbb215",t.COUPON_NOTIFIER_DIV_ID="shopback-coupon-notifier",t.COUPON_APPLIER_DIV_ID="shopback-coupon-applier",t.CASHBACK_NOTIFIER_DIV_ID="shopback-cashback-notifier",t.POPUP_SEARCH_MERCHANT_INPUT_BOX_ID="shopback-popup-search-input-box",t.TAOBAO_NAVIGATOR_DIV_ID="shopback-taobao-navigator",t.IS_FIREFOX=-1===navigator.userAgent.indexOf("Chrome"),t.ACCESS_TOKEN_NAME="sbet",t.SECONDS_OF_ONE_YEAR=31536e3,t.HEADERS={X_SHOPBACK_LAST_CC:"X-SHOPBACK-LAST-CC",X_SHOPBACK_IRONGATE_ENABLED:"X-SHOPBACK-IRONGATE-ENABLED",X_SHOPBACK_DOMAIN:"X-SHOPBACK-DOMAIN",X_SHOPBACK_CLIENT_USER_AGENT:"X-SHOPBACK-CLIENT-USER-AGENT",X_SHOPBACK_ACCESS_TOKEN:"X-SHOPBACK-ACCESS-TOKEN",X_SHOPBACK_REFRESH_TOKEN:"X-SHOPBACK-REFRESH-TOKEN",CONTENT_TYPE:"Content-Type",ACCEPT:"Accept"},t.DEFAULT_EVENT_REASON="For more information, please visit",t.DEFAULT_USER_DATA_POLICY_URL="https://support.shopback.sg/hc/en-us/articles/360039652893",t.EVENT_REASONS_MAP={EVENT_EXT_INSTALLED:"To report ShopBack installs for product analytics. For more information, please visit",EVENT_EXT_PAGE_VISITED:"To look up domain to determine if it is a site ShopBack supports and determine appropriate ShopBack behavior. For more information, please visit",EVENT_EXT_NOTIFIER_PROMPT:"To report first interaction with ShopBack for product analytics. For more information, please visit",EVENT_EXT_REDIRECT:"To report affiliate tagging for product analytics. For more information, please visit",EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT:"To report affiliate activation to verify ShopBack is performing as expected. For more information, please visit",EVENT_EXT_MENU_OPEN:"To report ShopBack manually opened for product analytics. For more information, please visit",EVENT_EXT_CLICK:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_SEARCH:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_ERROR_OCCURED:"To report when ShopBack is not performing as expected. For more information, please visit",EVENT_EXT_LOGIN:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_UPDATED:"To report version update for product analytics. For more information, please visit",EVENT_EXT_APPLY_COUPON_CODE:"To report coupon application status for product analytics. For more information, please visit",EVENT_EXT_MANUAL_APPLY_COUPON_CODE:"To report coupon application status for product analytics. For more information, please visit",EVENT_EXT_SERP_VISITED:"To report interactions with ShopBack for product analytics. For more information, please visit",EVENT_EXT_SERP_CLICKED:"To report interactions with ShopBack for product analytics. For more information, please visit"},t.USER_DATA_POLICY_PAGE_URLS={au:"https://support.shopback.com.au/hc/en-us/articles/360039114834",tw:"https://support.shopback.com.tw/hc/zh-tw/articles/360039187814",id:"https://support.shopback.co.id/hc/id/articles/360039941853",my:"https://support.shopback.my/hc/en-us/articles/360026274913",sg:"https://support.shopback.sg/hc/en-us/articles/360039652893",ph:"https://support.shopback.ph/hc/en-us/articles/115010370828",th:"https://support.shopback.co.th/hc/th/articles/360037977973"}},,function(n,t){var r=n.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},function(n,t,r){var e=r(41)("wks"),i=r(27),o=r(4).Symbol,u="function"==typeof o;(n.exports=function(n){return e[n]||(e[n]=u&&o[n]||(u?o:i)("Symbol."+n))}).store=e},function(n,t){var r=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(n,t,r){"use strict";t.__esModule=!0;var e,i=r(93),o=(e=i)&&e.__esModule?e:{default:e};t.default=o.default||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n}},function(n,t,r){n.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},,function(n,t,r){var e=r(9),i=r(58),o=r(47),u=Object.defineProperty;t.f=r(6)?Object.defineProperty:function(n,t,r){if(e(n),t=o(t,!0),e(r),i)try{return u(n,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(n[t]=r.value),n}},function(n,t,r){var e=r(15);n.exports=function(n){if(!e(n))throw TypeError(n+" is not an object!");return n}},function(n,t){var r={}.hasOwnProperty;n.exports=function(n,t){return r.call(n,t)}},,function(n,t,r){var e=r(8),i=r(22);n.exports=r(6)?function(n,t,r){return e.f(n,t,i(1,r))}:function(n,t,r){return n[t]=r,n}},function(n,t,r){var e=r(4),i=r(2),o=r(46),u=r(12),a=r(10),c=function(n,t,r){var f,s,l,v=n&c.F,d=n&c.G,p=n&c.S,h=n&c.P,_=n&c.B,b=n&c.W,E=d?i:i[t]||(i[t]={}),O=E.prototype,y=d?e:p?e[t]:(e[t]||{}).prototype;for(f in d&&(r=t),r)(s=!v&&y&&void 0!==y[f])&&a(E,f)||(l=s?y[f]:r[f],E[f]=d&&"function"!=typeof y[f]?r[f]:_&&s?o(l,e):b&&y[f]==l?function(n){var t=function(t,r,e){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(t);case 2:return new n(t,r)}return new n(t,r,e)}return n.apply(this,arguments)};return t.prototype=n.prototype,t}(l):h&&"function"==typeof l?o(Function.call,l):l,h&&((E.virtual||(E.virtual={}))[f]=l,n&c.R&&O&&!O[f]&&u(O,f,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,n.exports=c},function(n,t){n.exports={}},function(n,t){n.exports=function(n){return"object"==typeof n?null!==n:"function"==typeof n}},function(n,t,r){var e=r(53),i=r(33);n.exports=function(n){return e(i(n))}},,function(n,t){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isYahooRedirectUrl=t.patchCouponStatsAPI=t.getTrendingCouponsAPI=t.getCouponReportIssuePage=t.getCouponCodesNotWorkPage=t.isSBHomePage=t.getHtmlParseServiceUrl=t.getCouponsByMerchantAPI=t.getDealsAPI=t.getEventTrackingAPI=t.getSettingsAPI=t.getMerchantsAPI=t.getRefreshTokenAPI=t.getAccountAPI=t.getTaobaoGuidePage=t.getLinkTaoBaoToActivatePage=t.getLoginToActivatePage=t.getFAQPage=t.getReferPage=t.getOverviewPage=t.getWithdrawPage=t.getLogoutPage=t.getLoginPage=t.getHomePage=t.getTaobaoActivatePage=t.getActivatePage=t.getUrlDomain=t.getHelpCenterFromCC=t.getExtensionStoreFromCC=t.getDomainFromCC=t.getCCFromDomain=t.listWebsiteLoginAPIPatterns=t.getHost=t.isSBPage=t.isLoginPage=t.isProductRedirectPage=t.isMerchantRedirectPage=t.isRedirectPage=void 0;var e=r(0),i=r(52);t.default=i;t.isRedirectPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1];return t.includes(i.SB_WEBSITE_XX[n]+"/redirect/alink")||t.includes(i.SB_WEBSITE_XX[n]+"/product/redirect/plink")},t.isMerchantRedirectPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(i.SB_WEBSITE_XX[n]+"/redirect/alink")},t.isProductRedirectPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1];return t.includes(i.SB_WEBSITE_XX[n]+"/product/redirect/plink")||new URL(t).searchParams.get("storeId")},t.isLoginPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(i.SB_WEBSITE_XX[n]+"/login")},t.isSBPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return arguments[1].includes(""+i.SB_WEBSITE_XX[n])};var o=t.getHost=function(n){return"https://"+((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{api:!0}).api?i.API_HOST_XX:i.SB_WEBSITE_XX)[function(n){return i.API_HOST_XX[n]?n:e.DEFAULT_COUNTRY}(n)]},u=(t.listWebsiteLoginAPIPatterns=function(){return Object.keys(i.SB_WEBSITE_XX).reduce(function(n,t){return n.push("*://"+i.SB_WEBSITE_XX[t]+"/account/login","*://"+i.SB_WEBSITE_XX[t]+"/account/authenticateWithFacebook")&&n},[])},t.getCCFromDomain=function(n){var t=n.split(".");return t[t.length-1].toUpperCase()},t.getDomainFromCC=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_WEBSITE_XX[n]},t.getExtensionStoreFromCC=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return e.IS_FIREFOX?i.EXTENSION_STORES.FIREFOX:i.EXTENSION_STORES[n]},t.getHelpCenterFromCC=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.HELP_CENTER[n]},t.getUrlDomain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/(?:https?:\/\/)?(?:\w+:\/)?[^:?#/\s]*?([^.\s]+\.(?:[a-z]{2,}|co\.uk|org\.uk|ac\.uk|org\.au|com\.au))(?:[:?#/]|$)/gi.exec(n)},t.getActivatePage=function(n,t){var r=new URL(n);return r.searchParams.has("utm_medium")&&"be"!==r.searchParams.get("utm_medium")||r.searchParams.set("utm_medium",t),r.href}),a=t.getTaobaoActivatePage=function(n,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.UTM_BE_TAOBAO_SEARCH,o=encodeURIComponent(r),u=new URL(n);return u.searchParams.set("storeId",t),u.searchParams.set("search",o),u.searchParams.set("utm_medium",i),u.toString()},c=t.getHomePage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return""+o(n,{api:!1})};t.getLoginPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/login"},t.getLogoutPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/logout"},t.getWithdrawPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/payment"},t.getOverviewPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/cashback"},t.getReferPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/referral/invite"},t.getFAQPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/cashback-button/how-it-works"},t.getLoginToActivatePage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1],r=arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(t&&r){var c=new URL(u(t,r)),f=""+c.pathname+c.search;i&&a&&(f+="&from_taobao");var s=encodeURIComponent(f);return o(n,{api:!1})+"/login?redirect="+s}return o(n,{api:!1})+"/login"},t.getLinkTaoBaoToActivatePage=function(n,t,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=e&&i?a(t,e,i,r):u(t,r),f=new URL(c),s=""+f.pathname+f.search,l=encodeURIComponent(s);return o(n,{api:!1})+"/taobao/link?redirect="+l},t.getTaobaoGuidePage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n,{api:!1})+"/taobao#guide"},t.getAccountAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n)+"/api/v2/accounts/me"},t.getRefreshTokenAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n)+"/members/me/refresh-jwt-token"},t.getMerchantsAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?new URL(o(n)+"/api/v2/stores"):new URL(o(n)+"/api/stores");return t.confirmation&&r.push("confirmation-urls"),t.disableReason&&r.push("cashback-disable-reasons"),t.metaInfo?r.push("store-meta-info"):t.top&&i.searchParams.set("top","true"),r.length>0&&i.searchParams.set("metadata",r.join(",")),i.toString()},t.getSettingsAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n)+"/api/settings"},t.getEventTrackingAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1];return t===e.EVENT_EXT_INSTALLED?o(n)+"/api/events/ext-installed":t===e.EVENT_EXT_PAGE_VISITED?o(n)+"/api/events/ext-page-visited":t===e.EVENT_EXT_NOTIFIER_PROMPT?o(n)+"/api/events/ext-notifier-prompt":t===e.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT?o(n)+"/api/events/ext-notifier-activated":t===e.EVENT_EXT_SEARCH?o(n)+"/api/events/ext-search":t===e.EVENT_EXT_CLICK?o(n)+"/api/events/ext-click":t===e.EVENT_EXT_REDIRECT?o(n)+"/api/events/ext-redirect":t===e.EVENT_EXT_LOGIN?o(n)+"/api/events/ext-login":t===e.EVENT_EXT_MENU_OPEN?o(n)+"/api/events/ext-menu-open":t===e.EVENT_EXT_UPDATED?o(n)+"/api/events/ext-updated":t===e.EVENT_EXT_SERP_VISITED?o(n)+"/api/events/ext-serp-view":t===e.EVENT_EXT_SERP_CLICKED?o(n)+"/api/events/ext-serp-click":t===e.EVENT_EXT_APPLY_COUPON_CODE?o(n)+"/api/events/ext-apply-coupon-code":t===e.EVENT_EXT_ERROR_OCCURED?o(n)+"/api/events/ext-error":t===e.EVENT_EXT_MANUAL_APPLY_COUPON_CODE?o(n)+"/api/events/ext-success-code":""},t.getDealsAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1];return isNaN(parseInt(t,10))?o(n)+"/deals?top=true":o(n)+"/deals?store_id="+t},t.getCouponsByMerchantAPI=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.DEFAULT_COUNTRY;return o(t)+"/api/v2/coupons/merchant/"+n},t.getHtmlParseServiceUrl=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n)+"/api/parsers/html"},t.isSBHomePage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1],r=new URL(t),i=new URL(c(n));return r.href===i.href},t.getCouponCodesNotWorkPage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_HELP_CENTER_COUPON_CODES_NOT_WORK_XX[n]},t.getCouponReportIssuePage=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return i.SB_COUPONS_REPORT_ISSUE_XX[n]},t.getTrendingCouponsAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY;return o(n)+"/api/v1/coupons/trending-codes"},t.patchCouponStatsAPI=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.DEFAULT_COUNTRY,t=arguments[1];return o(n)+"/api/v1/coupons/"+t},t.isYahooRedirectUrl=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!n&&/r\.search\.yahoo\.com/.test(n)}},,function(n,t,r){"use strict";t.__esModule=!0,t.default=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}},function(n,t){n.exports=function(n,t){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:t}}},function(n,t){n.exports=!0},,,function(n,t,r){var e=r(60),i=r(42);n.exports=Object.keys||function(n){return e(n,i)}},function(n,t){var r=0,e=Math.random();n.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++r+e).toString(36))}},function(n,t,r){"use strict";var e=r(88)(!0);r(54)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(n=e(t,r),this._i+=n.length,{value:n,done:!1})})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActivatedMerchantInfo=t.l=t.v=t.d=t.isActivateFromPartnership=t.isActivated=t.getActivatedTimeByMerchant=t.findByExt=void 0;var e=r(17),i=function(n){return n.activation.byExt},o=function(n,t){return t.merchant},u=t.findByExt=function(n,t){return n.activation.byExt[t.merchantId]},a=(t.getActivatedTimeByMerchant=(0,e.createSelector)([o,i],function(n,t){return t[n.id]?t[n.id].activatedAt:null}),t.isActivated=(0,e.createSelector)([o,i],function(n,t){return!!n&&!(!t[n.id]||!t[n.id].activated)})),c=(t.isActivateFromPartnership=(0,e.createSelector)([o,i],function(n,t){return!!n&&!(!t[n.id]||void 0===t[n.id].partnershipId)}),t.d=(0,e.createSelector)([o,i],function(n,t){if(!n)return!1;var r=t[n.id];return!!(r&&r.disabled&&r.focusing)})),f=t.v=(0,e.createSelector)([o,i],function(n,t){return!!n&&!(!t[n.id]||!t[n.id].disabled)});t.l=(0,e.createSelector)([f,c],function(n,t){return n&&!t}),t.getActivatedMerchantInfo=(0,e.createSelector)([a,o,function(n){return n}],function(n,t,r){if(n)return u(r,{merchantId:t.id})})},function(n,t,r){var e=r(169),i="object"==typeof self&&self&&self.Object===Object&&self,o=e||i||Function("return this")();n.exports=o},function(n,t,r){"use strict";t.__esModule=!0;var e,i=r(74),o=(e=i)&&e.__esModule?e:{default:e};t.default=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),(0,o.default)(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}()},function(n,t){var r={}.toString;n.exports=function(n){return r.call(n).slice(8,-1)}},function(n,t){n.exports=function(n){if(void 0==n)throw TypeError("Can't call method on  "+n);return n}},function(n,t){var r=Math.ceil,e=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?e:r)(n)}},function(n,t,r){var e=r(41)("keys"),i=r(27);n.exports=function(n){return e[n]||(e[n]=i(n))}},function(n,t){t.f={}.propertyIsEnumerable},function(n,t,r){var e=r(33);n.exports=function(n){return Object(e(n))}},function(n,t,r){"use strict";t.__esModule=!0;var e=o(r(78)),i=o(r(90));function o(n){return n&&n.__esModule?n:{default:n}}t.default=function(){return function(n,t){if(Array.isArray(n))return n;if((0,e.default)(Object(n)))return function(n,t){var r=[],e=!0,o=!1,u=void 0;try{for(var a,c=(0,i.default)(n);!(e=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);e=!0);}catch(n){o=!0,u=n}finally{try{!e&&c.return&&c.return()}finally{if(o)throw u}}return r}(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(n,t,r){r(80);for(var e=r(4),i=r(12),o=r(14),u=r(3)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var f=a[c],s=e[f],l=s&&s.prototype;l&&!l[u]&&i(l,u,f),o[f]=o.Array}},function(n,t,r){var e=r(8).f,i=r(10),o=r(3)("toStringTag");n.exports=function(n,t,r){n&&!i(n=r?n:n.prototype,o)&&e(n,o,{configurable:!0,value:t})}},function(n,t,r){var e=r(2),i=r(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(n.exports=function(n,t){return o[n]||(o[n]=void 0!==t?t:{})})("versions",[]).push({version:e.version,mode:r(23)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(n,t){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMerchantByAffiliateId=t.shouldFetchMerchants=t.getMerchantMetaHash=t.getMerchantOfSerpMap=t.merchantHasCashback=t.getStandDownNotifierTimerId=t.isReloadNecessaryMerchant=t.transformWithPartnership=t.mapReason=t.p=t.findPartnershipMerchant=t.findMerchant=t.matchConfirmPage=t.isInConfirmPage=t.matchMerchant=t.findTaobaoRelatedMerchant=void 0;var e=f(r(5)),i=f(r(38)),o=r(17),u=r(0),a=r(29),c=r(19);function f(n){return n&&n.__esModule?n:{default:n}}var s=function(n){return n.merchants.all},l=function(n,t){return t.url},v=function(n,t){return t.id};t.findTaobaoRelatedMerchant=(0,o.createSelector)([s],function(n){return n.filter(function(n){return n.isTaobao})});var d=t.matchMerchant=(0,o.createSelector)([s,l,function(n,t){return(0,c.getUrlDomain)(t.url)}],function(n,t,r){if(r){var e=(0,i.default)(r,2),o=e[0],u=e[1],a=n.filter(function(n){return n.rx=n.url_pattern?new RegExp(n.url_pattern):null,(o.indexOf(n.url_domain)>=0||u.indexOf(n.url_domain)>=0)&&n.rx&&n.rx.test(t)});if(a.length)return c=a,f=(0,i.default)(c,1)[0],c.forEach(function(n){n.rx>f.rx&&(f=n)}),f}var c,f;return null}),p=t.isInConfirmPage=(0,o.createSelector)([function(n,t){return t.merchant},l],function(n,t){return!!n&&(n.metadata.confirmation_urls.length>0&&n.metadata.confirmation_urls.some(function(n){return new RegExp(n).test(t)}))}),h=(t.matchConfirmPage=(0,o.createSelector)([s,l],function(n,t){return n.find(function(n){return p({},{merchant:n,url:t})})}),t.findMerchant=(0,o.createSelector)([s,v],function(n,t){return n.find(function(n){return n.id===t})})),_=(t.findPartnershipMerchant=(0,o.createSelector)([s,v],function(n,t){return n.find(function(n){var r=Object.keys(n.partnership_stores);return r.length>0&&r.indexOf(""+t)>-1})}),t.p=(0,o.createSelector)([function(n){return n},function(n,t){return t.referrer},function(n,t){return t.merchant}],function(n,t,r){var e=d(n,{url:t});return r.metadata.check_referrer&&!(0,c.isSBPage)(n.cc,t)&&!(e&&e.id===r.id)}),t.mapReason=(0,o.createSelector)([function(n){return n.settings.cashbackDisableReasons},function(n,t){return t.merchant}],function(n,t){return t?n[t.metadata.cashback_disable_reasons]||n[u.DEFAULT_DISABLE_REASON]:null}),t.transformWithPartnership=(0,o.createSelector)([function(n){return n},function(n,t){return t.merchant},a.isActivateFromPartnership,function(n,t){return t.activated},function(n,t){return t.disabled}],function(n,t,r,i,o){if(!t||!r)return t;if(i||o){var u=(0,a.findByExt)(n,{merchantId:t.id}),c=(0,e.default)({},t),f=t.partnership_stores[u.partnershipId];return c.activation_url=f.activation_url,c.cashback_amount=f.cashback_amount,c.cashbackHeader=f.cashbackHeader,c.reActivateX=f.reActivateX,c}return t}),t.isReloadNecessaryMerchant=(0,o.createSelector)([function(n,t){return t.merchant}],function(n){return n&&n.metadata.reload_tabs}),t.getStandDownNotifierTimerId=(0,o.createSelector)([h],function(n){return n&&n.standDownTimerId}),t.merchantHasCashback=(0,o.createSelector)([h],function(n){return!(!n||!n.cashback)&&!!parseFloat(n.cashback.amount)}));t.getMerchantOfSerpMap=(0,o.createSelector)([function(n,t){return t.links.filter(function(n){return!n.getAttribute("shopback-serp")})},function(n){return n}],function(n,t){var r=[];return n.forEach(function(n){var e=n.getAttribute("href");if((0,c.isYahooRedirectUrl)(e)){var i=new URL(e).pathname.split("/").find(function(n){return n.startsWith("RU=")});i&&(e=decodeURIComponent(i.split("=").pop()))}var o=d(t,{url:e});o&&!1!==o.isSerpEnabled&&_(t,{id:o.id})&&r.push({link:n,merchant:o})}),r}),t.getMerchantMetaHash=(0,o.createSelector)([s],function(n){var t={};return n.forEach(function(n){t[n.id]={logoUrl:n.logo_url,activationUrl:n.activation_url,hasCashBack:!!n.cashback&&!!parseFloat(n.cashback.amount)}}),t}),t.shouldFetchMerchants=(0,o.createSelector)([function(n){return n.merchants},function(n,t){return t.now}],function(n,t){if(!n)return!0;var r=n.fetchedAt;return"number"!=typeof r||t-r>u.REFETCH_MERCHANT_INTERVAL_MS}),t.getMerchantByAffiliateId=(0,o.createSelector)([s,function(n,t){return t.affiliateId}],function(n,t){return n.find(function(n){return n.affiliated_id===t})})},function(n,t){var r=Array.isArray;n.exports=r},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uiDirtyLoginFromMenu=t.dirtyLoginFromMenu=t.clearDirtyLoginFromMenu=t.cleanActivation=t.uiPopupOpen=t.popupOpen=t.uiDeepLinkRedirect=t.deepLinkRedirect=t.apiError=void 0;var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);t.apiError=function(n){return{type:u.API_ERROR,payload:n}},t.deepLinkRedirect=function(n){var t=n.merchantId,r=n.productId,e=n.tabId;return{type:u.DEEP_LINK_REDIRECT,payload:{merchantId:t,productId:r,tabId:e}}},t.uiDeepLinkRedirect=function(n){var t=n.merchantId,r=n.productId,e=n.tabId;return{type:u.DEEP_LINK_REDIRECT,merchantId:t,productId:r,tabId:e}},t.popupOpen=function(){return{type:u.OPEN_POPUP_UI}},t.uiPopupOpen=function(){return{type:u.OPEN_POPUP_UI}},t.cleanActivation=function(){return{type:u.CLEAN_ACTIVATION}},t.clearDirtyLoginFromMenu=function(n){return{type:u.CLEAR_DIRTY_LOGIN_FROM_MENU,payload:{from:n}}},t.dirtyLoginFromMenu=function(n){return{type:u.DIRTY_LOGIN_FROM_MENU,payload:(0,o.default)({},n)}},t.uiDirtyLoginFromMenu=function(n){return{type:u.DIRTY_LOGIN_FROM_MENU,from:n}}},function(n,t,r){var e=r(65);n.exports=function(n,t,r){if(e(n),void 0===t)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 2:return function(r,e){return n.call(t,r,e)};case 3:return function(r,e,i){return n.call(t,r,e,i)}}return function(){return n.apply(t,arguments)}}},function(n,t,r){var e=r(15);n.exports=function(n,t){if(!e(n))return n;var r,i;if(t&&"function"==typeof(r=n.toString)&&!e(i=r.call(n)))return i;if("function"==typeof(r=n.valueOf)&&!e(i=r.call(n)))return i;if(!t&&"function"==typeof(r=n.toString)&&!e(i=r.call(n)))return i;throw TypeError("Can't convert object to primitive value")}},function(n,t,r){var e=r(9),i=r(84),o=r(42),u=r(35)("IE_PROTO"),a=function(){},c=function(){var n,t=r(50)("iframe"),e=o.length;for(t.style.display="none",r(73).appendChild(t),t.src="javascript:",(n=t.contentWindow.document).open(),n.write("<script>document.F=Object<\/script>"),n.close(),c=n.F;e--;)delete c.prototype[o[e]];return c()};n.exports=Object.create||function(n,t){var r;return null!==n?(a.prototype=e(n),r=new a,a.prototype=null,r[u]=n):r=c(),void 0===t?r:i(r,t)}},function(n,t){t.f=Object.getOwnPropertySymbols},function(n,t,r){var e=r(15),i=r(4).document,o=e(i)&&e(i.createElement);n.exports=function(n){return o?i.createElement(n):{}}},function(n,t,r){var e=r(32),i=r(3)("toStringTag"),o="Arguments"==e(function(){return arguments}());n.exports=function(n){var t,r,u;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(r=function(n,t){try{return n[t]}catch(n){}}(t=Object(n),i))?r:o?e(t):"Object"==(u=e(t))&&"function"==typeof t.callee?"Arguments":u}},function(n,t){n.exports={URL_AFTER_INSTALL:"https://www.shopback.com/cashback-button/success",URL_AFTER_UNINSTALL:"https://www.shopback.com/uninstall",URL_COUNTRY_CODE:"https://api.shopback.com/location/countrycode",API_HOST_XX:{COM:"api.shopback.com",SG:"api.shopback.sg",MY:"api.shopback.my",PH:"api.shopback.ph",ID:"api.shopback.co.id",IN:"api.shopback.in",TW:"api.shopback.com.tw",AU:"api.shopback.com.au",TH:"api.myshopback.co.th"},SB_WEBSITE_XX:{COM:"www.shopback.com",SG:"www.shopback.sg",MY:"www.shopback.my",PH:"www.shopback.ph",ID:"www.shopback.co.id",IN:"www.shopback.in",TW:"www.shopback.com.tw",AU:"www.shopback.com.au",TH:"www.shopback.co.th"},EXTENSION_STORES:{COM:"https://chrome.google.com/webstore/detail/shopback-cashback-button/clomojagppekiladdknhnpjoihabjmnm",SG:"https://chrome.google.com/webstore/detail/shopback-cashback-button/hjngckebbndpdeeakdgohmcdnecidcjk",MY:"https://chrome.google.com/webstore/detail/shopback-cashback-button/fgobhpdfgjoognbahjpeabmlheajfpik",PH:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ngeinbnbakgkpcmokhonplkllgbnohoo",ID:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ambfhpcdfdlobjbckfbajgdoohfhaahn",TW:"https://chrome.google.com/webstore/detail/shopback-%E7%8F%BE%E9%87%91%E5%9B%9E%E9%A5%8B%E5%B0%8F%E5%B9%AB%E6%89%8B/djjjmdgomejlopjnccoejdhgjmiappap",AU:"https://chrome.google.com/webstore/detail/shopback-cashback-button/dlkceoecbkpgngncmlcbmcnedjkpihni",TH:"https://chrome.google.com/webstore/detail/shopback-cashback-button/ccbgpokbhaoahpebadnnjeoamielibki",FIREFOX:"https://addons.mozilla.org/en-US/firefox/addon/shopback-cashback-button"},HELP_CENTER:{COM:"https://shopback.zendesk.com/hc/en-us/articles/215540757",SG:"https://support.shopback.sg/hc/en-us/articles/115010365348",MY:"https://support.shopback.my/hc/en-us/articles/115010204007",PH:"https://support.shopback.ph/hc/en-us/articles/115010204547",ID:"https://support.shopback.co.id/hc/en-us/articles/115010369648",TW:"https://support.shopback.com.tw/hc/zh-tw/articles/360013698513",AU:"https://support.shopback.com.au/hc/en-us/articles/360001888848",TH:"https://support.shopback.co.th/hc/th/articles/360013913233"},SB_HELP_CENTER_COUPON_CODES_NOT_WORK_XX:{COM:"https://support.shopback.sg/hc/en-us/articles/360025371214",SG:"https://support.shopback.sg/hc/en-us/articles/360025371214",MY:"https://support.shopback.sg/hc/en-us/articles/360025371214",PH:"https://support.shopback.sg/hc/en-us/articles/360025371214",ID:"https://support.shopback.sg/hc/en-us/articles/360025371214",IN:"https://support.shopback.sg/hc/en-us/articles/360025371214",TW:"https://support.shopback.sg/hc/en-us/articles/360025371214",AU:"https://support.shopback.sg/hc/en-us/articles/360025371214",TH:"https://support.shopback.sg/hc/en-us/articles/360025371214"},SB_COUPONS_REPORT_ISSUE_XX:{COM:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",SG:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",MY:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",PH:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",ID:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",IN:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",TW:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",AU:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform",TH:"https://docs.google.com/forms/d/e/1FAIpQLSfxFrimy14t7QlvhiaAwvhKXSt1RFPdKjtxKDu_HHNlQ-zHtg/viewform"},ACTIVATED_EXPIRED_MS:36e5,ACTIVATED_EXPIRED_MS_FOR_TAOBAO:864e5,PERMISSION_NOTIFIER_TTL:36e5,SENTRY_DSN:"https://5740ea62fe804eeaa16f0b7c55d9f521@sentry.io/1189626",SENTRY_SAMPLE_RATE:.2}},function(n,t,r){var e=r(32);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==e(n)?n.split(""):Object(n)}},function(n,t,r){"use strict";var e=r(23),i=r(13),o=r(59),u=r(12),a=r(14),c=r(83),f=r(40),s=r(87),l=r(3)("iterator"),v=!([].keys&&"next"in[].keys()),d=function(){return this};n.exports=function(n,t,r,p,h,_,b){c(r,t,p);var E,O,y,m=function(n){if(!v&&n in A)return A[n];switch(n){case"keys":case"values":return function(){return new r(this,n)}}return function(){return new r(this,n)}},T=t+" Iterator",g="values"==h,I=!1,A=n.prototype,C=A[l]||A["@@iterator"]||h&&A[h],S=C||m(h),w=h?g?m("entries"):S:void 0,N="Array"==t&&A.entries||C;if(N&&(y=s(N.call(new n)))!==Object.prototype&&y.next&&(f(y,T,!0),e||"function"==typeof y[l]||u(y,l,d)),g&&C&&"values"!==C.name&&(I=!0,S=function(){return C.call(this)}),e&&!b||!v&&!I&&A[l]||u(A,l,S),a[t]=S,a[T]=d,h)if(E={values:g?S:m("values"),keys:_?S:m("keys"),entries:w},b)for(O in E)O in A||o(A,O,E[O]);else i(i.P+i.F*(v||I),t,E);return E}},function(n,t,r){(function(t){var e=r(71),i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function o(n){return void 0===n}function u(n){return"[object Object]"===Object.prototype.toString.call(n)}function a(n){return"[object String]"===Object.prototype.toString.call(n)}function c(n){return"[object Array]"===Object.prototype.toString.call(n)}function f(){try{return new ErrorEvent(""),!0}catch(n){return!1}}function s(){if(!("fetch"in i))return!1;try{return new Headers,new Request(""),new Response,!0}catch(n){return!1}}function l(n,t){var r,e;if(o(n.length))for(r in n)v(n,r)&&t.call(null,r,n[r]);else if(e=n.length)for(r=0;r<e;r++)t.call(null,r,n[r])}function v(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function d(n){for(var t,r=[],e=0,i=n.length;e<i;e++)a(t=n[e])?r.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&r.push(t.source);return new RegExp(r.join("|"),"i")}function p(n){var t,r,e,i,o,u=[];if(!n||!n.tagName)return"";if(u.push(n.tagName.toLowerCase()),n.id&&u.push("#"+n.id),(t=n.className)&&a(t))for(r=t.split(/\s+/),o=0;o<r.length;o++)u.push("."+r[o]);var c=["type","name","title","alt"];for(o=0;o<c.length;o++)e=c[o],(i=n.getAttribute(e))&&u.push("["+e+'="'+i+'"]');return u.join("")}function h(n,t){return!!(!!n^!!t)}function _(n,t){if(h(n,t))return!1;var r,e,i=n.frames,o=t.frames;if(i.length!==o.length)return!1;for(var u=0;u<i.length;u++)if(r=i[u],e=o[u],r.filename!==e.filename||r.lineno!==e.lineno||r.colno!==e.colno||r.function!==e.function)return!1;return!0}var b=3,E=51200,O=40;function y(n){return function(n){return~-encodeURI(n).split(/%..|./).length}(JSON.stringify(n))}function m(n){if("string"==typeof n)return n.length<=40?n:n.substr(0,39)+"…";if("number"==typeof n||"boolean"==typeof n||void 0===n)return n;var t=Object.prototype.toString.call(n);return"[object Object]"===t?"[Object]":"[object Array]"===t?"[Array]":"[object Function]"===t?n.name?"[Function: "+n.name+"]":"[Function]":n}n.exports={isObject:function(n){return"object"==typeof n&&null!==n},isError:function(n){switch({}.toString.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return n instanceof Error}},isErrorEvent:function(n){return f()&&"[object ErrorEvent]"==={}.toString.call(n)},isUndefined:o,isFunction:function(n){return"function"==typeof n},isPlainObject:u,isString:a,isArray:c,isEmptyObject:function(n){if(!u(n))return!1;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},supportsErrorEvent:f,supportsFetch:s,supportsReferrerPolicy:function(){if(!s())return!1;try{return new Request("pickleRick",{referrerPolicy:"origin"}),!0}catch(n){return!1}},supportsPromiseRejectionEvent:function(){return"function"==typeof PromiseRejectionEvent},wrappedCallback:function(n){return function(t,r){var e=n(t)||t;return r&&r(e)||e}},each:l,objectMerge:function(n,t){return t?(l(t,function(t,r){n[t]=r}),n):n},truncate:function(n,t){return!t||n.length<=t?n:n.substr(0,t)+"…"},objectFrozen:function(n){return!!Object.isFrozen&&Object.isFrozen(n)},hasKey:v,joinRegExp:d,urlencode:function(n){var t=[];return l(n,function(n,r){t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}),t.join("&")},uuid4:function(){var n=i.crypto||i.msCrypto;if(!o(n)&&n.getRandomValues){var t=new Uint16Array(8);n.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var r=function(n){for(var t=n.toString(16);t.length<4;)t="0"+t;return t};return r(t[0])+r(t[1])+r(t[2])+r(t[3])+r(t[4])+r(t[5])+r(t[6])+r(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=16*Math.random()|0;return("x"===n?t:3&t|8).toString(16)})},htmlTreeAsString:function(n){for(var t,r=[],e=0,i=0,o=" > ".length;n&&e++<5&&!("html"===(t=p(n))||e>1&&i+r.length*o+t.length>=80);)r.push(t),i+=t.length,n=n.parentNode;return r.reverse().join(" > ")},htmlElementAsString:p,isSameException:function(n,t){return!h(n,t)&&(n=n.values[0],t=t.values[0],n.type===t.type&&n.value===t.value&&(r=n.stacktrace,e=t.stacktrace,(!o(r)||!o(e))&&_(n.stacktrace,t.stacktrace)));var r,e},isSameStacktrace:_,parseUrl:function(n){if("string"!=typeof n)return{};var t=n.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/),r=t[6]||"",e=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+r+e}},fill:function(n,t,r,e){if(null!=n){var i=n[t];n[t]=r(i),n[t].__raven__=!0,n[t].__orig__=i,e&&e.push([n,t,i])}},safeJoin:function(n,t){if(!c(n))return"";for(var r=[],e=0;e<n.length;e++)try{r.push(String(n[e]))}catch(n){r.push("[value cannot be serialized]")}return r.join(t)},serializeException:function n(t,r,i){if(!u(t))return t;i="number"!=typeof(r="number"!=typeof r?b:r)?E:i;var o=function n(t,r){return 0===r?m(t):u(t)?Object.keys(t).reduce(function(e,i){return e[i]=n(t[i],r-1),e},{}):Array.isArray(t)?t.map(function(t){return n(t,r-1)}):m(t)}(t,r);return y(e(o))>i?n(t,r-1):o},serializeKeysForMessage:function(n,t){if("number"==typeof n||"string"==typeof n)return n.toString();if(!Array.isArray(n))return"";if(0===(n=n.filter(function(n){return"string"==typeof n})).length)return"[object has no keys]";if(t="number"!=typeof t?O:t,n[0].length>=t)return n[0];for(var r=n.length;r>0;r--){var e=n.slice(0,r).join(", ");if(!(e.length>t))return r===n.length?e:e+"…"}return""},sanitize:function(n,t){if(!c(t)||c(t)&&0===t.length)return n;var r,i=d(t),o="********";try{r=JSON.parse(e(n))}catch(t){return n}return function n(t){return c(t)?t.map(function(t){return n(t)}):u(t)?Object.keys(t).reduce(function(r,e){return i.test(e)?r[e]=o:r[e]=n(t[e]),r},{}):t}(r)}}}).call(t,r(20))},,function(n,t){n.exports=function(n){return null!=n&&"object"==typeof n}},function(n,t,r){n.exports=!r(6)&&!r(18)(function(){return 7!=Object.defineProperty(r(50)("div"),"a",{get:function(){return 7}}).a})},function(n,t,r){n.exports=r(12)},function(n,t,r){var e=r(10),i=r(16),o=r(85)(!1),u=r(35)("IE_PROTO");n.exports=function(n,t){var r,a=i(n),c=0,f=[];for(r in a)r!=u&&e(a,r)&&f.push(r);for(;t.length>c;)e(a,r=t[c++])&&(~o(f,r)||f.push(r));return f}},,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchWithRetry=t.handleErrors=void 0;var e=r(113);t.handleErrors=function(n){if(!n.ok)throw(0,e.sendToSentry)(n),Error(n.statusText);return n},t.fetchWithRetry=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.retries||3,i=t.retryDelay||1e3,o=t.retryOnHttpStatus;o=o instanceof Array?o:[];var u=function(n,t){var r=t-1;setTimeout(function(){n(r)},i)};return new Promise(function(i,a){!function r(c){fetch(n,t).then(function(n){n.ok||n.redirected||(0,e.sendToSentry)(n),o&&-1===o.indexOf(n.status)?i(n):c>0?u(r,c):a(n)}).catch(function(n){(0,e.sendToSentry)(n),c>0?u(r,c):a(n)})}(r)})}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var e,i=r(1),o=(e=i)&&e.__esModule?e:{default:e},u=r(110),a=r(0);var c=t.logger={info:function(n,t){if((0,u.isLoggerEnabled)(n.getState())){var r={message:t,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};console.groupCollapsed(t,r.timeStamp),console.trace(),console.info(r),console.groupEnd()}},warn:function(n,t){if((0,u.isLoggerEnabled)(n.getState())){var r={message:t,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};a.IS_FIREFOX?(console.groupCollapsed(t,r.timeStamp),console.trace(),console.warn(r),console.groupEnd()):console.warn(r)}},error:function(n,t){if((0,u.isLoggerEnabled)(n.getState())){var r={message:t,timeStamp:(0,o.default)().format(o.default.HTML5_FMT.DATETIME_LOCAL_MS)};console.error(r)}}};t.default=c},function(n,t){n.exports=function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!");return n}},function(n,t,r){var e=r(34),i=Math.min;n.exports=function(n){return n>0?i(e(n),9007199254740991):0}},function(n,t,r){var e=r(51),i=r(3)("iterator"),o=r(14);n.exports=r(2).getIteratorMethod=function(n){if(void 0!=n)return n[i]||n["@@iterator"]||o[e(n)]}},function(n,t,r){var e=r(208),i=r(213);n.exports=function(n,t){var r=i(n,t);return e(r)?r:void 0}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uiTrackExtManualSuccessfulCode=t.trackExtManualSuccessfulCode=t.uiTrackExtErrorOccured=t.trackExtErrorOccured=t.uiTrackExtApplyCouponCode=t.trackExtApplyCouponCode=t.uiTrackExtSerpClicked=t.trackExtSerpClicked=t.uiTrackExtSerpVisited=t.trackExtSerpVisited=t.uiTrackExtMenuOpen=t.trackExtMenuOpen=t.uiTrackExtSwitchLogin=t.trackExtSwitchLogin=t.uiTrackExtRedirect=t.trackExtRedirect=t.uiTrackExtClick=t.trackExtClick=t.uiTrackExtSearch=t.trackExtSearch=t.uiTrackExtNotifierActivatedPrompt=t.trackExtNotifierActivatedPrompt=t.uiTrackExtNotifierPrompt=t.trackExtNotifierPrompt=t.uiTrackExtPageVisited=t.trackExtPageVisited=t.trackExtLogin=t.trackExtUpdated=t.trackExtInstalled=void 0;var e=u(r(105)),i=u(r(5)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));function u(n){return n&&n.__esModule?n:{default:n}}t.trackExtInstalled=function(){return{type:o.EVENT_EXT_INSTALLED,payload:{message:"cute whale born"}}},t.trackExtUpdated=function(){return{type:o.EVENT_EXT_UPDATED,payload:{message:"little whale grow"}}},t.trackExtLogin=function(n,t,r,e){return{type:o.EVENT_EXT_LOGIN,payload:{location:n,countrySelected:t,status:r,url:e}}},t.trackExtPageVisited=function(n){return{type:o.EVENT_EXT_PAGE_VISITED,payload:(0,i.default)({},n)}},t.uiTrackExtPageVisited=function(n,t,r){return{type:o.EVENT_EXT_PAGE_VISITED,url:t,storeId:n,referrerUrl:r}};t.trackExtNotifierPrompt=function(n){var t=n.propertyType,r=(0,e.default)(n,["propertyType"]);return{type:o.EVENT_EXT_NOTIFIER_PROMPT,payload:(0,i.default)({},r,{type:t})}};t.uiTrackExtNotifierPrompt=function(n,t,r){return{type:o.EVENT_EXT_NOTIFIER_PROMPT,propertyType:n,storeId:t,url:r}},t.trackExtNotifierActivatedPrompt=function(n){return{type:o.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT,payload:(0,i.default)({},n)}},t.uiTrackExtNotifierActivatedPrompt=function(n,t){return{type:o.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT,storeId:n,url:t}},t.trackExtSearch=function(n){return{type:o.EVENT_EXT_SEARCH,payload:(0,i.default)({},n)}},t.uiTrackExtSearch=function(n,t,r,e){return{type:o.EVENT_EXT_SEARCH,storeId:r,url:e,location:n,searchTerm:t}},t.trackExtClick=function(n){return{type:o.EVENT_EXT_CLICK,payload:(0,i.default)({},n)}},t.uiTrackExtClick=function(n,t,r,e,u,a,c,f,s){var l={type:o.EVENT_EXT_CLICK,componentName:n,objectName:t,objectPosition:r,objectType:e,objectId:u,objectDestinationUrl:a,storeId:c,url:f};return s?(0,i.default)({},l,{applyingId:s}):l},t.trackExtRedirect=function(n){return{type:o.EVENT_EXT_REDIRECT,payload:(0,i.default)({},n)}},t.uiTrackExtRedirect=function(n){return(0,i.default)({type:o.EVENT_EXT_REDIRECT},n)},t.trackExtSwitchLogin=function(n){return{type:o.EVENT_EXT_LOGIN,payload:(0,i.default)({},n)}},t.uiTrackExtSwitchLogin=function(n,t,r,e){return{type:o.EVENT_EXT_LOGIN,location:n,countrySelected:t,status:r,url:e}},t.trackExtMenuOpen=function(n){return{type:o.EVENT_EXT_MENU_OPEN,payload:(0,i.default)({},n)}},t.uiTrackExtMenuOpen=function(n,t){return{type:o.EVENT_EXT_MENU_OPEN,storeId:n,url:t}},t.trackExtSerpVisited=function(n){return{type:o.EVENT_EXT_SERP_VISITED,payload:(0,i.default)({},n)}},t.uiTrackExtSerpVisited=function(n,t,r,e){return{type:o.EVENT_EXT_SERP_VISITED,serpDomain:n,url:t,searchKeyword:r,injectionCount:e}},t.trackExtSerpClicked=function(n){return{type:o.EVENT_EXT_SERP_CLICKED,payload:(0,i.default)({},n)}},t.uiTrackExtSerpClicked=function(n,t,r,e){return{type:o.EVENT_EXT_SERP_CLICKED,serpDomain:n,linkUrl:t,storeId:r,clickTarget:e}};t.trackExtApplyCouponCode=function(n){var t=n.applyType,r=(0,e.default)(n,["applyType"]);return{type:o.EVENT_EXT_APPLY_COUPON_CODE,payload:(0,i.default)({},r,{type:t})}};t.uiTrackExtApplyCouponCode=function(n){return(0,i.default)({type:o.EVENT_EXT_APPLY_COUPON_CODE},n)},t.trackExtErrorOccured=function(n){return{type:o.EVENT_EXT_ERROR_OCCURED,payload:(0,i.default)({},n)}},t.uiTrackExtErrorOccured=function(n,t,r,e,i,u,a){return{type:o.EVENT_EXT_ERROR_OCCURED,applyingId:n,location:t,errorCode:r,errorMessage:e,targetPattern:i,url:u,storeId:a}},t.trackExtManualSuccessfulCode=function(n,t){return{type:o.EVENT_EXT_MANUAL_APPLY_COUPON_CODE,payload:{storeId:n,successfulCode:t}}},t.uiTrackExtManualSuccessfulCode=function(n,t){return{type:o.EVENT_EXT_MANUAL_APPLY_COUPON_CODE,storeId:n,successfulCode:t}}},,function(n,t){function r(n,t){for(var r=0;r<n.length;++r)if(n[r]===t)return r;return-1}function e(n,t){var e=[],i=[];return null==t&&(t=function(n,t){return e[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,r(e,t)).join(".")+"]"}),function(o,u){if(e.length>0){var a=r(e,this);~a?e.splice(a+1):e.push(this),~a?i.splice(a,1/0,o):i.push(o),~r(e,u)&&(u=t.call(this,o,u))}else e.push(u);return null==n?u instanceof Error?function(n){var t={stack:n.stack,message:n.message,name:n.name};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}(u):u:n.call(this,o,u)}}(n.exports=function(n,t,r,i){return JSON.stringify(n,e(t,i),r)}).getSerialize=e},function(n,t,r){var e=r(103),i=r(209),o=r(210),u="[object Null]",a="[object Undefined]",c=e?e.toStringTag:void 0;n.exports=function(n){return null==n?void 0===n?a:u:c&&c in Object(n)?i(n):o(n)}},function(n,t,r){var e=r(4).document;n.exports=e&&e.documentElement},function(n,t,r){n.exports={default:r(106),__esModule:!0}},function(n,t,r){"use strict";t.__esModule=!0;var e,i=r(74),o=(e=i)&&e.__esModule?e:{default:e};t.default=function(n,t,r){return t in n?(0,o.default)(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}},function(n,t){n.exports=function(n){var t=typeof n;return null!=n&&("object"==t||"function"==t)}},,function(n,t,r){n.exports={default:r(79),__esModule:!0}},function(n,t,r){r(39),r(28),n.exports=r(89)},function(n,t,r){"use strict";var e=r(81),i=r(82),o=r(14),u=r(16);n.exports=r(54)(Array,"Array",function(n,t){this._t=u(n),this._i=0,this._k=t},function(){var n=this._t,t=this._k,r=this._i++;return!n||r>=n.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?n[r]:[r,n[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(n,t){n.exports=function(){}},function(n,t){n.exports=function(n,t){return{value:t,done:!!n}}},function(n,t,r){"use strict";var e=r(48),i=r(22),o=r(40),u={};r(12)(u,r(3)("iterator"),function(){return this}),n.exports=function(n,t,r){n.prototype=e(u,{next:i(1,r)}),o(n,t+" Iterator")}},function(n,t,r){var e=r(8),i=r(9),o=r(26);n.exports=r(6)?Object.defineProperties:function(n,t){i(n);for(var r,u=o(t),a=u.length,c=0;a>c;)e.f(n,r=u[c++],t[r]);return n}},function(n,t,r){var e=r(16),i=r(66),o=r(86);n.exports=function(n){return function(t,r,u){var a,c=e(t),f=i(c.length),s=o(u,f);if(n&&r!=r){for(;f>s;)if((a=c[s++])!=a)return!0}else for(;f>s;s++)if((n||s in c)&&c[s]===r)return n||s||0;return!n&&-1}}},function(n,t,r){var e=r(34),i=Math.max,o=Math.min;n.exports=function(n,t){return(n=e(n))<0?i(n+t,0):o(n,t)}},function(n,t,r){var e=r(10),i=r(37),o=r(35)("IE_PROTO"),u=Object.prototype;n.exports=Object.getPrototypeOf||function(n){return n=i(n),e(n,o)?n[o]:"function"==typeof n.constructor&&n instanceof n.constructor?n.constructor.prototype:n instanceof Object?u:null}},function(n,t,r){var e=r(34),i=r(33);n.exports=function(n){return function(t,r){var o,u,a=String(i(t)),c=e(r),f=a.length;return c<0||c>=f?n?"":void 0:(o=a.charCodeAt(c))<55296||o>56319||c+1===f||(u=a.charCodeAt(c+1))<56320||u>57343?n?a.charAt(c):o:n?a.slice(c,c+2):u-56320+(o-55296<<10)+65536}}},function(n,t,r){var e=r(51),i=r(3)("iterator"),o=r(14);n.exports=r(2).isIterable=function(n){var t=Object(n);return void 0!==t[i]||"@@iterator"in t||o.hasOwnProperty(e(t))}},function(n,t,r){n.exports={default:r(91),__esModule:!0}},function(n,t,r){r(39),r(28),n.exports=r(92)},function(n,t,r){var e=r(9),i=r(67);n.exports=r(2).getIterator=function(n){var t=i(n);if("function"!=typeof t)throw TypeError(n+" is not iterable!");return e(t.call(n))}},function(n,t,r){n.exports={default:r(94),__esModule:!0}},function(n,t,r){r(95),n.exports=r(2).Object.assign},function(n,t,r){var e=r(13);e(e.S+e.F,"Object",{assign:r(96)})},function(n,t,r){"use strict";var e=r(6),i=r(26),o=r(49),u=r(36),a=r(37),c=r(53),f=Object.assign;n.exports=!f||r(18)(function(){var n={},t={},r=Symbol(),e="abcdefghijklmnopqrst";return n[r]=7,e.split("").forEach(function(n){t[n]=n}),7!=f({},n)[r]||Object.keys(f({},t)).join("")!=e})?function(n,t){for(var r=a(n),f=arguments.length,s=1,l=o.f,v=u.f;f>s;)for(var d,p=c(arguments[s++]),h=l?i(p).concat(l(p)):i(p),_=h.length,b=0;_>b;)d=h[b++],e&&!v.call(p,d)||(r[d]=p[d]);return r}:f},,,,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=d(r(38)),i=d(r(75)),o=d(r(5));t.fetchMerchants=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.DEFAULT_COUNTRY,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(r,e){var o;return(0,u.fetchWithRetry)((0,s.getMerchantsAPI)(n,{confirmation:!0,disableReason:!0,metaInfo:!0},(0,v.ironGateEnabled)(e())),{headers:(o={},(0,i.default)(o,f.HEADERS.X_SHOPBACK_LAST_CC,n),(0,i.default)(o,f.HEADERS.X_SHOPBACK_IRONGATE_ENABLED,(0,v.ironGateEnabled)(e())),o),retryOnHttpStatus:[500,502,503,504]}).then(function(n){return n.json()}).then(function(i){r(function(n,t,r){return{type:t?f.REFETCH_MERCHANTS_SUCCESS:f.FETCH_MERCHANTS_SUCCESS,payload:{cc:r,merchants:n,activateX:browser.i18n.getMessage("notifier_cashback_activate"),reActivateX:browser.i18n.getMessage("disabler_cashback_activate"),loginToActivateX:browser.i18n.getMessage("notifier_log_in_first"),cashbackHeader:browser.i18n.getMessage("popup_header_cashback"),serpCashbackInfo:browser.i18n.getMessage("serp_cashback_info"),cashbackModifiers:{"<":browser.i18n.getMessage("notifier_cashback_modifier_up_to"),"<=":browser.i18n.getMessage("notifier_cashback_modifier_up_to"),"=":""}}}}(p(i,(0,v.ironGateEnabled)(e())),t,n))}).catch(function(n){var t=n.message;r((0,c.apiError)({errorType:f.FETCH_MERCHANTS_ERROR,message:t}))})}},t.standDownMerchantNotifier=function(n){var t=n.merchantId;return{type:f.STAND_DOWN_MERCHANT_NOTIFIER,payload:{merchantId:t}}},t.standUpMerchantNotifier=function(n){var t=n.merchantId;return{type:f.STAND_UP_MERCHANT_NOTIFIER,payload:{merchantId:t}}},t.closeMerchantNotifier=function(n){var t=n.merchantId;return{type:f.CLOSE_MERCHANT_NOTIFIER,payload:{merchantId:t}}},t.uiCloseMerchantNotifier=function(n){return{type:f.CLOSE_MERCHANT_NOTIFIER,merchantId:n}},t.fetchTopMerchants=function(){return function(n,t){var r;return fetch((0,s.getMerchantsAPI)(t().cc,{top:!0},(0,v.ironGateEnabled)(t())),{headers:(r={},(0,i.default)(r,f.HEADERS.X_SHOPBACK_LAST_CC,t().cc),(0,i.default)(r,f.HEADERS.X_SHOPBACK_IRONGATE_ENABLED,(0,v.ironGateEnabled)(t())),r)}).then(u.handleErrors).then(function(n){return n.json()}).then(function(r){var e;n((e=p(r,(0,v.ironGateEnabled)(t())),{type:f.FETCH_TOP_MERCHANTS_SUCCESS,payload:e}))}).catch(function(t){var r=t.message;n((0,c.apiError)({errorType:f.FETCH_TOP_MERCHANTS_ERROR,message:r}))})}},t.uiFetchTopMerchants=function(){return{type:f.FETCH_TOP_MERCHANTS}},t.deActivate=function(n){return{type:f.DE_ACTIVATE,payload:(0,o.default)({},n)}},t.uiDeActivate=function(n){return{type:f.DE_ACTIVATE,merchantId:n}},t.startActivate=function(n){return function(t){return browser.tabs.query({active:!0,currentWindow:!0}).then(function(r){var i=(0,e.default)(r,1),o=i[0];t({type:f.START_ACTIVATE,payload:{tabId:o.id,referrer:n.forceToSetReferrer?n.prevUrl||o.url:null,merchantId:n.merchantId}}),t({type:f.ADD_DIRTY_REDIRECT,payload:{tabId:o.id,from:n.from,merchantId:n.merchantId}})})}},t.uiStartActivate=function(n){return(0,o.default)({type:f.START_ACTIVATE},n)},t.deleteExpiredActivatedMerchant=function(n){return{type:f.DELETE_EXPIRED_ACTIVATED_MERCHANT,payload:{merchant:n}}},t.closeActivatedMerchantNotifier=h,t.uiCloseActivatedMerchantNotifier=function(n){return{type:f.CLOSE_ACTIVATED_MERCHANT_NOTIFIER,merchantId:n}},t.detectSBRedirectPage=function(n){return{type:f.DETECT_SB_REDIRECT_PAGE,payload:(0,o.default)({},n)}},t.uiDetectSBRedirectPage=function(n){return(0,o.default)({type:f.DETECT_SB_REDIRECT_PAGE},n)},t.visitActivatedMerchantNotifier=function(n){var t=n.merchant;return function(n,r){var e=(0,a.getActivatedMerchantInfo)(r(),{merchant:t});return e&&e.visited===f.ACTIVATED_NOTIFIER_NOT_YET_VISITED?(n({type:f.VISIT_ACTIVATED_MERCHANT_NOTIFIER,payload:{merchantId:t.id}}),new Promise(function(r){setTimeout(function(){n(h({merchantId:t.id})),r()},f.TIME_TO_CLOSE_ACTIVATED_NOTIFIER)})):Promise.resolve()}},t.uiVisitActivatedMerchantNotifier=function(n){return{type:f.VISIT_ACTIVATED_MERCHANT_NOTIFIER,merchant:n}},t.h=function(n,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(e,i){return n.isTaobao||(0,l.v)(i(),{merchant:n})&&!(0,a.l)(i(),{merchant:n})?Promise.resolve({}):e({type:f.i,payload:{merchantId:n.id,focusing:r,tabId:t}})}};var u=r(63),a=r(29),c=r(45),f=r(0),s=r(19),l=r(29),v=r(109);function d(n){return n&&n.__esModule?n:{default:n}}function p(n,t){return n.map(function(n){var r=void 0;try{RegExp(n.url_pattern),r=n.url_pattern}catch(t){console.log("Incorrect url_pattern: "+n.url_pattern),r=""}return(0,o.default)({},n,{id:t?n.merchantId:n.id,url_pattern:r})})}function h(n){var t=n.merchantId;return{type:f.CLOSE_ACTIVATED_MERCHANT_NOTIFIER,payload:{merchantId:t}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.APPLY_DISCOUNTS="APPLY_DISCOUNTS",t.FINISH_APPLY_DISCOUNTS="FINISH_APPLY_DISCOUNTS",t.SET_BEST_PRICE_AND_CODE="SET_BEST_PRICE_AND_CODE",t.SET_ORIGINAL_PRICE="SET_ORIGINAL_PRICE",t.COUPON_OPEN_NOTIFIER="COUPON_OPEN_NOTIFIER",t.COUPON_CLOSE_NOTIFIER="COUPON_CLOSE_NOTIFIER",t.COUPON_OPEN_APPLY_RESULT="COUPON_OPEN_APPLY_RESULT",t.COUPON_CLOSE_APPLY_RESULT="COUPON_CLOSE_APPLY_RESULT",t.COUPON_OPEN_INTERMEDIATE_APPLY_RESULT="COUPON_OPEN_INTERMEDIATE_APPLY_RESULT",t.COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT="COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT",t.COUPON_CLOSE_APPLIER="COUPON_CLOSE_APPLIER",t.FETCH_COUPONS_BY_MERCHANT="FETCH_COUPONS_BY_MERCHANT",t.FETCH_COUPONS_BY_MERCHANT_SUCCESS="FETCH_COUPONS_BY_MERCHANT_SUCCESS",t.FETCH_COUPONS_BY_MERCHANT_ERROR="FETCH_COUPONS_BY_MERCHANT_ERROR",t.FETCH_TRENDING_COUPONS="FETCH_TRENDING_COUPONS",t.FETCH_TRENDING_COUPONS_SUCCESS="FETCH_TRENDING_COUPONS_SUCCESS",t.FETCH_TRENDING_COUPONS_ERROR="FETCH_TRENDING_COUPONS_ERROR",t.PATCH_COUPON_STATS="PATCH_COUPON_STATS",t.PATCH_COUPON_STATS_SUCCESS="PATCH_COUPON_STATS_SUCCESS",t.PATCH_COUPON_STATS_ERROR="PATCH_COUPON_STATS_ERRPR",t.APPLY_BEST_CODE="APPLY_BEST_CODE",t.CLOSE_MENU_APPLY_CODE_BTN="CLOSE_MENU_APPLY_CODE_BTN",t.OPEN_MENU_APPLY_CODE_BTN="OPEN_MENU_APPLY_CODE_BTN",t.COUPON_CLOSE_APPLIER_ERROR_PAGE="COUPON_CLOSE_APPLIER_ERROR_PAGE",t.COUPON_OPEN_APPLIER_ERROR_PAGE="COUPON_OPEN_APPLIER_ERROR_PAGE",t.CHECK_COUPON_TARGETS_OBSERVED="CHECK_COUPON_TARGETS_OBSERVED",t.COUPON_DISAPPEAR_NOTIFIER="COUPON_DISAPPEAR_NOTIFIER",t.COUPON_CHANGE_APPLY_DISCOUNTS_STATUS="COUPON_CHANGE_APPLY_DISCOUNTS_STATUS",t.COUPON_CHANGE_CODE_APPLY_STATUS="COUPON_CHANGE_CODE_APPLY_STATUS",t.MANUAL_APPLY_COUPON_CODE="MANUAL_APPLY_COUPON_CODE",t.CLEAR_COUPONS="CLEAR_COUPONS",t.SAVE_NON_COUPON_MERCHANT="SAVE_NON_COUPON_MERCHANT",t.INITIALIZE_APPLYING_META_DATA="INITIALIZE_APPLYING_META_DATA",t.INITIALIZE_APPLYING_META_DATA_SUCCESS="INITIALIZE_APPLYING_META_DATA_SUCCESS",t.CLEAR_APPLYING_META_DATA="CLEAR_APPLYING_META_DATA",t.COUPON_CODE_NOT_APPLIED=0,t.COUPON_CODE_APPLYING=1,t.COUPON_CODE_VERIFIED=2,t.COUPON_CODE_APPLY_DONE=3,t.COUPON_APPLIER_WIDTH_PX=600,t.REFETCH_COUPON_INTERVAL_MS=3e5,t.COUPON_DISAPPEAR_NOTIFIER_HOUR=1,t.COUPON_INPUT_PATTERN_NOT_FOUND=9404,t.COUPON_APPLY_BTN_PATTERN_NOT_FOUND=9405,t.COUPON_CLICK_BTN_PATTERN_NOT_FOUND=9406,t.COUPON_NEW_PRICE_NOT_FOUND=9407,t.COUPON_ORIGINAL_PRICE_NOT_FOUND=9408,t.COUPON_WAIT_ELEMENT_EXIST_ERROR=9410,t.COUPON_MISS_CHECKCODE_REQUEST=9487,t.COUPON_INPUT_PATTERN_NOT_FOUND_MESSAGE="Coupon applier can not find input HTML Pattern",t.COUPON_APPLY_BTN_PATTERN_NOT_FOUND_MESSAGE="Coupon applier can not find apply button HTML Pattern",t.COUPON_CLICK_BTN_PATTERN_NOT_FOUND_MESSAGE="Coupon applier can not find clicking button HTML Pattern",t.COUPON_NEW_PRICE_NOT_FOUND_MESSAGE="Coupon applier can not find new price HTML Pattern",t.COUPON_ORIGINAL_PRICE_NOT_FOUND_MESSAGE="Coupon applier can not find original price HTML Pattern",t.COUPON_WAIT_ELEMENT_EXIST_ERROR_MESSAGE="Coupon Applier can not wait certain element",t.COUPON_MISS_CHECKCODE_REQUEST_MESSAGE="Coupon applier miss check code request of merchant",t.GET_ORIGINAL_PRICE="GET_ORIGINAL_PRICE",t.APPLY_CODE="APPLY_CODE",t.WAIT_VERIFIED="WAIT_VERIFIED",t.VERIFIED="VERIFIED",t.ALL_CODE_APPLY_DONE="ALL_CODE_APPLY_DONE",t.WAIT_TO_SHOW_RESULT="WAIT_TO_SHOW_RESULT";var e=t.ENTER_AGAIN="ENTER_AGAIN",i=t.EXPAND="EXPAND",o=t.INPUT="INPUT",u=t.CLICK_APPLY_BTN="CLICK_APPLY_BTN",a=(t.CLICK="CLICK",t.WAIT_ELEMENT_EXIST="WAIT_ELEMENT_EXIST"),c=(t.WAIT_ELEMENT_NOT_EXIST="WAIT_ELEMENT_NOT_EXIST",t.WAIT_PRICE_CHANGE_TO_BEST_PRICE="WAIT_PRICE_CHANGE_TO_BEST_PRICE"),f=t.WAIT_PRICE_CHANGE_TO_ORIGINAL_PRICE="WAIT_PRICE_CHANGE_TO_ORIGINAL_PRICE",s=t.SLEEP="SLEEP",l=t.DISPATCH_APPLY_ACTION="DISPATCH_APPLY_ACTION";t.DEFAULT_WAITING_TIME=3e3,t.MAX_WAITING_TIME=1e4,t.DEFAULT_APPLY_CODE_STEPS=[{action:e,pattern:""},{action:s,time:2e3},{action:f},{action:i,pattern:""},{action:a,pattern:""},{action:o,pattern:""},{action:l},{action:u,pattern:""}],t.DEFAULT_APPLY_DISCOUNTS_PRESTEPS={GET_ORIGINAL_PRICE:[{action:e,pattern:""},{action:s,time:2e3}],VERIFIED:[{action:s,time:2e3}],WAIT_TO_SHOW_RESULT:[{action:c},{action:s,time:2e3}]}},function(n,t,r){var e=r(30).Symbol;n.exports=e},function(n,t,r){(function(t){var e=r(114),i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=i.Raven,u=new e;u.noConflict=function(){return i.Raven=o,u},u.afterLoad(),n.exports=u,n.exports.Client=e}).call(t,r(20))},function(n,t,r){"use strict";t.__esModule=!0,t.default=function(n,t){var r={};for(var e in n)t.indexOf(e)>=0||Object.prototype.hasOwnProperty.call(n,e)&&(r[e]=n[e]);return r}},function(n,t,r){r(107);var e=r(2).Object;n.exports=function(n,t,r){return e.defineProperty(n,t,r)}},function(n,t,r){var e=r(13);e(e.S+e.F*!r(6),"Object",{defineProperty:r(8).f})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCloseTaoBaoNotifierAt=t.isTaoBaoShoppingCartPage=t.shouldFetchTaoBaoProductCashbackStatus=t.isProductActivatedByAiTaoBaoSearch=t.isReferrerTaoBaoCouponPage=t.isReferrerAiTaoBao=t.isReferrerHasValidSearchKeyParam=t.shouldDisplay=t.urlContainsAliTrackParam=t.isTaoBaoProductPage=t.getTaoBaoProductIds=t.getTaoBaoProducts=t.getTaoBaoProduct=t.isTaoBaoApiDown=t.isTaoBaoConfirmationNotifierOpened=t.isTaoBaoNotifierOpened=t.isTaoBaoSearchBoxOpened=t.getTaoBaoProductIdByUrl=t.getActivatedProductIdByTab=t.getTaoBaoShoppingCartPagePatterns=t.getTaoBaoProductPagePatterns=t.getTaoBaoApiSettings=t.getTaoBaoSettings=void 0;var e=r(17),i=function(n,t){return t.url},o=function(n,t){return t.referrer},u=function(n){return n.taoBao},a=t.getTaoBaoSettings=function(n){return n.settings.taoBao},c=(t.getTaoBaoApiSettings=function(n){return n.settings.taoBao.api},t.getTaoBaoProductPagePatterns=function(n){return n.settings.taoBao.productPagePatterns}),f=t.getTaoBaoShoppingCartPagePatterns=function(n){return n.settings.taoBao.shoppingCartPagePatterns},s=(t.getActivatedProductIdByTab=(0,e.createSelector)([u,function(n,t){return t.tabId}],function(n,t){return n.activatedProductIdInTab[t]}),t.getTaoBaoProductIdByUrl=(0,e.createSelector)([i],function(n){return new URL(n).searchParams.get("id")||""})),l=(t.isTaoBaoSearchBoxOpened=(0,e.createSelector)([u],function(n){return!!n.searchBoxOpened}),t.isTaoBaoNotifierOpened=(0,e.createSelector)([u],function(n){return!!n.notifierOpened}),t.isTaoBaoConfirmationNotifierOpened=(0,e.createSelector)([u],function(n){return!!n.confirmationNotifierOpened}),t.isTaoBaoApiDown=(0,e.createSelector)([u],function(n){return!!n.taoBaoApiDown}),t.getTaoBaoProduct=(0,e.createSelector)([u,s],function(n,t){return n.products[t]})),v=(t.getTaoBaoProducts=(0,e.createSelector)([u],function(n){return n.products}),t.getTaoBaoProductIds=(0,e.createSelector)([u],function(n){return Object.keys(n.products)}),t.isTaoBaoProductPage=(0,e.createSelector)([c,s,i],function(n,t,r){return!(!t||!n.some(function(n){return new RegExp(n).test(r)}))})),d=t.urlContainsAliTrackParam=(0,e.createSelector)([a,i],function(n,t){var r=new URL(t);return r.searchParams.has(n.aliTrackIdParamKey)&&r.searchParams.get(n.aliTrackIdParamKey).startsWith(n.aliTrackIdParamValue)}),p=(t.shouldDisplay=(0,e.createSelector)([function(n,t){return t.merchant}],function(n){return!(!n||!n.popup_enabled)}),t.isReferrerHasValidSearchKeyParam=(0,e.createSelector)([o],function(n){return!(!n||!new URL(n).searchParams.get("key"))})),h=t.isReferrerAiTaoBao=(0,e.createSelector)([a,o],function(n,t){return new RegExp(n.aiTaoBaoSearchPattern).test(t)}),_=t.isReferrerTaoBaoCouponPage=(0,e.createSelector)([a,o],function(n,t){return new RegExp(n.taoBaoCouponPageUrlPattern).test(t)}),b=t.isProductActivatedByAiTaoBaoSearch=(0,e.createSelector)([d,h,_,p],function(n,t,r,e){return!(!n||!(t&&e||r))});t.shouldFetchTaoBaoProductCashbackStatus=(0,e.createSelector)([v,l,b],function(n,t,r){return!(!n||t||r)}),t.isTaoBaoShoppingCartPage=(0,e.createSelector)([f,i],function(n,t){return n.some(function(n){return new RegExp(n).test(t)})}),t.getCloseTaoBaoNotifierAt=(0,e.createSelector)([u],function(n){return n.closeTaoBaoNotifierAt})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldFetchSettings=t.taoBaoLinkEnabled=t.couponsEnabled=t.ironGateEnabled=void 0;var e=r(17),i=r(0),o=function(n){return n.cc},u=function(n){return n.settings.serviceEnableCountry},a=(0,e.createSelector)([u],function(n){return n.ironGate}),c=(0,e.createSelector)([u],function(n){return n.coupons}),f=(0,e.createSelector)([u],function(n){return n.taoBaoLink});t.ironGateEnabled=(0,e.createSelector)([o,a],function(n,t){return t.some(function(t){return t.toUpperCase()===n.toUpperCase()})}),t.couponsEnabled=(0,e.createSelector)([o,c],function(n,t){return t.some(function(t){return t.toUpperCase()===n.toUpperCase()})}),t.taoBaoLinkEnabled=(0,e.createSelector)([o,f],function(n,t){return t.some(function(t){return t.toUpperCase()===n.toUpperCase()})}),t.shouldFetchSettings=(0,e.createSelector)([function(n){return n.settings},function(n,t){return t.now}],function(n,t){if(!n)return!0;var r=n.fetchedAt;return"number"!=typeof r||t-r>i.REFETCH_SETTING_INTERVAL_MS})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isLoggerEnabled=void 0;var e=r(17);t.isLoggerEnabled=(0,e.createSelector)([function(n){return n.extension}],function(n){return!!n.loggerEnabled})},function(n,t,r){var e=r(224),i=r(160),o=r(225),u=r(199),a=r(190),c=r(72),f=r(170),s=f(e),l=f(i),v=f(o),d=f(u),p=f(a),h=c;(e&&"[object DataView]"!=h(new e(new ArrayBuffer(1)))||i&&"[object Map]"!=h(new i)||o&&"[object Promise]"!=h(o.resolve())||u&&"[object Set]"!=h(new u)||a&&"[object WeakMap]"!=h(new a))&&(h=function(n){var t=c(n),r="[object Object]"==t?n.constructor:void 0,e=r?f(r):"";if(e)switch(e){case s:return"[object DataView]";case l:return"[object Map]";case v:return"[object Promise]";case d:return"[object Set]";case p:return"[object WeakMap]"}return t}),n.exports=h},,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendToSentry=void 0;var e,i=r(104),o=(e=i)&&e.__esModule?e:{default:e};t.sendToSentry=function(n){n instanceof Error?o.default.captureException(n):n instanceof Response&&o.default.captureMessage("Error : "+n.status+" "+n.statusText)}},function(n,t,r){(function(t){var e=r(115),i=r(71),o=r(116),u=r(117),a=r(55),c=a.isError,f=a.isObject,s=a.isPlainObject,l=a.isErrorEvent,v=a.isUndefined,d=a.isFunction,p=a.isString,h=a.isArray,_=a.isEmptyObject,b=a.each,E=a.objectMerge,O=a.truncate,y=a.objectFrozen,m=a.hasKey,T=a.joinRegExp,g=a.urlencode,I=a.uuid4,A=a.htmlTreeAsString,C=a.isSameException,S=a.isSameStacktrace,w=a.parseUrl,N=a.fill,R=a.supportsFetch,P=a.supportsReferrerPolicy,j=a.serializeKeysForMessage,k=a.serializeException,D=a.sanitize,M=r(118).wrapMethod,L="source protocol user pass host port path".split(" "),U=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function F(){return+new Date}var H="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},x=H.document,B=H.navigator;function G(n,t){return d(t)?function(r){return t(r,n)}:t}function V(){for(var n in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!v(x),this._hasNavigator=!v(B),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={release:H.SENTRY_RELEASE&&H.SENTRY_RELEASE.id,logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],headers:null,collectWindowErrors:!0,captureUnhandledRejections:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1,sanitizeKeys:[]},this._fetchDefaults={method:"POST",keepalive:!0,referrerPolicy:P()?"origin":""},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=H.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=F(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=H.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[n]=this._originalConsole[n]}V.prototype={VERSION:"3.24.1",debug:!1,TraceKit:e,config:function(n,t){var r=this;if(r._globalServer)return this._logDebug("error","Error: Raven has already been configured"),r;if(!n)return r;var i=r._globalOptions;t&&b(t,function(n,t){"tags"===n||"extra"===n||"user"===n?r._globalContext[n]=t:i[n]=t}),r.setDSN(n),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=T(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&T(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&T(i.whitelistUrls),i.includePaths=T(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var o={xhr:!0,console:!0,dom:!0,location:!0,sentry:!0},u=i.autoBreadcrumbs;"[object Object]"==={}.toString.call(u)?u=E(o,u):!1!==u&&(u=o),i.autoBreadcrumbs=u;var a={tryCatch:!0},c=i.instrument;return"[object Object]"==={}.toString.call(c)?c=E(a,c):!1!==c&&(c=a),i.instrument=c,e.collectWindowErrors=!!i.collectWindowErrors,r},install:function(){var n=this;return n.isSetup()&&!n._isRavenInstalled&&(e.report.subscribe(function(){n._handleOnErrorStackInfo.apply(n,arguments)}),n._globalOptions.captureUnhandledRejections&&n._attachPromiseRejectionHandler(),n._patchFunctionToString(),n._globalOptions.instrument&&n._globalOptions.instrument.tryCatch&&n._instrumentTryCatch(),n._globalOptions.autoBreadcrumbs&&n._instrumentBreadcrumbs(),n._drainPlugins(),n._isRavenInstalled=!0),Error.stackTraceLimit=n._globalOptions.stackTraceLimit,this},setDSN:function(n){var t=this._parseDSN(n),r=t.path.lastIndexOf("/"),e=t.path.substr(1,r);this._dsn=n,this._globalKey=t.user,this._globalSecret=t.pass&&t.pass.substr(1),this._globalProject=t.path.substr(r+1),this._globalServer=this._getGlobalServer(t),this._globalEndpoint=this._globalServer+"/"+e+"api/"+this._globalProject+"/store/",this._resetBackoff()},context:function(n,t,r){return d(n)&&(r=t||[],t=n,n=void 0),this.wrap(n,t).apply(this,r)},wrap:function(n,t,r){var e=this;if(v(t)&&!d(n))return n;if(d(n)&&(t=n,n=void 0),!d(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(n){return t}function i(){var i=[],o=arguments.length,u=!n||n&&!1!==n.deep;for(r&&d(r)&&r.apply(this,arguments);o--;)i[o]=u?e.wrap(n,arguments[o]):arguments[o];try{return t.apply(this,i)}catch(t){throw e._ignoreNextOnError(),e.captureException(t,n),t}}for(var o in t)m(t,o)&&(i[o]=t[o]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__orig__=t,i},uninstall:function(){return e.report.uninstall(),this._detachPromiseRejectionHandler(),this._unpatchFunctionToString(),this._restoreBuiltIns(),this._restoreConsole(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},_promiseRejectionHandler:function(n){this._logDebug("debug","Raven caught unhandled promise rejection:",n),this.captureException(n.reason,{extra:{unhandledPromiseRejection:!0}})},_attachPromiseRejectionHandler:function(){return this._promiseRejectionHandler=this._promiseRejectionHandler.bind(this),H.addEventListener&&H.addEventListener("unhandledrejection",this._promiseRejectionHandler),this},_detachPromiseRejectionHandler:function(){return H.removeEventListener&&H.removeEventListener("unhandledrejection",this._promiseRejectionHandler),this},captureException:function(n,t){if(t=E({trimHeadFrames:0},t||{}),l(n)&&n.error)n=n.error;else if(c(n))n=n;else{if(!s(n))return this.captureMessage(n,E(t,{stacktrace:!0,trimHeadFrames:t.trimHeadFrames+1}));t=this._getCaptureExceptionOptionsFromPlainObject(t,n),n=new Error(t.message)}this._lastCapturedException=n;try{var r=e.computeStackTrace(n);this._handleStackInfo(r,t)}catch(t){if(n!==t)throw t}return this},_getCaptureExceptionOptionsFromPlainObject:function(n,t){var r=Object.keys(t).sort(),e=E(n,{message:"Non-Error exception captured with keys: "+j(r),fingerprint:[o(r)],extra:n.extra||{}});return e.extra.__serialized__=k(t),e},captureMessage:function(n,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(n)){var r,i=E({message:n+=""},t=t||{});try{throw new Error(n)}catch(n){r=n}r.name=null;var o=e.computeStackTrace(r),u=h(o.stack)&&o.stack[1],a=u&&u.url||"";if((!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(a))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(a))){if(this._globalOptions.stacktrace||t&&t.stacktrace){i.fingerprint=null==i.fingerprint?n:i.fingerprint,(t=E({trimHeadFrames:0},t)).trimHeadFrames+=1;var c=this._prepareFrames(o,t);i.stacktrace={frames:c.reverse()}}return i.fingerprint&&(i.fingerprint=h(i.fingerprint)?i.fingerprint:[i.fingerprint]),this._send(i),this}}},captureBreadcrumb:function(n){var t=E({timestamp:F()/1e3},n);if(d(this._globalOptions.breadcrumbCallback)){var r=this._globalOptions.breadcrumbCallback(t);if(f(r)&&!_(r))t=r;else if(!1===r)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(n){var t=[].slice.call(arguments,1);return this._plugins.push([n,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(n){return this._globalContext.user=n,this},setExtraContext:function(n){return this._mergeContext("extra",n),this},setTagsContext:function(n){return this._mergeContext("tags",n),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(i(this._globalContext))},setEnvironment:function(n){return this._globalOptions.environment=n,this},setRelease:function(n){return this._globalOptions.release=n,this},setDataCallback:function(n){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=G(t,n),this},setBreadcrumbCallback:function(n){var t=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=G(t,n),this},setShouldSendCallback:function(n){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=G(t,n),this},setTransport:function(n){return this._globalOptions.transport=n,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var n=H.RavenConfig;n&&this.config(n.dsn,n.config).install()},showReportDialog:function(n){if(x){var t=(n=n||{}).eventId||this.lastEventId();if(!t)throw new u("Missing eventId");var r=n.dsn||this._dsn;if(!r)throw new u("Missing DSN");var e=encodeURIComponent,i="";i+="?eventId="+e(t),i+="&dsn="+e(r);var o=n.user||this._globalContext.user;o&&(o.name&&(i+="&name="+e(o.name)),o.email&&(i+="&email="+e(o.email)));var a=this._getGlobalServer(this._parseDSN(r)),c=x.createElement("script");c.async=!0,c.src=a+"/api/embed/error-page/"+i,(x.head||x.body).appendChild(c)}},_ignoreNextOnError:function(){var n=this;this._ignoreOnError+=1,setTimeout(function(){n._ignoreOnError-=1})},_triggerEvent:function(n,t){var r,e;if(this._hasDocument){for(e in t=t||{},n="raven"+n.substr(0,1).toUpperCase()+n.substr(1),x.createEvent?(r=x.createEvent("HTMLEvents")).initEvent(n,!0,!0):(r=x.createEventObject()).eventType=n,t)m(t,e)&&(r[e]=t[e]);if(x.createEvent)x.dispatchEvent(r);else try{x.fireEvent("on"+r.eventType.toLowerCase(),r)}catch(n){}}},_breadcrumbEventHandler:function(n){var t=this;return function(r){if(t._keypressTimeout=null,t._lastCapturedEvent!==r){var e;t._lastCapturedEvent=r;try{e=A(r.target)}catch(n){e="<unknown>"}t.captureBreadcrumb({category:"ui."+n,message:e})}}},_keypressEventHandler:function(){var n=this;return function(t){var r;try{r=t.target}catch(n){return}var e=r&&r.tagName;if(e&&("INPUT"===e||"TEXTAREA"===e||r.isContentEditable)){var i=n._keypressTimeout;i||n._breadcrumbEventHandler("input")(t),clearTimeout(i),n._keypressTimeout=setTimeout(function(){n._keypressTimeout=null},1e3)}}},_captureUrlChange:function(n,t){var r=w(this._location.href),e=w(t),i=w(n);this._lastHref=t,r.protocol===e.protocol&&r.host===e.host&&(t=e.relative),r.protocol===i.protocol&&r.host===i.host&&(n=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:n}})},_patchFunctionToString:function(){var n=this;n._originalFunctionToString=Function.prototype.toString,Function.prototype.toString=function(){return"function"==typeof this&&this.__raven__?n._originalFunctionToString.apply(this.__orig__,arguments):n._originalFunctionToString.apply(this,arguments)}},_unpatchFunctionToString:function(){this._originalFunctionToString&&(Function.prototype.toString=this._originalFunctionToString)},_instrumentTryCatch:function(){var n=this,t=n._wrappedBuiltIns;function r(t){return function(r,e){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var u=i[0];return d(u)&&(i[0]=n.wrap(u)),t.apply?t.apply(this,i):t(i[0],i[1])}}var e=this._globalOptions.autoBreadcrumbs;function i(r){var i=H[r]&&H[r].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(N(i,"addEventListener",function(t){return function(i,o,u,a){try{o&&o.handleEvent&&(o.handleEvent=n.wrap(o.handleEvent))}catch(n){}var c,f,s;return e&&e.dom&&("EventTarget"===r||"Node"===r)&&(f=n._breadcrumbEventHandler("click"),s=n._keypressEventHandler(),c=function(n){if(n){var t;try{t=n.type}catch(n){return}return"click"===t?f(n):"keypress"===t?s(n):void 0}}),t.call(this,i,n.wrap(o,void 0,c),u,a)}},t),N(i,"removeEventListener",function(n){return function(t,r,e,i){try{r=r&&(r.__raven_wrapper__?r.__raven_wrapper__:r)}catch(n){}return n.call(this,t,r,e,i)}},t))}N(H,"setTimeout",r,t),N(H,"setInterval",r,t),H.requestAnimationFrame&&N(H,"requestAnimationFrame",function(t){return function(r){return t(n.wrap(r))}},t);for(var o=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],u=0;u<o.length;u++)i(o[u])},_instrumentBreadcrumbs:function(){var n=this,t=this._globalOptions.autoBreadcrumbs,r=n._wrappedBuiltIns;function e(t,r){t in r&&d(r[t])&&N(r,t,function(t){return n.wrap(t)})}if(t.xhr&&"XMLHttpRequest"in H){var i=H.XMLHttpRequest&&H.XMLHttpRequest.prototype;N(i,"open",function(t){return function(r,e){return p(e)&&-1===e.indexOf(n._globalKey)&&(this.__raven_xhr={method:r,url:e,status_code:null}),t.apply(this,arguments)}},r),N(i,"send",function(t){return function(){var r=this;function i(){if(r.__raven_xhr&&4===r.readyState){try{r.__raven_xhr.status_code=r.status}catch(n){}n.captureBreadcrumb({type:"http",category:"xhr",data:r.__raven_xhr})}}for(var o=["onload","onerror","onprogress"],u=0;u<o.length;u++)e(o[u],r);return"onreadystatechange"in r&&d(r.onreadystatechange)?N(r,"onreadystatechange",function(t){return n.wrap(t,void 0,i)}):r.onreadystatechange=i,t.apply(this,arguments)}},r)}t.xhr&&R()&&N(H,"fetch",function(t){return function(){for(var r=new Array(arguments.length),e=0;e<r.length;++e)r[e]=arguments[e];var i,o=r[0],u="GET";if("string"==typeof o?i=o:"Request"in H&&o instanceof H.Request?(i=o.url,o.method&&(u=o.method)):i=""+o,-1!==i.indexOf(n._globalKey))return t.apply(this,r);r[1]&&r[1].method&&(u=r[1].method);var a={method:u,url:i,status_code:null};return t.apply(this,r).then(function(t){return a.status_code=t.status,n.captureBreadcrumb({type:"http",category:"fetch",data:a}),t})}},r),t.dom&&this._hasDocument&&(x.addEventListener?(x.addEventListener("click",n._breadcrumbEventHandler("click"),!1),x.addEventListener("keypress",n._keypressEventHandler(),!1)):x.attachEvent&&(x.attachEvent("onclick",n._breadcrumbEventHandler("click")),x.attachEvent("onkeypress",n._keypressEventHandler())));var o=H.chrome,u=!(o&&o.app&&o.app.runtime)&&H.history&&history.pushState&&history.replaceState;if(t.location&&u){var a=H.onpopstate;H.onpopstate=function(){var t=n._location.href;if(n._captureUrlChange(n._lastHref,t),a)return a.apply(this,arguments)};var c=function(t){return function(){var r=arguments.length>2?arguments[2]:void 0;return r&&n._captureUrlChange(n._lastHref,r+""),t.apply(this,arguments)}};N(history,"pushState",c,r),N(history,"replaceState",c,r)}if(t.console&&"console"in H&&console.log){var f=function(t,r){n.captureBreadcrumb({message:t,level:r.level,category:"console"})};b(["debug","info","warn","error","log"],function(n,t){M(console,t,f)})}},_restoreBuiltIns:function(){for(var n;this._wrappedBuiltIns.length;){var t=(n=this._wrappedBuiltIns.shift())[0],r=n[1],e=n[2];t[r]=e}},_restoreConsole:function(){for(var n in this._originalConsoleMethods)this._originalConsole[n]=this._originalConsoleMethods[n]},_drainPlugins:function(){var n=this;b(this._plugins,function(t,r){var e=r[0],i=r[1];e.apply(n,[n].concat(i))})},_parseDSN:function(n){var t=U.exec(n),r={},e=7;try{for(;e--;)r[L[e]]=t[e]||""}catch(t){throw new u("Invalid DSN: "+n)}if(r.pass&&!this._globalOptions.allowSecretKey)throw new u("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return r},_getGlobalServer:function(n){var t="//"+n.host+(n.port?":"+n.port:"");return n.protocol&&(t=n.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(n,t){var r=this._prepareFrames(n,t);this._triggerEvent("handle",{stackInfo:n,options:t}),this._processException(n.name,n.message,n.url,n.lineno,r,t)},_prepareFrames:function(n,t){var r=this,e=[];if(n.stack&&n.stack.length&&(b(n.stack,function(t,i){var o=r._normalizeFrame(i,n.url);o&&e.push(o)}),t&&t.trimHeadFrames))for(var i=0;i<t.trimHeadFrames&&i<e.length;i++)e[i].in_app=!1;return e=e.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(n,t){var r={filename:n.url,lineno:n.line,colno:n.column,function:n.func||"?"};return n.url||(r.filename=t),r.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(r.filename)||/(Raven|TraceKit)\./.test(r.function)||/raven\.(min\.)?js$/.test(r.filename)),r},_processException:function(n,t,r,e,i,o){var u,a=(n?n+": ":"")+(t||"");if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t)&&!this._globalOptions.ignoreErrors.test(a))&&(i&&i.length?(r=i[0].filename||r,i.reverse(),u={frames:i}):r&&(u={frames:[{filename:r,lineno:e,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(r))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(r)))){var c=E({exception:{values:[{type:n,value:t,stacktrace:u}]},culprit:r},o);this._send(c)}},_trimPacket:function(n){var t=this._globalOptions.maxMessageLength;if(n.message&&(n.message=O(n.message,t)),n.exception){var r=n.exception.values[0];r.value=O(r.value,t)}var e=n.request;return e&&(e.url&&(e.url=O(e.url,this._globalOptions.maxUrlLength)),e.Referer&&(e.Referer=O(e.Referer,this._globalOptions.maxUrlLength))),n.breadcrumbs&&n.breadcrumbs.values&&this._trimBreadcrumbs(n.breadcrumbs),n},_trimBreadcrumbs:function(n){for(var t,r,e,i=["to","from","url"],o=0;o<n.values.length;++o)if((r=n.values[o]).hasOwnProperty("data")&&f(r.data)&&!y(r.data)){e=E({},r.data);for(var u=0;u<i.length;++u)t=i[u],e.hasOwnProperty(t)&&e[t]&&(e[t]=O(e[t],this._globalOptions.maxUrlLength));n.values[o].data=e}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var n={};return this._hasNavigator&&B.userAgent&&(n.headers={"User-Agent":navigator.userAgent}),H.location&&H.location.href&&(n.url=H.location.href),this._hasDocument&&x.referrer&&(n.headers||(n.headers={}),n.headers.Referer=x.referrer),n}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&F()-this._backoffStart<this._backoffDuration},_isRepeatData:function(n){var t=this._lastData;return!(!t||n.message!==t.message||n.culprit!==t.culprit)&&(n.stacktrace||t.stacktrace?S(n.stacktrace,t.stacktrace):!n.exception&&!t.exception||C(n.exception,t.exception))},_setBackoffState:function(n){if(!this._shouldBackoff()){var t=n.status;if(400===t||401===t||429===t){var r;try{r=R()?n.headers.get("Retry-After"):n.getResponseHeader("Retry-After"),r=1e3*parseInt(r,10)}catch(n){}this._backoffDuration=r||(2*this._backoffDuration||1e3),this._backoffStart=F()}}},_send:function(n){var t=this._globalOptions,r={project:this._globalProject,logger:t.logger,platform:"javascript"},e=this._getHttpData();e&&(r.request=e),n.trimHeadFrames&&delete n.trimHeadFrames,(n=E(r,n)).tags=E(E({},this._globalContext.tags),n.tags),n.extra=E(E({},this._globalContext.extra),n.extra),n.extra["session:duration"]=F()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(n.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),this._globalContext.user&&(n.user=this._globalContext.user),t.environment&&(n.environment=t.environment),t.release&&(n.release=t.release),t.serverName&&(n.server_name=t.serverName),n=this._sanitizeData(n),Object.keys(n).forEach(function(t){(null==n[t]||""===n[t]||_(n[t]))&&delete n[t]}),d(t.dataCallback)&&(n=t.dataCallback(n)||n),n&&!_(n)&&(d(t.shouldSendCallback)&&!t.shouldSendCallback(n)||(this._shouldBackoff()?this._logDebug("warn","Raven dropped error due to backoff: ",n):"number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(n):this._sendProcessedPayload(n)))},_sanitizeData:function(n){return D(n,this._globalOptions.sanitizeKeys)},_getUuid:function(){return I()},_sendProcessedPayload:function(n,t){var r=this,e=this._globalOptions;if(this.isSetup())if(n=this._trimPacket(n),this._globalOptions.allowDuplicates||!this._isRepeatData(n)){this._lastEventId=n.event_id||(n.event_id=this._getUuid()),this._lastData=n,this._logDebug("debug","Raven about to send:",n);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var o=n.exception&&n.exception.values[0];this._globalOptions.autoBreadcrumbs&&this._globalOptions.autoBreadcrumbs.sentry&&this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:n.message,event_id:n.event_id,level:n.level||"error"});var u=this._globalEndpoint;(e.transport||this._makeRequest).call(this,{url:u,auth:i,data:n,options:e,onSuccess:function(){r._resetBackoff(),r._triggerEvent("success",{data:n,src:u}),t&&t()},onError:function(e){r._logDebug("error","Raven transport failed to send: ",e),e.request&&r._setBackoffState(e.request),r._triggerEvent("failure",{data:n,src:u}),e=e||new Error("Raven send failed (no additional details provided)"),t&&t(e)}})}else this._logDebug("warn","Raven dropped repeat event: ",n)},_makeRequest:function(n){var t=n.url+"?"+g(n.auth),r=null,e={};if(n.options.headers&&(r=this._evaluateHash(n.options.headers)),n.options.fetchParameters&&(e=this._evaluateHash(n.options.fetchParameters)),R()){e.body=i(n.data);var o=E({},this._fetchDefaults),u=E(o,e);return r&&(u.headers=r),H.fetch(t,u).then(function(t){if(t.ok)n.onSuccess&&n.onSuccess();else{var r=new Error("Sentry error code: "+t.status);r.request=t,n.onError&&n.onError(r)}}).catch(function(){n.onError&&n.onError(new Error("Sentry error code: network unavailable"))})}var a=H.XMLHttpRequest&&new H.XMLHttpRequest;a&&(("withCredentials"in a||"undefined"!=typeof XDomainRequest)&&("withCredentials"in a?a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)n.onSuccess&&n.onSuccess();else if(n.onError){var t=new Error("Sentry error code: "+a.status);t.request=a,n.onError(t)}}:(a=new XDomainRequest,t=t.replace(/^https?:/,""),n.onSuccess&&(a.onload=n.onSuccess),n.onError&&(a.onerror=function(){var t=new Error("Sentry error code: XDomainRequest");t.request=a,n.onError(t)})),a.open("POST",t),r&&b(r,function(n,t){a.setRequestHeader(n,t)}),a.send(i(n.data))))},_evaluateHash:function(n){var t={};for(var r in n)if(n.hasOwnProperty(r)){var e=n[r];t[r]="function"==typeof e?e():e}return t},_logDebug:function(n){this._originalConsoleMethods[n]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[n],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(n,t){v(t)?delete this._globalContext[n]:this._globalContext[n]=E(this._globalContext[n]||{},t)}},V.prototype.setUser=V.prototype.setUserContext,V.prototype.setReleaseContext=V.prototype.setRelease,n.exports=V}).call(t,r(20))},function(n,t,r){(function(t){var e=r(55),i={collectWindowErrors:!0,debug:!1},o="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},u=[].slice,a="?",c=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function f(){return"undefined"==typeof document||null==document.location?"":document.location.href}i.report=function(){var n,t,r=[],s=null,l=null,v=null;function d(n,t){var e=null;if(!t||i.collectWindowErrors){for(var o in r)if(r.hasOwnProperty(o))try{r[o].apply(null,[n].concat(u.call(arguments,2)))}catch(n){e=n}if(e)throw e}}function p(t,r,o,u,s){var l=e.isErrorEvent(s)?s.error:s,p=e.isErrorEvent(t)?t.message:t;if(v)i.computeStackTrace.augmentStackTraceWithInitialElement(v,r,o,p),h();else if(l&&e.isError(l))d(i.computeStackTrace(l),!0);else{var _,b={url:r,line:o,column:u},E=void 0;if("[object String]"==={}.toString.call(p))(_=p.match(c))&&(E=_[1],p=_[2]);b.func=a,d({name:E,message:p,url:f(),stack:[b]},!0)}return!!n&&n.apply(this,arguments)}function h(){var n=v,t=s;s=null,v=null,l=null,d.apply(null,[n,!1].concat(t))}function _(n,t){var r=u.call(arguments,1);if(v){if(l===n)return;h()}var e=i.computeStackTrace(n);if(v=e,l=n,s=r,setTimeout(function(){l===n&&h()},e.incomplete?2e3:0),!1!==t)throw n}return _.subscribe=function(e){t||(n=o.onerror,o.onerror=p,t=!0),r.push(e)},_.unsubscribe=function(n){for(var t=r.length-1;t>=0;--t)r[t]===n&&r.splice(t,1)},_.uninstall=function(){t&&(o.onerror=n,t=!1,n=void 0),r=[]},_}(),i.computeStackTrace=function(){function n(n){if(void 0!==n.stack&&n.stack){for(var t,r,e,i=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,u=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,c=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,s=/\((\S*)(?::(\d+))(?::(\d+))\)/,l=n.stack.split("\n"),v=[],d=(/^(.*) is undefined$/.exec(n.message),0),p=l.length;d<p;++d){if(r=i.exec(l[d])){var h=r[2]&&0===r[2].indexOf("native");r[2]&&0===r[2].indexOf("eval")&&(t=s.exec(r[2]))&&(r[2]=t[1],r[3]=t[2],r[4]=t[3]),e={url:h?null:r[2],func:r[1]||a,args:h?[r[2]]:[],line:r[3]?+r[3]:null,column:r[4]?+r[4]:null}}else if(r=o.exec(l[d]))e={url:r[2],func:r[1]||a,args:[],line:+r[3],column:r[4]?+r[4]:null};else{if(!(r=u.exec(l[d])))continue;r[3]&&r[3].indexOf(" > eval")>-1&&(t=c.exec(r[3]))?(r[3]=t[1],r[4]=t[2],r[5]=null):0!==d||r[5]||void 0===n.columnNumber||(v[0].column=n.columnNumber+1),e={url:r[3],func:r[1]||a,args:r[2]?r[2].split(","):[],line:r[4]?+r[4]:null,column:r[5]?+r[5]:null}}!e.func&&e.line&&(e.func=a),v.push(e)}return v.length?{name:n.name,message:n.message,url:f(),stack:v}:null}}function t(n,t,r,e){var i={url:t,line:r};if(i.url&&i.line){if(n.incomplete=!1,i.func||(i.func=a),n.stack.length>0&&n.stack[0].url===i.url){if(n.stack[0].line===i.line)return!1;if(!n.stack[0].line&&n.stack[0].func===i.func)return n.stack[0].line=i.line,!1}return n.stack.unshift(i),n.partial=!0,!0}return n.incomplete=!0,!1}function r(n,o){for(var u,c,s=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,l=[],v={},d=!1,p=r.caller;p&&!d;p=p.caller)if(p!==e&&p!==i.report){if(c={url:null,func:a,line:null,column:null},p.name?c.func=p.name:(u=s.exec(p.toString()))&&(c.func=u[1]),void 0===c.func)try{c.func=u.input.substring(0,u.input.indexOf("{"))}catch(n){}v[""+p]?d=!0:v[""+p]=!0,l.push(c)}o&&l.splice(0,o);var h={name:n.name,message:n.message,url:f(),stack:l};return t(h,n.sourceURL||n.fileName,n.line||n.lineNumber,n.message||n.description),h}function e(t,e){var o=null;e=null==e?0:+e;try{if(o=n(t))return o}catch(n){if(i.debug)throw n}try{if(o=r(t,e+1))return o}catch(n){if(i.debug)throw n}return{name:t.name,message:t.message,url:f()}}return e.augmentStackTraceWithInitialElement=t,e.computeStackTraceFromStackProp=n,e}(),n.exports=i}).call(t,r(20))},function(n,t){function r(n,t){var r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}function e(n,t,e,i,o,u){return r((a=r(r(t,n),r(i,u)))<<(c=o)|a>>>32-c,e);var a,c}function i(n,t,r,i,o,u,a){return e(t&r|~t&i,n,t,o,u,a)}function o(n,t,r,i,o,u,a){return e(t&i|r&~i,n,t,o,u,a)}function u(n,t,r,i,o,u,a){return e(t^r^i,n,t,o,u,a)}function a(n,t,r,i,o,u,a){return e(r^(t|~i),n,t,o,u,a)}function c(n,t){var e,c,f,s,l;n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;var v=1732584193,d=-271733879,p=-1732584194,h=271733878;for(e=0;e<n.length;e+=16)c=v,f=d,s=p,l=h,d=a(d=a(d=a(d=a(d=u(d=u(d=u(d=u(d=o(d=o(d=o(d=o(d=i(d=i(d=i(d=i(d,p=i(p,h=i(h,v=i(v,d,p,h,n[e],7,-680876936),d,p,n[e+1],12,-389564586),v,d,n[e+2],17,606105819),h,v,n[e+3],22,-1044525330),p=i(p,h=i(h,v=i(v,d,p,h,n[e+4],7,-176418897),d,p,n[e+5],12,1200080426),v,d,n[e+6],17,-1473231341),h,v,n[e+7],22,-45705983),p=i(p,h=i(h,v=i(v,d,p,h,n[e+8],7,1770035416),d,p,n[e+9],12,-1958414417),v,d,n[e+10],17,-42063),h,v,n[e+11],22,-1990404162),p=i(p,h=i(h,v=i(v,d,p,h,n[e+12],7,1804603682),d,p,n[e+13],12,-40341101),v,d,n[e+14],17,-1502002290),h,v,n[e+15],22,1236535329),p=o(p,h=o(h,v=o(v,d,p,h,n[e+1],5,-165796510),d,p,n[e+6],9,-1069501632),v,d,n[e+11],14,643717713),h,v,n[e],20,-373897302),p=o(p,h=o(h,v=o(v,d,p,h,n[e+5],5,-701558691),d,p,n[e+10],9,38016083),v,d,n[e+15],14,-660478335),h,v,n[e+4],20,-405537848),p=o(p,h=o(h,v=o(v,d,p,h,n[e+9],5,568446438),d,p,n[e+14],9,-1019803690),v,d,n[e+3],14,-187363961),h,v,n[e+8],20,1163531501),p=o(p,h=o(h,v=o(v,d,p,h,n[e+13],5,-1444681467),d,p,n[e+2],9,-51403784),v,d,n[e+7],14,1735328473),h,v,n[e+12],20,-1926607734),p=u(p,h=u(h,v=u(v,d,p,h,n[e+5],4,-378558),d,p,n[e+8],11,-2022574463),v,d,n[e+11],16,1839030562),h,v,n[e+14],23,-35309556),p=u(p,h=u(h,v=u(v,d,p,h,n[e+1],4,-1530992060),d,p,n[e+4],11,1272893353),v,d,n[e+7],16,-155497632),h,v,n[e+10],23,-1094730640),p=u(p,h=u(h,v=u(v,d,p,h,n[e+13],4,681279174),d,p,n[e],11,-358537222),v,d,n[e+3],16,-722521979),h,v,n[e+6],23,76029189),p=u(p,h=u(h,v=u(v,d,p,h,n[e+9],4,-640364487),d,p,n[e+12],11,-421815835),v,d,n[e+15],16,530742520),h,v,n[e+2],23,-995338651),p=a(p,h=a(h,v=a(v,d,p,h,n[e],6,-198630844),d,p,n[e+7],10,1126891415),v,d,n[e+14],15,-1416354905),h,v,n[e+5],21,-57434055),p=a(p,h=a(h,v=a(v,d,p,h,n[e+12],6,1700485571),d,p,n[e+3],10,-1894986606),v,d,n[e+10],15,-1051523),h,v,n[e+1],21,-2054922799),p=a(p,h=a(h,v=a(v,d,p,h,n[e+8],6,1873313359),d,p,n[e+15],10,-30611744),v,d,n[e+6],15,-1560198380),h,v,n[e+13],21,1309151649),p=a(p,h=a(h,v=a(v,d,p,h,n[e+4],6,-145523070),d,p,n[e+11],10,-1120210379),v,d,n[e+2],15,718787259),h,v,n[e+9],21,-343485551),v=r(v,c),d=r(d,f),p=r(p,s),h=r(h,l);return[v,d,p,h]}function f(n){var t,r="",e=32*n.length;for(t=0;t<e;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function s(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t<e;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function l(n){var t,r,e="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),e+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return e}function v(n){return unescape(encodeURIComponent(n))}function d(n){return function(n){return f(c(s(n),8*n.length))}(v(n))}function p(n,t){return function(n,t){var r,e,i=s(n),o=[],u=[];for(o[15]=u[15]=void 0,i.length>16&&(i=c(i,8*n.length)),r=0;r<16;r+=1)o[r]=909522486^i[r],u[r]=1549556828^i[r];return e=c(o.concat(s(t)),512+8*t.length),f(c(u.concat(e),640))}(v(n),v(t))}n.exports=function(n,t,r){return t?r?p(t,n):l(p(t,n)):r?d(n):l(d(n))}},function(n,t){function r(n){this.name="RavenConfigError",this.message=n}r.prototype=new Error,r.prototype.constructor=r,n.exports=r},function(n,t,r){var e=r(55);n.exports={wrapMethod:function(n,t,r){var i=n[t],o=n;if(t in n){var u="warn"===t?"warning":t;n[t]=function(){var n=[].slice.call(arguments),a=e.safeJoin(n," "),c={level:u,logger:"console",extra:{arguments:n}};"assert"===t?!1===n[0]&&(a="Assertion failed: "+(e.safeJoin(n.slice(1)," ")||"console.assert"),c.extra.arguments=n.slice(1),r&&r(a,c)):r&&r(a,c),i&&Function.prototype.apply.call(i,o,n)}}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findLoginHistory=t.isLogoutAllSBAccount=t.isLoginByCC=t.isLoggedIn=void 0;var e=r(17),i=r(0),o=function(n){return n.user},u=function(n,t){return t.cc};t.isLoggedIn=(0,e.createSelector)([o],function(n){return!!n.token}),t.isLoginByCC=(0,e.createSelector)([o,u],function(n,t){return!!n.loginHistories[t]}),t.isLogoutAllSBAccount=(0,e.createSelector)([u],function(n){return n===i.DEFAULT_COUNTRY}),t.findLoginHistory=(0,e.createSelector)([o,u],function(n,t){return n.loginHistories[t]})},,,function(n,t,r){var e=r(126),i=1/0;n.exports=function(n){if("string"==typeof n||e(n))return n;var t=n+"";return"0"==t&&1/n==-i?"-0":t}},function(n,t,r){var e=r(220),i=r(57),o=Object.prototype,u=o.hasOwnProperty,a=o.propertyIsEnumerable,c=e(function(){return arguments}())?e:function(n){return i(n)&&u.call(n,"callee")&&!a.call(n,"callee")};n.exports=c},function(n,t,r){(function(n){var e=r(30),i=r(221),o="object"==typeof t&&t&&!t.nodeType&&t,u=o&&"object"==typeof n&&n&&!n.nodeType&&n,a=u&&u.exports===o?e.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;n.exports=c}).call(t,r(168)(n))},function(n,t){var r=Object.prototype;n.exports=function(n){var t=n&&n.constructor;return n===("function"==typeof t&&t.prototype||r)}},function(n,t,r){var e=r(72),i=r(57),o="[object Symbol]";n.exports=function(n){return"symbol"==typeof n||i(n)&&e(n)==o}},,,,,,,,,,,,,,,,,,,,,,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YYYYMMDD=t.toSBFormat=void 0;var e,i=r(1),o=(e=i)&&e.__esModule?e:{default:e};function u(n){return(n<10?"0":"")+n}t.toSBFormat=function(n){if(!(n instanceof Date))throw new Error("Invalid Date object");return n.getUTCFullYear()+"-"+u(n.getUTCMonth()+1)+"-"+u(n.getUTCDate())+" "+u(n.getUTCHours())+":"+u(n.getUTCMinutes())+":"+u(n.getUTCSeconds())},t.YYYYMMDD=function(n){return(0,o.default)(n).format("L")}},function(n,t,r){var e=r(261),i=r(262),o=r(263),u=r(264),a=r(265);function c(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}c.prototype.clear=e,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=u,c.prototype.set=a,n.exports=c},function(n,t,r){var e=r(181);n.exports=function(n,t){for(var r=n.length;r--;)if(e(n[r][0],t))return r;return-1}},function(n,t,r){var e=r(68)(Object,"create");n.exports=e},function(n,t,r){var e=r(279);n.exports=function(n,t){var r=n.__data__;return e(t)?r["string"==typeof t?"string":"hash"]:r.map}},function(n,t){var r=9007199254740991;n.exports=function(n){return"number"==typeof n&&n>-1&&n%1==0&&n<=r}},,,function(n,t,r){"use strict";(function(n){n.browser||(n.browser=r(196))}).call(t,r(20))},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.closeTab=t.uiOpenNewTab=t.openNewTab=void 0;var e=r(0);t.openNewTab=function(n){var t=n.openUrl,r=n.active,i=n.autoClose,o=void 0===i||i;return function(n){return browser.tabs.create({active:r,url:t}).then(function(t){return!!o&&n({type:e.OPEN_NEW_TAB,payload:{tabId:t.id}})})}},t.uiOpenNewTab=function(n){var t=n.openUrl,r=n.active,i=n.autoClose,o=void 0===i||i;return{type:e.OPEN_NEW_TAB,openUrl:t,active:r,autoClose:o}},t.closeTab=function(n){var t=n.tabId;return function(n){return browser.tabs.remove(t).then(function(){return n({type:e.CLOSE_TAB,payload:{tabId:t}})})}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyDiscounts=function(n){var t=n.merchantId,r=n.tabId;return{type:o.APPLY_DISCOUNTS,payload:{merchantId:t,tabId:r}}},t.uiApplyDiscounts=function(n){var t=n.merchantId,r=n.tabId;return{type:o.APPLY_DISCOUNTS,merchantId:t,tabId:r}},t.finishApplyDiscounts=function(n){var t=n.tabId;return{type:o.FINISH_APPLY_DISCOUNTS,payload:{tabId:t}}},t.uiFinishApplyDiscounts=function(n){var t=n.tabId;return{type:o.FINISH_APPLY_DISCOUNTS,tabId:t}},t.changeCouponCodeApplyStatus=function(n){var t=n.tabId,r=n.couponCode,e=n.applyStatus;return{type:o.COUPON_CHANGE_CODE_APPLY_STATUS,payload:{tabId:t,couponCode:r,applyStatus:e}}},t.uiChangeCouponCodeApplyStatus=function(n){var t=n.tabId,r=n.couponCode,e=n.applyStatus;return{type:o.COUPON_CHANGE_CODE_APPLY_STATUS,tabId:t,couponCode:r,applyStatus:e}},t.setBestPriceAndCode=function(n){var t=n.tabId,r=n.bestPrice,e=n.bestCode;return{type:o.SET_BEST_PRICE_AND_CODE,payload:{tabId:t,bestPrice:r,bestCode:e}}},t.uiSetBestPriceAndCode=function(n){var t=n.tabId,r=n.bestPrice,e=n.bestCode;return{type:o.SET_BEST_PRICE_AND_CODE,tabId:t,bestPrice:r,bestCode:e}},t.setOriginalPrice=function(n){var t=n.tabId,r=n.originalPrice;return{type:o.SET_ORIGINAL_PRICE,payload:{tabId:t,originalPrice:r}}},t.uiSetOriginalPrice=function(n){var t=n.tabId,r=n.originalPrice;return{type:o.SET_ORIGINAL_PRICE,tabId:t,originalPrice:r}},t.openCouponNotifier=function(n){var t=n.merchantId;return{type:o.COUPON_OPEN_NOTIFIER,payload:{merchantId:t}}},t.uiOpenCouponNotifier=function(n){var t=n.merchantId;return{type:o.COUPON_OPEN_NOTIFIER,merchantId:t}},t.closeCouponNotifier=function(n){var t=n.merchantId;return{type:o.COUPON_CLOSE_NOTIFIER,payload:{merchantId:t}}},t.uiCloseCouponNotifier=function(n){var t=n.merchantId;return{type:o.COUPON_CLOSE_NOTIFIER,merchantId:t}},t.openApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_OPEN_APPLY_RESULT,payload:{tabId:t}}},t.uiOpenApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_OPEN_APPLY_RESULT,tabId:t}},t.closeApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_CLOSE_APPLY_RESULT,payload:{tabId:t}}},t.uiCloseApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_CLOSE_APPLY_RESULT,tabId:t}},t.openIntermediateApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_OPEN_INTERMEDIATE_APPLY_RESULT,payload:{tabId:t}}},t.uiOpenIntermediateApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_OPEN_INTERMEDIATE_APPLY_RESULT,tabId:t}},t.closeIntermediateApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT,payload:{tabId:t}}},t.uiCloseIntermediateApplyResult=function(n){var t=n.tabId;return{type:o.COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT,tabId:t}},t.closeApplier=function(n){var t=n.merchantId,r=n.tabId;return{type:o.COUPON_CLOSE_APPLIER,payload:{merchantId:t,tabId:r}}},t.uiCloseApplier=function(n){var t=n.merchantId,r=n.tabId;return{type:o.COUPON_CLOSE_APPLIER,merchantId:t,tabId:r}},t.saveDeletedCouponMerchant=a,t.fetchCouponsByMerchantSuccess=c,t.fetchCouponsByMerchant=function(n){var t=n.merchantId,r=n.tabId,f={retryOnHttpStatus:[500,502,503,504]};return function(n,s){return(0,e.fetchWithRetry)((0,i.getCouponsByMerchantAPI)(t,s().cc),f).then(function(n){return n.json()}).then(function(e){null===e.data?n(a({merchantId:t})):(n(c({tabId:r,couponMerchant:e.data})),browser.tabs.sendMessage(r,{action:o.FETCH_COUPONS_BY_MERCHANT_SUCCESS,tabId:r}))}).catch(function(t){var r=t.message;n((0,u.apiError)({errorType:o.FETCH_COUPONS_BY_MERCHANT_ERROR,message:r}))})}},t.uiFetchCouponsByMerchant=function(n){var t=n.merchantId,r=n.tabId;return{type:o.FETCH_COUPONS_BY_MERCHANT,merchantId:t,tabId:r}},t.fetchTrendingCouponsSuccess=f,t.fetchTrendingCoupons=function(){var n={retryOnHttpStatus:[500,502,503,504]};return function(t,r){return(0,e.fetchWithRetry)((0,i.getTrendingCouponsAPI)(r().cc),n).then(function(n){return n.json()}).then(function(n){t(f({trendingCouponCodes:n.data||[]}))}).catch(function(n){var r=n.message;t((0,u.apiError)({errorType:o.FETCH_TRENDING_COUPONS_ERROR,message:r}))})}},t.uifetchTrendingCoupons=function(){return{type:o.FETCH_TRENDING_COUPONS}},t.openMenuApplyCodeBtn=function(n){var t=n.merchantId;return{type:o.OPEN_MENU_APPLY_CODE_BTN,payload:{merchantId:t}}},t.uiOpenMenuApplyCodeBtn=function(n){var t=n.merchantId;return{type:o.OPEN_MENU_APPLY_CODE_BTN,merchantId:t}},t.closeMenuApplyCodeBtn=function(n){var t=n.merchantId;return{type:o.CLOSE_MENU_APPLY_CODE_BTN,payload:{merchantId:t}}},t.uiCloseMenuApplyCodeBtn=function(n){var t=n.merchantId;return{type:o.CLOSE_MENU_APPLY_CODE_BTN,merchantId:t}},t.disappearCouponNotifier=function(n){var t=n.merchantId,r=60*o.COUPON_DISAPPEAR_NOTIFIER_HOUR*60*1e3;return{type:o.COUPON_DISAPPEAR_NOTIFIER,payload:{merchantId:t,disappearNotifierSeconds:Math.trunc((new Date).getTime()+r)}}},t.uiDisappearCouponNotifier=function(n){var t=n.merchantId;return{type:o.COUPON_DISAPPEAR_NOTIFIER,merchantId:t}},t.changeApplyDiscountsStatus=function(n){var t=n.tabId,r=n.applyDiscountsStatus;return{type:o.COUPON_CHANGE_APPLY_DISCOUNTS_STATUS,payload:{tabId:t,applyDiscountsStatus:r}}},t.uiChangeApplyDiscountsStatus=function(n){var t=n.tabId,r=n.applyDiscountsStatus;return{type:o.COUPON_CHANGE_APPLY_DISCOUNTS_STATUS,tabId:t,applyDiscountsStatus:r}},t.clearCoupons=function(){return{type:o.CLEAR_COUPONS}},t.initializeApplyingMetaDataSuccess=s,t.initializeApplyingMetaData=function(n){var t=n.merchantId,r=n.tabId;return function(n){n(s({merchantId:t,tabId:r})),browser.tabs.sendMessage(r,{action:o.INITIALIZE_APPLYING_META_DATA_SUCCESS,tabId:r})}},t.uiInitializeApplyingMetaData=function(n){var t=n.merchantId,r=n.tabId;return{type:o.INITIALIZE_APPLYING_META_DATA,merchantId:t,tabId:r}},t.clearApplyingMetaData=function(n){var t=n.tabId;return{type:o.CLEAR_APPLYING_META_DATA,payload:{tabId:t}}},t.patchCouponStatsSuccess=l,t.patchCouponStats=function(n){var t=n.couponId,r=n.lastAppliedDate,a={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({lastAppliedDate:r}),retryOnHttpStatus:[500,502,503,504]};return function(n,r){return(0,e.fetchWithRetry)((0,i.patchCouponStatsAPI)(r().cc,t),a).then(function(){return n(l())}).catch(function(t){var r=t.message;n((0,u.apiError)({errorType:o.PATCH_COUPON_STATS_ERROR,message:r}))})}},t.uiPatchCouponStats=function(n){var t=n.couponId,r=n.lastAppliedDate;return{type:o.PATCH_COUPON_STATS,couponId:t,lastAppliedDate:r}};var e=r(63),i=r(19),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(102)),u=r(45);function a(n){var t=n.merchantId;return{type:o.SAVE_NON_COUPON_MERCHANT,payload:{merchantId:t}}}function c(n){var t=n.couponMerchant,r=n.tabId;return{type:o.FETCH_COUPONS_BY_MERCHANT_SUCCESS,payload:{couponMerchant:t,tabId:r}}}function f(n){var t=n.trendingCouponCodes;return{type:o.FETCH_TRENDING_COUPONS_SUCCESS,payload:{trendingCouponCodes:t}}}function s(n){var t=n.merchantId,r=n.tabId;return{type:o.INITIALIZE_APPLYING_META_DATA_SUCCESS,payload:{merchantId:t,tabId:r}}}function l(){return{type:o.PATCH_COUPON_STATS_SUCCESS}}},function(n,t,r){var e=r(68)(r(30),"Map");n.exports=e},function(n,t,r){var e=r(72),i=r(76),o="[object AsyncFunction]",u="[object Function]",a="[object GeneratorFunction]",c="[object Proxy]";n.exports=function(n){if(!i(n))return!1;var t=e(n);return t==u||t==a||t==o||t==c}},function(n,t,r){var e=r(222),i=r(172),o=r(173),u=o&&o.isTypedArray,a=u?i(u):e;n.exports=a},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isProductFetchedFromTaoBao=t.getProductListMap=t.getCartIdByProductListElem=t.getProductIdByProductLinkElem=t.getProductInfoElem=t.getProductLinkElem=t.redirectToDeepLink=t.getTaoBaoProductDeepLink=t.taoBaoProductHasCashback=void 0;var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(206),a=r(45),c=r(43),f=r(108),s=r(149),l=r(63),v=r(0);var d=function(n,t){return n&&Object.prototype.hasOwnProperty.call(n,"results")&&Object.keys(n.results).length>0&&Object.prototype.hasOwnProperty.call(n.results,t)&&Array.isArray(n.results[t])&&n.results[t].length>0},p=function(n){var t=n.error_response;return t?Promise.reject({message:t.sub_code}):Promise.resolve(n)},h=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.DEFAULT_COUNTRY,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=r.method.replace(/^taobao\./,"").replace(/\./g,"_")+"_response",i=n.appKey[t],a=n.appSecret[t],c=n.adzoneId[t],f=(0,o.default)({},n.methods.common.params,r,{timestamp:(0,s.toSBFormat)(new Date),app_key:i,adzone_id:c});f.sign=function(n,t){var r="";return Object.keys(t).sort().forEach(function(n){var e=t[n];r+=n+e}),r=""+n+r+n,(0,u.MD5)(r).toString().toUpperCase()}(a,f);var d=new URL(n.url);Object.keys(f).forEach(function(n){var t=f[n];d.searchParams.set(n,t)});var h={method:n.httpMethod,headers:{"Content-Type":n.contentType},body:d.searchParams};return(0,l.fetchWithRetry)(n.url,h).then(function(n){return n.json()}).then(p).then(function(n){return n[e]}).catch(function(n){return Promise.reject({message:n.message})})},_=(t.taoBaoProductHasCashback=function(n,t,r){return h(r,t.toLowerCase(),(0,o.default)({},r.methods.getCashBackStatus.params,{num_iids:n})).then(function(n){var t=r.methods.getCashBackStatus.resultKey;return d(n,t)&&n.results[t][0]&&n.results[t][0].material_lib_type&&v.TAOBAO_MATERIAL_LIB_TYPE_HAS_CASHBACK.includes(n.results[t][0].material_lib_type)}).catch(function(n){return n.message!==r.methods.getCashBackStatus.errorCodes.noResult&&n.message!==r.methods.getCashBackStatus.errorCodes.rateLimitExceeded&&n.message!==r.methods.getCashBackStatus.errorCodes.internalError&&Promise.reject({message:n.message})})},t.getTaoBaoProductDeepLink=function(n,t,r){return h(r,t.toLowerCase(),(0,o.default)({},r.methods.getDeepLink.params,{num_iids:n})).then(function(n){var t=r.methods.getDeepLink.resultKey;return d(n,t)&&n.results[t][0].click_url?n.results[t][0].click_url:""}).catch(function(n){return Promise.reject({message:n.message})})},t.redirectToDeepLink=function(n,t,r){var e=n.getState(),i=(0,c.matchMerchant)(e,{url:t}),o=(0,f.getActivatedProductIdByTab)(e,{tabId:r});if(i&&i.isTaobao&&o){var u=(0,f.getTaoBaoSettings)(e).aiTaoBaoSearchPattern;if(!new RegExp(u).test(t))return!1;var s=new URL(t).searchParams.get("unid");if(!s)return!1;var l=e.taoBao.products[o];if(!l)return!1;if(l.activateState!==v.ACTIVATE_STATE_ACTIVATING)return!1;if(l.redirectedToDeepLink)return!1;if(!l.deepLink)return!1;n.dispatch((0,a.uiDeepLinkRedirect)({productId:o,tabId:r}));var d=new URL(l.deepLink);return d.searchParams.append("unid",s),window.location.replace(d.href),!0}return!1},t.getProductLinkElem=function(n,t){return n.querySelector(t)}),b=t.getProductInfoElem=function(n,t){return n.querySelector(t)},E=t.getProductIdByProductLinkElem=function(n){if(!n)return"";var t=n.getAttribute("href");return t.startsWith("//")&&(t="https:"+t),new URL(t).searchParams.get("id")||""},O=t.getCartIdByProductListElem=function(n){return n.split("_")[2].trim()};t.getProductListMap=function(n,t,r){return n.map(function(n){return{productList:n,productInfo:b(n,r),productId:E(_(n,t)),cartId:O(n.id)}})},t.isProductFetchedFromTaoBao=function(n){return!!(n&&Object.prototype.hasOwnProperty.call(n,"activateState")&&Object.prototype.hasOwnProperty.call(n,"hasCashback")&&Object.prototype.hasOwnProperty.call(n,"deepLink"))}},function(n,t,r){var e=r(219),i=r(165),o=r(166);n.exports=function(n){return o(n)?e(n):i(n)}},function(n,t,r){var e=r(125),i=r(223),o=Object.prototype.hasOwnProperty;n.exports=function(n){if(!e(n))return i(n);var t=[];for(var r in Object(n))o.call(n,r)&&"constructor"!=r&&t.push(r);return t}},function(n,t,r){var e=r(161),i=r(154);n.exports=function(n){return null!=n&&i(n.length)&&!e(n)}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInitializeApplyingMetaData=t.shouldAddCouponMutationObserver=t.isMerchantCanAutoApply=t.isMenuApplyCodeBtnOpened=t.isCouponNotifierOpened=t.shouldFetchCouponData=t.getApplyResultSavedPrice=t.getNumberOfCodesForProgressBar=t.getApplyingStatusCode=t.getNextApplyCode=t.getVerifiedCode=t.isCheckCodeResponse=t.isApplyingDiscounts=t.isAllCodesApplyDoneExceptOne=t.isApplyResultOpened=t.urlIsCouponUrl=t.merchantHasCouponCodes=t.getApplyingMetaDataCouponCodes=t.getCouponMerchantCouponCodes=t.shouldDisplayIntermediateApplyResult=t.shouldDisplayApplyResult=t.shouldDisplayNotifier=t.merchantCanAutoApply=t.getTrendingCouponCodes=t.getDeletedCouponMerchant=t.getApplyingMetaData=t.getCouponMerchant=void 0;var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(17),a=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(102));var c=function(n,t){return t.url},f=function(n){return n.coupons},s=t.getCouponMerchant=(0,u.createSelector)([f,function(n,t){return t.merchantId}],function(n,t){return n.merchants[t]}),l=t.getApplyingMetaData=(0,u.createSelector)([f,function(n,t){return t.tabId}],function(n,t){return n.applyingMetaData[t]}),v=t.getDeletedCouponMerchant=(0,u.createSelector)([f,function(n,t){return t.merchantId}],function(n,t){return n.deletedMerchants[t]}),d=(t.getTrendingCouponCodes=(0,u.createSelector)([f],function(n){return(0,o.default)({},n.trendingCouponCodes)}),t.merchantCanAutoApply=(0,u.createSelector)([s],function(n){return n.canAutoApply}),t.shouldDisplayNotifier=(0,u.createSelector)([s,l],function(n,t){return!(!n.enabled||!n.notifierOpened||t.applierOpened||t.applyResultOpened||n.disappearNotifierSeconds&&!(n.disappearNotifierSeconds<=Math.trunc((new Date).getTime())))}),t.shouldDisplayApplyResult=(0,u.createSelector)([s,l],function(n,t){return!!(n.couponCodesSorted.length>n.maxApplyNum&&t.applyingCodeIndex===n.maxApplyNum-1&&t.bestPrice<t.originalPrice)}),t.shouldDisplayIntermediateApplyResult=(0,u.createSelector)([s,l],function(n,t){return!!(n.couponCodesSorted.length>n.maxApplyNum&&t.applyingCodeIndex===n.maxApplyNum-1&&t.bestPrice===t.originalPrice)}),t.getCouponMerchantCouponCodes=(0,u.createSelector)([s],function(n){return n?n.couponCodes:null})),p=t.getApplyingMetaDataCouponCodes=(0,u.createSelector)([l],function(n){return n?n.couponCodes:null});t.merchantHasCouponCodes=(0,u.createSelector)([d],function(n){return!!(n&&Object.keys(n).length>0)}),t.urlIsCouponUrl=(0,u.createSelector)([s,c,l],function(n,t,r){return!!(n&&r&&n.couponUrlPattern&&new RegExp(n.couponUrlPattern).test(t))}),t.isApplyResultOpened=(0,u.createSelector)([l],function(n){return!(!n||!n.applyResultOpened)}),t.isAllCodesApplyDoneExceptOne=(0,u.createSelector)([p],function(n){return Object.keys(n).filter(function(t){return n[t].applyStatus===a.COUPON_CODE_APPLY_DONE}).length===Object.keys(n).length-1}),t.isApplyingDiscounts=(0,u.createSelector)([l],function(n){return!(!n||!n.applying)}),t.isCheckCodeResponse=(0,u.createSelector)([function(n){return n.coupons.checkCodeUrlPatterns||[]},c,function(n,t){return t.method},l],function(n,t,r,e){var i=n.find(function(n){return n.checkCodeUrlPattern&&new RegExp(n.checkCodeUrlPattern).test(t)&&n.method.split(";").some(function(n){return n.trim()===r})});return i&&e&&i.merchantId===e.merchantId}),t.getVerifiedCode=(0,u.createSelector)([p],function(n){return Object.keys(n).find(function(t){return n[t].applyStatus===a.COUPON_CODE_VERIFIED})}),t.getNextApplyCode=(0,u.createSelector)([s,l],function(n,t){return n&&t?n.couponCodesSorted[t.applyingCodeIndex+1]:""}),t.getApplyingStatusCode=(0,u.createSelector)([p],function(n){return Object.keys(n).find(function(t){return n[t].applyStatus===a.COUPON_CODE_APPLYING})}),t.getNumberOfCodesForProgressBar=(0,u.createSelector)([s,l],function(n,t){if(!n||!t||!n.couponCodesSorted||0===n.couponCodesSorted.length)return[0,0];var r=n.couponCodesSorted,e=n.maxApplyNum,i=t.applyingCodeIndex,o=r.length,u=-1,a=-1;return o<=e?(u=r.length,a=i+1):i+1<=e?(u=e,a=i+1):(u=o-e,a=i+1-e),[u,a]}),t.getApplyResultSavedPrice=(0,u.createSelector)([l],function(n){var t=n.bestCode,r=n.originalPrice,e=n.bestPrice;return!t||isNaN(r)||isNaN(e)?NaN:Number((r-e).toFixed(2))}),t.shouldFetchCouponData=(0,u.createSelector)([s,v,l],function(n,t,r){if(!n&&!t)return!0;if(r&&r.applying)return!1;var e=n?n.fetchedAt:t.fetchedAt;return"number"!=typeof e||(new Date).getTime()-e>a.REFETCH_COUPON_INTERVAL_MS}),t.isCouponNotifierOpened=(0,u.createSelector)([s],function(n){return!(!n||!n.notifierOpened)}),t.isMenuApplyCodeBtnOpened=(0,u.createSelector)([s],function(n){return!(!n||!n.menuApplyCodeBtnOpened)}),t.isMerchantCanAutoApply=(0,u.createSelector)([s],function(n){return!(!n||!n.canAutoApply)}),t.shouldAddCouponMutationObserver=(0,u.createSelector)([s],function(n){return!(!n||!n.observeTargetUrlPattern&&!n.observeTargetElementPattern)}),t.shouldInitializeApplyingMetaData=(0,u.createSelector)([s,l,function(n,t){return t.merchantId}],function(n,t,r){return!(!n||t&&t.merchantId===r)})},,function(n,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;n.exports=r}).call(t,r(20))},function(n,t){var r=Function.prototype.toString;n.exports=function(n){if(null!=n){try{return r.call(n)}catch(n){}try{return n+""}catch(n){}}return""}},function(n,t,r){var e=r(271),i=r(278),o=r(280),u=r(281),a=r(282);function c(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}c.prototype.clear=e,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=u,c.prototype.set=a,n.exports=c},function(n,t){n.exports=function(n){return function(t){return n(t)}}},function(n,t,r){(function(n){var e=r(169),i="object"==typeof t&&t&&!t.nodeType&&t,o=i&&"object"==typeof n&&n&&!n.nodeType&&n,u=o&&o.exports===i&&e.process,a=function(){try{var n=o&&o.require&&o.require("util").types;return n||u&&u.binding&&u.binding("util")}catch(n){}}();n.exports=a}).call(t,r(168)(n))},function(n,t,r){var e=r(44),i=r(126),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;n.exports=function(n,t){if(e(n))return!1;var r=typeof n;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=n&&!i(n))||u.test(n)||!o.test(n)||null!=t&&n in Object(t)}},,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=f(r(5)),i=f(r(38));t.toggleTaoBaoSearchBox=function(){return{type:a.TAOBAO_TOGGLE_SEARCH_BOX}},t.uiToggleTaoBaoSearchBox=function(){return{type:a.TAOBAO_TOGGLE_SEARCH_BOX}},t.openTaoBaoNotifier=function(){return{type:a.TAOBAO_OPEN_NOTIFIER}},t.uiOpenTaoBaoNotifier=function(){return{type:a.TAOBAO_OPEN_NOTIFIER}},t.closeTaoBaoNotifier=function(){return{type:a.TAOBAO_CLOSE_NOTIFIER}},t.uiCloseTaoBaoNotifier=function(){return{type:a.TAOBAO_CLOSE_NOTIFIER}},t.closeTaoBaoConfirmationNotifier=function(){return{type:a.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER}},t.uiCloseTaoBaoConfirmationNotifier=function(){return{type:a.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER}},t.openTaoBaoConfirmationNotifier=function(){return{type:a.TAOBAO_OPEN_CONFIRMATION_NOTIFIER}},t.uiOpenTaoBaoConfirmationNotifier=function(){return{type:a.TAOBAO_OPEN_CONFIRMATION_NOTIFIER}},t.openTaoBaoApiDownNotifier=function(){return{type:a.TAOBAO_OPEN_API_DOWN_NOTIFIER}},t.uiOpenTaoBaoApiDownNotifier=function(){return{type:a.TAOBAO_OPEN_API_DOWN_NOTIFIER}},t.closeTaoBaoApiDownNotifier=function(){return{type:a.TAOBAO_CLOSE_API_DOWN_NOTIFIER}},t.uiCloseTaoBaoApiDownNotifier=function(){return{type:a.TAOBAO_CLOSE_API_DOWN_NOTIFIER}},t.fetchTaoBaoProductCashbackStatusSuccess=s,t.fetchTaoBaoProductCashbackStatus=function(n){var t=n.productId;return function(n,r){var e=r(),f=e.cc,l=(0,o.getTaoBaoSettings)(e),v=l.api;return(0,u.taoBaoProductHasCashback)(t,f,v).then(function(n){return n?Promise.all([n,(0,u.getTaoBaoProductDeepLink)(t,f,v)]):Promise.resolve([n,""])}).then(function(r){var e=(0,i.default)(r,2),o=e[0],u=e[1];n(s(t,o,u))}).catch(function(t){var r=t.message;n((0,c.apiError)({errorType:a.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_ERROR,message:r}))})}},t.uiFetchTaoBaoProductCashbackStatus=function(n){return{type:a.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS,productId:n}},t.deactivateTaoBaoProduct=function(n){var t=n.productId;return{type:a.DEACTIVATE_TAOBAO_PRODUCT,payload:{productId:t}}},t.uiDeactivateTaoBaoProduct=function(n){return{type:a.DEACTIVATE_TAOBAO_PRODUCT,productId:n}},t.startActivateTaoBaoProduct=function(n){return{type:a.START_ACTIVATE_TAOBAO_PRODUCT,payload:{tabId:n.tabId,productId:n.productId}}},t.uiStartActivateTaoBaoProduct=function(n){return(0,e.default)({type:a.START_ACTIVATE_TAOBAO_PRODUCT},n)},t.setProductFromAiTaoBaoSearchToActivated=function(n){var t=n.productId;return{type:a.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED,payload:{productId:t}}},t.uiSetProductFromAiTaoBaoSearchToActivated=function(n){return{type:a.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED,productId:n}},t.activateTaoBaoProductFromSB=function(n){var t=n.productId;return{type:a.ACTIVATE_TAOBAO_PRODUCT_FROM_SB,payload:{productId:t}}},t.uiActivateTaoBaoProductFromSB=function(n){return{type:a.ACTIVATE_TAOBAO_PRODUCT_FROM_SB,productId:n}};var o=r(108),u=r(163),a=r(0),c=r(45);function f(n){return n&&n.__esModule?n:{default:n}}function s(n,t,r){return{type:a.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS,payload:{productId:n,hasCashback:t,deepLink:r}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPermissionNotifierResumable=t.isRecordPermissionChanged=t.isAnyInvalidPermission=void 0;var e=r(17),i=r(0),o=function(n,t){if(t.merchant)return n.permission[t.merchant.id]};t.isAnyInvalidPermission=function(n){return Object.keys(n.permission).length>0},t.isRecordPermissionChanged=(0,e.createSelector)([o],function(n){return!!n}),t.isPermissionNotifierResumable=(0,e.createSelector)([o],function(n){if(n){if(!n.ts)return!0;var t=n.ts;return Date.now()-t>i.PERMISSION_NOTIFIER_TTL}return!1})},function(n,t,r){var e=r(260),i=r(57);n.exports=function n(t,r,o,u,a){return t===r||(null==t||null==r||!i(t)&&!i(r)?t!=t&&r!=r:e(t,r,o,u,n,a))}},function(n,t,r){var e=r(150),i=r(266),o=r(267),u=r(268),a=r(269),c=r(270);function f(n){var t=this.__data__=new e(n);this.size=t.size}f.prototype.clear=i,f.prototype.delete=o,f.prototype.get=u,f.prototype.has=a,f.prototype.set=c,n.exports=f},function(n,t){n.exports=function(n,t){return n===t||n!=n&&t!=t}},function(n,t){var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;n.exports=function(n,t){var i=typeof n;return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&e.test(n))&&n>-1&&n%1==0&&n<t}},function(n,t,r){(function(n){!function(n){var t=function(){try{return!!Symbol.iterator}catch(n){return!1}}(),r=function(n){var r={next:function(){var t=n.shift();return{done:void 0===t,value:t}}};return t&&(r[Symbol.iterator]=function(){return r}),r},e=function(n){return encodeURIComponent(n).replace(/%20/g,"+")},i=function(n){return decodeURIComponent(n).replace(/\+/g," ")};"URLSearchParams"in n&&"a=1"===new URLSearchParams("?a=1").toString()||function(){var o=function(n){if(Object.defineProperty(this,"_entries",{value:{}}),"string"==typeof n){if(""!==n)for(var t,r=(n=n.replace(/^\?/,"")).split("&"),e=0;e<r.length;e++)t=r[e].split("="),this.append(i(t[0]),t.length>1?i(t[1]):"")}else if(n instanceof o){var u=this;n.forEach(function(n,t){u.append(n,t)})}},u=o.prototype;u.append=function(n,t){n in this._entries?this._entries[n].push(t.toString()):this._entries[n]=[t.toString()]},u.delete=function(n){delete this._entries[n]},u.get=function(n){return n in this._entries?this._entries[n][0]:null},u.getAll=function(n){return n in this._entries?this._entries[n].slice(0):[]},u.has=function(n){return n in this._entries},u.set=function(n,t){this._entries[n]=[t.toString()]},u.forEach=function(n,t){var r;for(var e in this._entries)if(this._entries.hasOwnProperty(e)){r=this._entries[e];for(var i=0;i<r.length;i++)n.call(t,r[i],e,this)}},u.keys=function(){var n=[];return this.forEach(function(t,r){n.push(r)}),r(n)},u.values=function(){var n=[];return this.forEach(function(t){n.push(t)}),r(n)},u.entries=function(){var n=[];return this.forEach(function(t,r){n.push([r,t])}),r(n)},t&&(u[Symbol.iterator]=u.entries),u.toString=function(){var n="";return this.forEach(function(t,r){n.length>0&&(n+="&"),n+=e(r)+"="+e(t)}),n},n.URLSearchParams=o}()}(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this),function(n){if(function(){try{var n=new URL("b","http://a");return n.pathname="c%20d","http://a/c%20d"===n.href&&n.searchParams}catch(n){return!1}}()||function(){var t=n.URL,r=function(n,t){"string"!=typeof n&&(n=String(n));var r=document.implementation.createHTMLDocument("");if(window.doc=r,t){var e=r.createElement("base");e.href=t,r.head.appendChild(e)}var i=r.createElement("a");if(i.href=n,r.body.appendChild(i),i.href=i.href,":"===i.protocol||!/:/.test(i.href))throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:i})},e=r.prototype;["hash","host","hostname","port","protocol","search"].forEach(function(n){!function(n){Object.defineProperty(e,n,{get:function(){return this._anchorElement[n]},set:function(t){this._anchorElement[n]=t},enumerable:!0})}(n)}),Object.defineProperties(e,{toString:{get:function(){var n=this;return function(){return n.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(n){this._anchorElement.href=n},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(n){this._anchorElement.pathname=n},enumerable:!0},origin:{get:function(){var n={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],t=this._anchorElement.port!=n&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(t?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(n){},enumerable:!0},username:{get:function(){return""},set:function(n){},enumerable:!0},searchParams:{get:function(){var n=new URLSearchParams(this.search),t=this;return["append","delete","set"].forEach(function(r){var e=n[r];n[r]=function(){e.apply(n,arguments),t.search=n.toString()}}),n},enumerable:!0}}),r.createObjectURL=function(n){return t.createObjectURL.apply(t,arguments)},r.revokeObjectURL=function(n){return t.revokeObjectURL.apply(t,arguments)},n.URL=r}(),void 0!==n.location&&!("origin"in n.location)){var t=function(){return n.location.protocol+"//"+n.location.hostname+(n.location.port?":"+n.location.port:"")};try{Object.defineProperty(n.location,"origin",{get:t,enumerable:!0})}catch(r){setInterval(function(){n.location.origin=t()},100)}}}(void 0!==n?n:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this)}).call(t,r(20))},function(n,t,r){var e=r(9);n.exports=function(n,t,r,i){try{return i?t(e(r)[0],r[1]):t(r)}catch(t){var o=n.return;throw void 0!==o&&e(o.call(n)),t}}},function(n,t,r){var e=r(14),i=r(3)("iterator"),o=Array.prototype;n.exports=function(n){return void 0!==n&&(e.Array===n||o[i]===n)}},function(n,t,r){var e=r(3)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(n){}n.exports=function(n,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},n(o)}catch(n){}return r}},function(n,t){n.exports=function(n,t){for(var r=-1,e=t.length,i=n.length;++r<e;)n[i+r]=t[r];return n}},function(n,t,r){var e=r(289),i=r(218),o=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,a=u?function(n){return null==n?[]:(n=Object(n),e(u(n),function(t){return o.call(n,t)}))}:i;n.exports=a},function(n,t){n.exports=function(n,t){return function(r){return n(t(r))}}},function(n,t,r){var e=r(68)(r(30),"WeakMap");n.exports=e},function(n,t){n.exports=function(n){return n}},,,,,,function(n,t,r){"use strict";t.__esModule=!0;var e,i=r(256),o=(e=i)&&e.__esModule?e:{default:e};t.default=function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return(0,o.default)(n)}},function(n,t,r){var e=r(248),i=r(285),o=r(249),u=1,a=2;n.exports=function(n,t,r,c,f,s){var l=r&u,v=n.length,d=t.length;if(v!=d&&!(l&&d>v))return!1;var p=s.get(n);if(p&&s.get(t))return p==t;var h=-1,_=!0,b=r&a?new e:void 0;for(s.set(n,t),s.set(t,n);++h<v;){var E=n[h],O=t[h];if(c)var y=l?c(O,E,h,t,n,s):c(E,O,h,n,t,s);if(void 0!==y){if(y)continue;_=!1;break}if(b){if(!i(t,function(n,t){if(!o(b,t)&&(E===n||f(E,n,r,c,s)))return b.push(t)})){_=!1;break}}else if(E!==O&&!f(E,O,r,c,s)){_=!1;break}}return s.delete(n),s.delete(t),_}},function(n,t,r){var e=r(68)(r(30),"Set");n.exports=e},function(n,t,r){var e=r(76);n.exports=function(n){return n==n&&!e(n)}},function(n,t){n.exports=function(n,t){return function(r){return null!=r&&r[n]===t&&(void 0!==t||n in Object(r))}}},function(n,t,r){var e=r(203),i=r(122);n.exports=function(n,t){for(var r=0,o=(t=e(t,n)).length;null!=n&&r<o;)n=n[i(t[r++])];return r&&r==o?n:void 0}},function(n,t,r){var e=r(44),i=r(174),o=r(227),u=r(228);n.exports=function(n,t){return e(n)?n:i(n,t)?[n]:o(u(n))}},,,,,function(n,t,r){var e=r(161),i=r(211),o=r(76),u=r(170),a=/^\[object .+?Constructor\]$/,c=Function.prototype,f=Object.prototype,s=c.toString,l=f.hasOwnProperty,v=RegExp("^"+s.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");n.exports=function(n){return!(!o(n)||i(n))&&(e(n)?v:a).test(u(n))}},function(n,t,r){var e=r(103),i=Object.prototype,o=i.hasOwnProperty,u=i.toString,a=e?e.toStringTag:void 0;n.exports=function(n){var t=o.call(n,a),r=n[a];try{n[a]=void 0;var e=!0}catch(n){}var i=u.call(n);return e&&(t?n[a]=r:delete n[a]),i}},function(n,t){var r=Object.prototype.toString;n.exports=function(n){return r.call(n)}},function(n,t,r){var e,i=r(212),o=(e=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"";n.exports=function(n){return!!o&&o in n}},function(n,t,r){var e=r(30)["__core-js_shared__"];n.exports=e},function(n,t){n.exports=function(n,t){return null==n?void 0:n[t]}},function(n,t,r){var e=r(30).Uint8Array;n.exports=e},function(n,t){n.exports=function(n){var t=-1,r=Array(n.size);return n.forEach(function(n){r[++t]=n}),r}},function(n,t,r){var e=r(217),i=r(188),o=r(164);n.exports=function(n){return e(n,o,i)}},function(n,t,r){var e=r(187),i=r(44);n.exports=function(n,t,r){var o=t(n);return i(n)?o:e(o,r(n))}},function(n,t){n.exports=function(){return[]}},function(n,t,r){var e=r(290),i=r(123),o=r(44),u=r(124),a=r(182),c=r(162),f=Object.prototype.hasOwnProperty;n.exports=function(n,t){var r=o(n),s=!r&&i(n),l=!r&&!s&&u(n),v=!r&&!s&&!l&&c(n),d=r||s||l||v,p=d?e(n.length,String):[],h=p.length;for(var _ in n)!t&&!f.call(n,_)||d&&("length"==_||l&&("offset"==_||"parent"==_)||v&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||a(_,h))||p.push(_);return p}},function(n,t,r){var e=r(72),i=r(57),o="[object Arguments]";n.exports=function(n){return i(n)&&e(n)==o}},function(n,t){n.exports=function(){return!1}},function(n,t,r){var e=r(72),i=r(154),o=r(57),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,n.exports=function(n){return o(n)&&i(n.length)&&!!u[e(n)]}},function(n,t,r){var e=r(189)(Object.keys,Object);n.exports=e},function(n,t,r){var e=r(68)(r(30),"DataView");n.exports=e},function(n,t,r){var e=r(68)(r(30),"Promise");n.exports=e},function(n,t,r){var e=r(165),i=r(111),o=r(123),u=r(44),a=r(166),c=r(124),f=r(125),s=r(162),l="[object Map]",v="[object Set]",d=Object.prototype.hasOwnProperty;n.exports=function(n){if(null==n)return!0;if(a(n)&&(u(n)||"string"==typeof n||"function"==typeof n.splice||c(n)||s(n)||o(n)))return!n.length;var t=i(n);if(t==l||t==v)return!n.size;if(f(n))return!e(n).length;for(var r in n)if(d.call(n,r))return!1;return!0}},function(n,t,r){var e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=r(297)(function(n){var t=[];return 46===n.charCodeAt(0)&&t.push(""),n.replace(e,function(n,r,e,o){t.push(e?o.replace(i,"$1"):r||n)}),t});n.exports=o},function(n,t,r){var e=r(299);n.exports=function(n){return null==n?"":e(n)}},function(n,t){n.exports=function(n,t){for(var r=-1,e=null==n?0:n.length,i=Array(e);++r<e;)i[r]=t(n[r],r,n);return i}},,,,,,,,,,,,,,,,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchSettings=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.DEFAULT_COUNTRY,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(r){return(0,e.fetchWithRetry)((0,i.getSettingsAPI)(n)).then(e.handleErrors).then(function(n){return n.json()}).then(function(n){return n?(n._=n.seaweed,delete n.seaweed,r((t=n,{type:o.e,payload:t}))):Promise.resolve();var t}).then(function(){return r((0,u.fetchMerchants)(n,t))}).catch(function(n){var t=n.message;r((0,a.apiError)({errorType:o.FETCH_SETTINGS_ERROR,message:t}))})}},t.toggleEventTracking=function(n){if(n.toggle)return{type:o.ENABLE_TRACKING};return{type:o.DISABLE_TRACKING}},t.uiToggleEventTracking=function(n){return{type:o.TOGGLE_TRACKING,toggle:n}};var e=r(63),i=r(19),o=r(0),u=r(101),a=r(45)},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTabReadyToBeClosed=void 0;var e=r(17);t.isTabReadyToBeClosed=(0,e.createSelector)([function(n){return n.readyToBeClosedTabs},function(n,t){return t.tabId}],function(n,t){return!!n[t]})},function(n,t,r){var e=r(171),i=r(283),o=r(284);function u(n){var t=-1,r=null==n?0:n.length;for(this.__data__=new e;++t<r;)this.add(n[t])}u.prototype.add=u.prototype.push=i,u.prototype.has=o,n.exports=u},function(n,t){n.exports=function(n,t){return n.has(t)}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.noop=function(){},t.sleep=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise(function(t){return setTimeout(function(){t()},n)})},t.atLeastOneIsTrue=function(){for(var n=arguments.length,t=Array(n),r=0;r<n;r++)t[r]=arguments[r];return t.some(function(n){return!!n})}},,,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TARGETED_AD_DIV_ID="shopback-targeted-ad-notifier",t.OPEN_TARGETED_AD_NOTIFIER="OPEN_TARGETED_AD_NOTIFIER",t.CLOSE_TARGETED_AD_NOTIFIER="CLOSE_TARGETED_AD_NOTIFIER"},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=v(r(5)),i=v(r(75));t.loginOK=d,t.loginNotOK=p,t.logout=h,t.uiLogout=function(n){return{type:s.LOGOUT,cc:n}},t.dropSBCookie=_,t.setSBCookie=b,t.fetchUser=O,t.uiFetchUser=function(){return{type:s.FETCH_USER_INFO}},t.syncUserFromShopBack=function(n){var t=n.profileId,r=n.userToken,e=n.userRefreshToken,i=n.userTokenDomain,o=n.url,u=n.tabId,a=void 0===u?-1:u;return function(n){var u=(0,l.getCCFromDomain)(i);return r?n(O(u,r,e,i)).then(function(){return n(d(u,t,r,e,i,a,o))}).catch(function(){return n(p(u,t))}):(0,l.isLoginPage)(u,o)?Promise.resolve():n(h({cc:u,profileId:t}))}},t.uiSyncUserFromShopBack=function(n){return(0,e.default)({type:s.SYNC_USER_FROM_SHOPBACK},n)},t.uiSwitchUser=function(n){return{type:s.SWITCH_USER,cc:n}},t.switchUser=function(n){var t=n.cc;return function(n,r){var e=(0,o.findLoginHistory)(r(),{cc:t});return n({type:s.SWITCH_USER,payload:{cc:t}}),n(O(t,e.token,e.refreshToken,e.tokenDomain))}};var o=r(119),u=r(63),a=r(247),c=r(158),f=r(45),s=r(0),l=r(19);function v(n){return n&&n.__esModule?n:{default:n}}function d(n,t,r,e,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-1,u=arguments[6];return function(f,v){(0,a.isTabReadyToBeClosed)(v(),{tabId:o})&&(0,l.isSBHomePage)(n,u)&&f((0,c.closeTab)({tabId:o})),f({type:s.LOGIN_OK,payload:{cc:n,profileId:t,token:r,refreshToken:e,tokenDomain:i}}),browser.tabs.sendMessage(o,{action:s.LOGIN_OK}).catch(function(){})}}function p(n,t){return{type:s.LOGIN_NOT_OK,payload:{cc:n,profileId:t}}}function h(n){return{type:s.LOGOUT,payload:n}}function _(n){var t=n.cc;return function(n){return browser.cookies.remove({url:(0,l.getHomePage)(t),name:s.ACCESS_TOKEN_NAME}).then(function(){return n({type:s.DROP_COOKIE_DONE})}).catch(function(){return n({type:s.DROP_COOKIE_DONE})})}}function b(n){var t=n.cc,r=n.accessToken;return function(n){return browser.cookies.set({url:(0,l.getHomePage)(t),name:s.ACCESS_TOKEN_NAME,value:r,expirationDate:parseInt(Date.now()/1e3,10)+s.SECONDS_OF_ONE_YEAR,sameSite:"lax"}).then(function(){return n({type:s.SET_COOKIE_DONE})}).catch(function(){return n({type:s.SET_COOKIE_FAIL})})}}var E=function(n,t){var r,e=t.token,o=t.refreshToken,u=t.tokenDomain,a=(0,l.getAccountAPI)(n),c={headers:(r={},(0,i.default)(r,s.HEADERS.X_SHOPBACK_LAST_CC,n),(0,i.default)(r,s.HEADERS.X_SHOPBACK_DOMAIN,u),(0,i.default)(r,s.HEADERS.X_SHOPBACK_CLIENT_USER_AGENT,navigator.userAgent),(0,i.default)(r,s.HEADERS.X_SHOPBACK_ACCESS_TOKEN,e),(0,i.default)(r,s.HEADERS.X_SHOPBACK_REFRESH_TOKEN,o),r)};return fetch(a,c)};function O(n,t,r,e){return function(i,o){var a=t?{token:t,refreshToken:r,tokenDomain:e}:o().user,c=(n||o().cc).toUpperCase();return E(c,a).then(function(n){return 401===n.status&&(i(h({cc:c})),i(_({cc:c}))),n}).then(u.handleErrors).then(function(n){return n.json()}).then(function(n){var t,r;n.newAccessToken&&(i((t=n.newAccessToken,{type:s.REFRESH_ACCESS_TOKEN_SUCCESS,payload:{token:t}})),i(b({cc:c,accessToken:n.newAccessToken}))),i((r=n,{type:s.FETCH_USER_INFO_SUCCESS,payload:{user:r}}))}).catch(function(n){var t=n.message;return i((0,f.apiError)({errorType:s.FETCH_USER_INFO_ERROR,message:t})),Promise.reject({message:t})})}}},function(n,t,r){n.exports={default:r(257),__esModule:!0}},function(n,t,r){r(28),r(258),n.exports=r(2).Array.from},function(n,t,r){"use strict";var e=r(46),i=r(13),o=r(37),u=r(184),a=r(185),c=r(66),f=r(259),s=r(67);i(i.S+i.F*!r(186)(function(n){Array.from(n)}),"Array",{from:function(n){var t,r,i,l,v=o(n),d="function"==typeof this?this:Array,p=arguments.length,h=p>1?arguments[1]:void 0,_=void 0!==h,b=0,E=s(v);if(_&&(h=e(h,p>2?arguments[2]:void 0,2)),void 0==E||d==Array&&a(E))for(r=new d(t=c(v.length));t>b;b++)f(r,b,_?h(v[b],b):v[b]);else for(l=E.call(v),r=new d;!(i=l.next()).done;b++)f(r,b,_?u(l,h,[i.value,b],!0):i.value);return r.length=b,r}})},function(n,t,r){"use strict";var e=r(8),i=r(22);n.exports=function(n,t,r){t in n?e.f(n,t,i(0,r)):n[t]=r}},function(n,t,r){var e=r(180),i=r(198),o=r(286),u=r(288),a=r(111),c=r(44),f=r(124),s=r(162),l=1,v="[object Arguments]",d="[object Array]",p="[object Object]",h=Object.prototype.hasOwnProperty;n.exports=function(n,t,r,_,b,E){var O=c(n),y=c(t),m=O?d:a(n),T=y?d:a(t),g=(m=m==v?p:m)==p,I=(T=T==v?p:T)==p,A=m==T;if(A&&f(n)){if(!f(t))return!1;O=!0,g=!1}if(A&&!g)return E||(E=new e),O||s(n)?i(n,t,r,_,b,E):o(n,t,m,r,_,b,E);if(!(r&l)){var C=g&&h.call(n,"__wrapped__"),S=I&&h.call(t,"__wrapped__");if(C||S){var w=C?n.value():n,N=S?t.value():t;return E||(E=new e),b(w,N,r,_,E)}}return!!A&&(E||(E=new e),u(n,t,r,_,b,E))}},function(n,t){n.exports=function(){this.__data__=[],this.size=0}},function(n,t,r){var e=r(151),i=Array.prototype.splice;n.exports=function(n){var t=this.__data__,r=e(t,n);return!(r<0||(r==t.length-1?t.pop():i.call(t,r,1),--this.size,0))}},function(n,t,r){var e=r(151);n.exports=function(n){var t=this.__data__,r=e(t,n);return r<0?void 0:t[r][1]}},function(n,t,r){var e=r(151);n.exports=function(n){return e(this.__data__,n)>-1}},function(n,t,r){var e=r(151);n.exports=function(n,t){var r=this.__data__,i=e(r,n);return i<0?(++this.size,r.push([n,t])):r[i][1]=t,this}},function(n,t,r){var e=r(150);n.exports=function(){this.__data__=new e,this.size=0}},function(n,t){n.exports=function(n){var t=this.__data__,r=t.delete(n);return this.size=t.size,r}},function(n,t){n.exports=function(n){return this.__data__.get(n)}},function(n,t){n.exports=function(n){return this.__data__.has(n)}},function(n,t,r){var e=r(150),i=r(160),o=r(171),u=200;n.exports=function(n,t){var r=this.__data__;if(r instanceof e){var a=r.__data__;if(!i||a.length<u-1)return a.push([n,t]),this.size=++r.size,this;r=this.__data__=new o(a)}return r.set(n,t),this.size=r.size,this}},function(n,t,r){var e=r(272),i=r(150),o=r(160);n.exports=function(){this.size=0,this.__data__={hash:new e,map:new(o||i),string:new e}}},function(n,t,r){var e=r(273),i=r(274),o=r(275),u=r(276),a=r(277);function c(n){var t=-1,r=null==n?0:n.length;for(this.clear();++t<r;){var e=n[t];this.set(e[0],e[1])}}c.prototype.clear=e,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=u,c.prototype.set=a,n.exports=c},function(n,t,r){var e=r(152);n.exports=function(){this.__data__=e?e(null):{},this.size=0}},function(n,t){n.exports=function(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}},function(n,t,r){var e=r(152),i="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;n.exports=function(n){var t=this.__data__;if(e){var r=t[n];return r===i?void 0:r}return o.call(t,n)?t[n]:void 0}},function(n,t,r){var e=r(152),i=Object.prototype.hasOwnProperty;n.exports=function(n){var t=this.__data__;return e?void 0!==t[n]:i.call(t,n)}},function(n,t,r){var e=r(152),i="__lodash_hash_undefined__";n.exports=function(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=e&&void 0===t?i:t,this}},function(n,t,r){var e=r(153);n.exports=function(n){var t=e(this,n).delete(n);return this.size-=t?1:0,t}},function(n,t){n.exports=function(n){var t=typeof n;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==n:null===n}},function(n,t,r){var e=r(153);n.exports=function(n){return e(this,n).get(n)}},function(n,t,r){var e=r(153);n.exports=function(n){return e(this,n).has(n)}},function(n,t,r){var e=r(153);n.exports=function(n,t){var r=e(this,n),i=r.size;return r.set(n,t),this.size+=r.size==i?0:1,this}},function(n,t){var r="__lodash_hash_undefined__";n.exports=function(n){return this.__data__.set(n,r),this}},function(n,t){n.exports=function(n){return this.__data__.has(n)}},function(n,t){n.exports=function(n,t){for(var r=-1,e=null==n?0:n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}},function(n,t,r){var e=r(103),i=r(214),o=r(181),u=r(198),a=r(287),c=r(215),f=1,s=2,l="[object Boolean]",v="[object Date]",d="[object Error]",p="[object Map]",h="[object Number]",_="[object RegExp]",b="[object Set]",E="[object String]",O="[object Symbol]",y="[object ArrayBuffer]",m="[object DataView]",T=e?e.prototype:void 0,g=T?T.valueOf:void 0;n.exports=function(n,t,r,e,T,I,A){switch(r){case m:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case y:return!(n.byteLength!=t.byteLength||!I(new i(n),new i(t)));case l:case v:case h:return o(+n,+t);case d:return n.name==t.name&&n.message==t.message;case _:case E:return n==t+"";case p:var C=a;case b:var S=e&f;if(C||(C=c),n.size!=t.size&&!S)return!1;var w=A.get(n);if(w)return w==t;e|=s,A.set(n,t);var N=u(C(n),C(t),e,T,I,A);return A.delete(n),N;case O:if(g)return g.call(n)==g.call(t)}return!1}},function(n,t){n.exports=function(n){var t=-1,r=Array(n.size);return n.forEach(function(n,e){r[++t]=[e,n]}),r}},function(n,t,r){var e=r(216),i=1,o=Object.prototype.hasOwnProperty;n.exports=function(n,t,r,u,a,c){var f=r&i,s=e(n),l=s.length;if(l!=e(t).length&&!f)return!1;for(var v=l;v--;){var d=s[v];if(!(f?d in t:o.call(t,d)))return!1}var p=c.get(n);if(p&&c.get(t))return p==t;var h=!0;c.set(n,t),c.set(t,n);for(var _=f;++v<l;){var b=n[d=s[v]],E=t[d];if(u)var O=f?u(E,b,d,t,n,c):u(b,E,d,n,t,c);if(!(void 0===O?b===E||a(b,E,r,u,c):O)){h=!1;break}_||(_="constructor"==d)}if(h&&!_){var y=n.constructor,m=t.constructor;y!=m&&"constructor"in n&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(h=!1)}return c.delete(n),c.delete(t),h}},function(n,t){n.exports=function(n,t){for(var r=-1,e=null==n?0:n.length,i=0,o=[];++r<e;){var u=n[r];t(u,r,n)&&(o[i++]=u)}return o}},function(n,t){n.exports=function(n,t){for(var r=-1,e=Array(n);++r<n;)e[r]=t(r);return e}},function(n,t,r){var e=r(292),i=r(295),o=r(191),u=r(44),a=r(303);n.exports=function(n){return"function"==typeof n?n:null==n?o:"object"==typeof n?u(n)?i(n[0],n[1]):e(n):a(n)}},function(n,t,r){var e=r(293),i=r(294),o=r(201);n.exports=function(n){var t=i(n);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(r){return r===n||e(r,n,t)}}},function(n,t,r){var e=r(180),i=r(179),o=1,u=2;n.exports=function(n,t,r,a){var c=r.length,f=c,s=!a;if(null==n)return!f;for(n=Object(n);c--;){var l=r[c];if(s&&l[2]?l[1]!==n[l[0]]:!(l[0]in n))return!1}for(;++c<f;){var v=(l=r[c])[0],d=n[v],p=l[1];if(s&&l[2]){if(void 0===d&&!(v in n))return!1}else{var h=new e;if(a)var _=a(d,p,v,n,t,h);if(!(void 0===_?i(p,d,o|u,a,h):_))return!1}}return!0}},function(n,t,r){var e=r(200),i=r(164);n.exports=function(n){for(var t=i(n),r=t.length;r--;){var o=t[r],u=n[o];t[r]=[o,u,e(u)]}return t}},function(n,t,r){var e=r(179),i=r(296),o=r(300),u=r(174),a=r(200),c=r(201),f=r(122),s=1,l=2;n.exports=function(n,t){return u(n)&&a(t)?c(f(n),t):function(r){var u=i(r,n);return void 0===u&&u===t?o(r,n):e(t,u,s|l)}}},function(n,t,r){var e=r(202);n.exports=function(n,t,r){var i=null==n?void 0:e(n,t);return void 0===i?r:i}},function(n,t,r){var e=r(298),i=500;n.exports=function(n){var t=e(n,function(n){return r.size===i&&r.clear(),n}),r=t.cache;return t}},function(n,t,r){var e=r(171),i="Expected a function";function o(n,t){if("function"!=typeof n||null!=t&&"function"!=typeof t)throw new TypeError(i);var r=function(){var e=arguments,i=t?t.apply(this,e):e[0],o=r.cache;if(o.has(i))return o.get(i);var u=n.apply(this,e);return r.cache=o.set(i,u)||o,u};return r.cache=new(o.Cache||e),r}o.Cache=e,n.exports=o},function(n,t,r){var e=r(103),i=r(229),o=r(44),u=r(126),a=1/0,c=e?e.prototype:void 0,f=c?c.toString:void 0;n.exports=function n(t){if("string"==typeof t)return t;if(o(t))return i(t,n)+"";if(u(t))return f?f.call(t):"";var r=t+"";return"0"==r&&1/t==-a?"-0":r}},function(n,t,r){var e=r(301),i=r(302);n.exports=function(n,t){return null!=n&&i(n,t,e)}},function(n,t){n.exports=function(n,t){return null!=n&&t in Object(n)}},function(n,t,r){var e=r(203),i=r(123),o=r(44),u=r(182),a=r(154),c=r(122);n.exports=function(n,t,r){for(var f=-1,s=(t=e(t,n)).length,l=!1;++f<s;){var v=c(t[f]);if(!(l=null!=n&&r(n,v)))break;n=n[v]}return l||++f!=s?l:!!(s=null==n?0:n.length)&&a(s)&&u(v,s)&&(o(n)||i(n))}},function(n,t,r){var e=r(304),i=r(305),o=r(174),u=r(122);n.exports=function(n){return o(n)?e(u(n)):i(n)}},function(n,t){n.exports=function(n){return function(t){return null==t?void 0:t[n]}}},function(n,t,r){var e=r(202);n.exports=function(n){return function(t){return e(t,n)}}},function(n,t,r){var e=r(307);n.exports=function(n,t){return!(null==n||!n.length)&&e(n,t,0)>-1}},function(n,t,r){var e=r(308),i=r(309),o=r(310);n.exports=function(n,t,r){return t==t?o(n,t,r):e(n,i,r)}},function(n,t){n.exports=function(n,t,r,e){for(var i=n.length,o=r+(e?1:-1);e?o--:++o<i;)if(t(n[o],o,n))return o;return-1}},function(n,t){n.exports=function(n){return n!=n}},function(n,t){n.exports=function(n,t,r){for(var e=r-1,i=n.length;++e<i;)if(n[e]===t)return e;return-1}},function(n,t){n.exports=function(){}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDetectedStandDownAffiliateNetWorks=t.isDisplay=void 0;var e=r(17),i=r(0),o=r(29);t.isDisplay=(0,e.createSelector)([function(n,t){return t.merchant},function(n){return n}],function(n,t){if(!n||!n.popup_enabled)return!1;if(n.standDown)return!1;var r=(0,o.getActivatedMerchantInfo)(t,{merchant:n});return r?!(r.visited===i.ACTIVATED_NOTIFIER_CLOSED):!n.closed}),t.isDetectedStandDownAffiliateNetWorks=(0,e.createSelector)([function(n){return n.standDownAffiliateNetworks},function(n,t){return t.tabId}],function(n,t){return n[t]})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uiOpenTargetedAdNotifier=function(){return{type:e.OPEN_TARGETED_AD_NOTIFIER}},t.openTargetedAdNotifier=function(){return{type:e.OPEN_TARGETED_AD_NOTIFIER,payload:{}}},t.uiCloseTargetedAdNotifier=function(){return{type:e.CLOSE_TARGETED_AD_NOTIFIER}},t.closeTargetedAdNotifier=function(){return{type:e.CLOSE_TARGETED_AD_NOTIFIER,payload:{}}};var e=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(254))},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CLICK_MENU_CAMPAIGN_NOTIFIER="CLICK_MENU_CAMPAIGN_NOTIFIER"},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detectPermissionChange=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:"-1"};return{type:e.DETECCT_PERMISSION_CHANGE,payload:{merchantId:n.id}}},t.closePermissionNotifier=function(n){var t=n.merchantId;return{type:e.CLOSE_PERMISSION_NOTIFIER,payload:{merchantId:t,ts:(new Date).getTime()}}},t.uiClosePermissionNotifier=function(n){return{type:e.CLOSE_PERMISSION_NOTIFIER,merchantId:n}},t.resetPermissionNotifier=o,t.cleanInvalidPermission=function(){return{type:e.CLEAN_INVALID_PERMISSION,payload:{}}},t.checkPermissionNotifierResumable=function(n){return function(t,r){var e=r();return(0,i.isPermissionNotifierResumable)(e,{merchant:n})&&t(o(n.id)),Promise.resolve()}};var e=r(0),i=r(178);function o(n){return{type:e.RESET_PERMISSION_NOTIFIER,payload:{merchantId:n}}}},function(n,t,r){var e=r(179);n.exports=function(n,t){return e(n,t)}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.b=t.O=t.y=t.m=void 0;var e=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));t.m=function(n,t){return{type:e.t,payload:{tabId:n,url:t}}},t.y=function(n){return{type:e.o,payload:{tabId:n}}},t.O=function(n){return{type:e.n,payload:{tabId:n}}},t.b=function(n){return{type:e.r,payload:{tabId:n}}}},,,,,,,,,,function(n,t,r){"use strict";var e,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(n,t,r){return Function.prototype.apply.call(n,t,r)};e=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:function(n){return Object.getOwnPropertyNames(n)};var u=Number.isNaN||function(n){return n!=n};function a(){a.init.call(this)}n.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function f(n){return void 0===n._maxListeners?a.defaultMaxListeners:n._maxListeners}function s(n,t,r,e){var i,o,u,a;if("function"!=typeof r)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if(void 0===(o=n._events)?(o=n._events=Object.create(null),n._eventsCount=0):(void 0!==o.newListener&&(n.emit("newListener",t,r.listener?r.listener:r),o=n._events),u=o[t]),void 0===u)u=o[t]=r,++n._eventsCount;else if("function"==typeof u?u=o[t]=e?[r,u]:[u,r]:e?u.unshift(r):u.push(r),(i=f(n))>0&&u.length>i&&!u.warned){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=n,c.type=t,c.count=u.length,a=c,console&&console.warn&&console.warn(a)}return n}function l(n,t,r){var e={fired:!1,wrapFn:void 0,target:n,type:t,listener:r},i=function(){for(var n=[],t=0;t<arguments.length;t++)n.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,n))}.bind(e);return i.listener=r,e.wrapFn=i,i}function v(n,t,r){var e=n._events;if(void 0===e)return[];var i=e[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(n){for(var t=new Array(n.length),r=0;r<t.length;++r)t[r]=n[r].listener||n[r];return t}(i):p(i,i.length)}function d(n){var t=this._events;if(void 0!==t){var r=t[n];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(n,t){for(var r=new Array(t),e=0;e<t;++e)r[e]=n[e];return r}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(n){if("number"!=typeof n||n<0||u(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");c=n}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||u(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},a.prototype.getMaxListeners=function(){return f(this)},a.prototype.emit=function(n){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var e="error"===n,i=this._events;if(void 0!==i)e=e&&void 0===i.error;else if(!e)return!1;if(e){var u;if(t.length>0&&(u=t[0]),u instanceof Error)throw u;var a=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw a.context=u,a}var c=i[n];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var f=c.length,s=p(c,f);for(r=0;r<f;++r)o(s[r],this,t)}return!0},a.prototype.addListener=function(n,t){return s(this,n,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(n,t){return s(this,n,t,!0)},a.prototype.once=function(n,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(n,l(this,n,t)),this},a.prototype.prependOnceListener=function(n,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(n,l(this,n,t)),this},a.prototype.removeListener=function(n,t){var r,e,i,o,u;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(e=this._events))return this;if(void 0===(r=e[n]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete e[n],e.removeListener&&this.emit("removeListener",n,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){u=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}(r,i),1===r.length&&(e[n]=r[0]),void 0!==e.removeListener&&this.emit("removeListener",n,u||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(n){var t,r,e;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[n]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[n]),this;if(0===arguments.length){var i,o=Object.keys(r);for(e=0;e<o.length;++e)"removeListener"!==(i=o[e])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[n]))this.removeListener(n,t);else if(void 0!==t)for(e=t.length-1;e>=0;e--)this.removeListener(n,t[e]);return this},a.prototype.listeners=function(n){return v(this,n,!0)},a.prototype.rawListeners=function(n){return v(this,n,!1)},a.listenerCount=function(n,t){return"function"==typeof n.listenerCount?n.listenerCount(t):d.call(n,t)},a.prototype.listenerCount=d,a.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uiClickMenuCampaignNotifier=function(){return{type:e.CLICK_MENU_CAMPAIGN_NOTIFIER}},t.clickMenuCampaignNotifier=function(){return{type:e.CLICK_MENU_CAMPAIGN_NOTIFIER,payload:{}}};var e=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(351))},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.formatCurrency=function(n,t,r,e){var i="NTD"===r?"TWD":r,o="THB"===i,u={style:"currency",currency:i,currencyDisplay:"code"},a=n.toLocaleString(t,u).replace(i,"").trim();return o?a+" "+e:""+e+a}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(n,t,r){"use strict";t.__esModule=!0,t.createDynamicMiddlewares=t.resetMiddlewares=t.removeMiddleware=t.addMiddleware=void 0;var e=r(100),i=function(){var n=[];return{enhancer:function(t){return function(r){return function(i){var o=n.map(function(n){return n(t)});return e.compose.apply(void 0,o)(r)(i)}}},addMiddleware:function(){for(var t=arguments.length,r=Array(t),e=0;e<t;e++)r[e]=arguments[e];n=[].concat(n,r)},removeMiddleware:function(t){var r=n.findIndex(function(n){return n===t});-1!==r?n=n.filter(function(n,t){return t!==r}):console.error("Middleware does not exist!",t)},resetMiddlewares:function(){n=[]}}},o=i();t.default=o.enhancer;var u=o.addMiddleware,a=o.removeMiddleware,c=o.resetMiddlewares;t.addMiddleware=u,t.removeMiddleware=a,t.resetMiddlewares=c,t.createDynamicMiddlewares=i},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCountryCode=function(){return function(n){return fetch(c.default.URL_COUNTRY_CODE).then(i.handleErrors).then(function(n){return n.json()}).then(function(t){if(t.data&&t.data.code){var r=t.data.code;n(function(n){return{type:u.FETCH_CC_SUCCESS,payload:n}}(r))}}).catch(function(t){var r=t.message;n((0,o.apiError)({errorType:u.FETCH_CC_ERROR,message:r}))})}};var e,i=r(63),o=r(45),u=r(0),a=r(19),c=(e=a)&&e.__esModule?e:{default:e}},function(n,t,r){var e=r(712),i=r(713);n.exports=function(n,t,r){var o=t&&r||0;"string"==typeof n&&(t="binary"===n?new Array(16):null,n=null);var u=(n=n||{}).random||(n.rng||e)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,t)for(var a=0;a<16;++a)t[o+a]=u[a];return t||i(u)}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initRaven=t.ravenMiddlewareOptions=void 0;var e,i=r(104),o=(e=i)&&e.__esModule?e:{default:e};var u=r(52);t.ravenMiddlewareOptions={getUserContext:function(n){var t=n.user.info||{};return{id:t.id,uuid:t.uuid,email:t.email,country:t.country,domain:t.domain}},stateTransformer:function(n){return{cc:n.cc,activation:n.activation}},actionTransformer:function(){return{}}},t.initRaven=function(){browser.management.getSelf().then(function(n){var t={ignoreErrors:[],ignoreUrls:[],sampleRate:u.SENTRY_SAMPLE_RATE||.2,environment:"production",debug:!1,release:n.version,autoBreadcrumbs:{console:!0,xhr:!0,dom:!0,location:!0,sentry:!0}};o.default.config(u.SENTRY_DSN,t).install()})}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setIconBadgeText=void 0;var e=r(0);t.setIconBadgeText=function(n,t){return Promise.all([browser.browserAction.setBadgeBackgroundColor({color:e.ICON_BADGE_BACKGROUND_COLOR,tabId:n}),browser.browserAction.setBadgeText({text:t,tabId:n})])}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refetchSettings=t.refetchMerchants=t.checkClearApplyingMetaData=t.checkCloseApplyResult=t.checkCloseTab=t.checkDetachStandDownAffiliateNetWork=t.detectPermission=t.resolveMerchantInTab=t.checkPermission=t.T=t.checkTaoBaoProductActivateState=t.deactivateAndRefetchTaoBaoProduct=t.checkActivatedState=t.blockIcon=t.checkIcon=void 0;var e=g(r(38)),i=r(43),o=r(109),u=r(246),a=r(29),c=r(178),f=r(101),s=r(158),l=r(354),v=r(352),d=r(0),p=r(108),h=r(177),_=r(607),b=r(312),E=r(247),O=r(167),y=r(159),m=g(r(64)),T=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(608));function g(n){return n&&n.__esModule?n:{default:n}}var I=t.checkIcon=function(n){return function(t){m.default.info(n,"CHECK_ICON"),T.stopBlink(),m.default.info(n,"icon stop blink");var r=t.url,e=t.merchant,o=t.activated,u=n.getState(),c=(0,i.matchConfirmPage)(u,{url:r});return(0,a.isActivated)(u,{merchant:c})?(T.startBlink(),m.default.info(n,"it was activated and it is confirm page now"),m.default.info(n,"icon start blink")):e?o?(T.green(),m.default.info(n,"it is activated"),m.default.info(n,"icon green")):(0,i.merchantHasCashback)(u,{id:e.id})?(T.startBlink(),m.default.info(n,"it has cashback"),m.default.info(n,"icon start blink")):(T.reset(),m.default.info(n,"it hasn't cashback"),m.default.info(n,"icon reset")):(T.reset(),m.default.warn(n,"it is not merchant - checkIcon"),m.default.info(n,"icon reset")),Promise.resolve(t)}},A=t.blockIcon=function(){return T.stopBlink(),T.block(),Promise.reject("Block Icon")},C=t.checkActivatedState=function(n){return function(t){m.default.info(n,"CHECK_ACTIVATED_STATE");var r=t.merchant,e=t.activated;if(r){var i=n.getState();if(e){var o=r.isTaobao?d.ACTIVATED_EXPIRED_MS_FOR_TAOBAO:d.ACTIVATED_EXPIRED_MS,u=(0,a.getActivatedTimeByMerchant)(i,{merchant:r});u&&(new Date).getTime()-u>o&&(m.default.warn(n,"deactivate merchant id: "+r.id),n.dispatch((0,f.deleteExpiredActivatedMerchant)(r)))}}return Promise.resolve(t)}},S=t.deactivateAndRefetchTaoBaoProduct=function(n,t,r,e){m.default.info(n,"DEACTIVATE_AND_REFRESH_TAOBAO_PRODUCT");var i=t[r].activatedAt;i&&(new Date).getTime()-i>e&&(m.default.warn(n,"deactivate taobao product id: "+r),n.dispatch((0,h.deactivateTaoBaoProduct)({productId:r})),n.dispatch((0,h.fetchTaoBaoProductCashbackStatus)({productId:r})))},w=t.checkTaoBaoProductActivateState=function(n){return function(t){m.default.info(n,"CHECK_TAOBAO_PRODUCT_ACTIVATE_STATE");var r=t.url,e=t.merchant,i=n.getState();if(e&&e.isTaobao){var o=(0,p.getTaoBaoProducts)(i),u=(0,p.getTaoBaoSettings)(i),a=u.timeToDeactivateTaoBaoProduct,c=u.standDownTaoBaoNotifierTimerMs;if((0,p.isTaoBaoProductPage)(i,{url:r})){var f=(0,p.getTaoBaoProductIdByUrl)(i,{url:r}),s=(0,p.getCloseTaoBaoNotifierAt)(i);m.default.info(n,"hit taobao product page: "+r),m.default.info(n,"taobao product id: "+f),o[f]&&S(n,o,f,a),s&&(new Date).getTime()-s>c&&n.dispatch((0,h.openTaoBaoNotifier)())}else(0,p.isTaoBaoShoppingCartPage)(i,{url:r})&&(m.default.info(n,"hit taobao shopping cart page: "+r),Object.keys(o).forEach(function(t){S(n,o,t,a)}))}return Promise.resolve(t)}},N=t.T=function(n,t){return function(r){m.default.info(n,"CHECK_DISABLED");var e=r.merchant;return(0,a.l)(n.getState(),{merchant:e})&&(m.default.info(n,"disable activation merchant.id: "+e.id+", tabId: "+t),n.dispatch((0,f.h)(e,t,!0))),Promise.resolve(r)}},R=t.checkPermission=function(n,t){return function(r){m.default.info(n,"CHECK_PERMISSION");var e=n.getState();if(r)return(0,c.isAnyInvalidPermission)(e)&&(m.default.info(n,"clear invalid permission"),n.dispatch((0,v.cleanInvalidPermission)())),Promise.resolve(t);if(!t.merchant)return(0,c.isAnyInvalidPermission)(e)||n.dispatch((0,v.detectPermissionChange)()),m.default.error(n,"No permission and this tab is not merchant page"),Promise.reject();var i=t.merchant;return(0,c.isRecordPermissionChanged)(e,{merchant:i})?n.dispatch((0,v.checkPermissionNotifierResumable)(i)):n.dispatch((0,v.detectPermissionChange)(i)),m.default.error(n,"No permission and this tab is merchant page"),Promise.reject()}},P=t.resolveMerchantInTab=function(n){return function(t){m.default.info(n,"RESOLVE_MERCHANT_IN_TAB");var r=n.getState(),e=t.url,o=(0,i.matchMerchant)(r,{url:e});return m.default.info(n,"resolve merchant in tab"),m.default.info(n,"url: "+e),o?m.default.info(n,"merchant id: "+o.id):m.default.warn(n,"it is not merchant - resolveMerchantInTab"),Promise.resolve({merchantStateInTab:{url:e,merchant:o,activated:(0,a.isActivated)(r,{merchant:o})},currentTabId:t.id})}},j=t.detectPermission=function(n){return function(t){var r=t.merchantStateInTab;return browser.permissions.contains({origins:["http://*/*","https://*/*"]}).catch(function(){return Promise.resolve(!0)}).then(R(n,r)).catch(A)}},k=t.checkDetachStandDownAffiliateNetWork=function(n,t){m.default.info(n,"CHECK_DETACH_STAND_DOWN_AFFILIATE_NETWORK"),(0,b.isDetectedStandDownAffiliateNetWorks)(n.getState(),{tabId:t})&&n.dispatch((0,_.detachStandDownAffiliateNetwork)(t))},D=t.checkCloseTab=function(n,t){return function(r){var e=r.merchantStateInTab,i=r.currentTabId;m.default.info(n,"CHECK_CLOSE_TAB");var o=n.getState(),u=e.url,a=e.merchant,c=e.activated;return a&&c&&(0,E.isTabReadyToBeClosed)(o,{tabId:t})&&(I(n)({url:u,merchant:a,activated:c}),n.dispatch((0,s.closeTab)({tabId:t}))),Promise.resolve({merchantStateInTab:e,currentTabId:i})}},M=t.checkCloseApplyResult=function(n,t){m.default.info(n,"CHECK_CLOSE_APPLY_RESULT");var r=n.getState(),e=(0,O.getApplyingMetaData)(r,{tabId:t});e&&!e.applying&&e.applyResultOpened&&(n.dispatch((0,y.closeApplyResult)({tabId:t})),n.dispatch((0,y.closeCouponNotifier)({merchantId:e.merchantId})))},L=t.checkClearApplyingMetaData=function(n,t){m.default.info(n,"CHECK_CLEAR_APPLYING_METADATA"),(0,O.getApplyingMetaData)(n.getState(),{tabId:t})&&n.dispatch((0,y.clearApplyingMetaData)({tabId:t}))},U=t.refetchMerchants=function(n){m.default.info(n,"REFETCH_MERCHANT");var t=n.getState();(0,i.shouldFetchMerchants)(t,{now:(new Date).getTime()})&&n.dispatch((0,f.fetchMerchants)(t.cc,!0))},F=t.refetchSettings=function(n){m.default.info(n,"REFETCH_SETTINGS");var t=n.getState();(0,o.shouldFetchSettings)(t,{now:(new Date).getTime()})&&n.dispatch((0,u.fetchSettings)(t.cc))},H={handleActivated:function(n){return function(t){var r=t.tabId;return browser.tabs.get(r).then(P(n)).then(j(n)).then(C(n)).then(w(n)).then(N(n,r)).then(I(n)).catch(function(t){return m.default.error(n,t)})}}};H.handleUpdated=function(n){return function(t){var r=t.tabId;return 0===t.frameId?(U(n),F(n),k(n,r),M(n,r),browser.tabs.query({currentWindow:!0,active:!0}).then(function(n){var t=(0,e.default)(n,1)[0];return Promise.resolve(t)}).then(P(n)).then(D(n,r)).then(function(n){return function(t){var r=t.merchantStateInTab;return t.currentTabId===n?Promise.resolve({merchantStateInTab:r}):Promise.reject("It is not current tab")}}(r)).then(j(n)).then(C(n)).then(w(n)).then(N(n,r)).then(I(n)).catch(function(t){return m.default.error(n,t)})):Promise.resolve()}},H.handleRemove=function(n){return function(t){return L(n,t),n.dispatch((0,l.b)(t)),Promise.resolve()}},t.default=H},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detachStandDownAffiliateNetwork=t.detectStandDownAffiliateNetwork=void 0;var e=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));t.detectStandDownAffiliateNetwork=function(n,t){return{type:e.DETECT_STAND_DOWN_AFFILIATE_NETWORK,payload:{tabId:n,url:t}}},t.detachStandDownAffiliateNetwork=function(n){return{type:e.DETACH_STAND_DOWN_AFFILIATE_NETWORK,payload:{tabId:n}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stopBlink=t.startBlink=t.next=t.block=t.green=t.reset=t.Timer=t.IconCanvas=void 0;var e=o(r(21)),i=o(r(31));function o(n){return n&&n.__esModule?n:{default:n}}var u=["images/icon/blink/icon_00.png","images/icon/blink/icon_01.png","images/icon/blink/icon_02.png","images/icon/blink/icon_03.png","images/icon/blink/icon_04.png","images/icon/blink/icon_05.png","images/icon/blink/icon_06.png","images/icon/blink/icon_07.png","images/icon/blink/icon_08.png","images/icon/blink/icon_09.png","images/icon/blink/icon_10.png","images/icon/blink/icon_11.png","images/icon/blink/icon_12.png","images/icon/blink/icon_13.png","images/icon/blink/icon_14.png","images/icon/blink/icon_15.png","images/icon/blink/icon_16.png","images/icon/blink/icon_17.png","images/icon/blink/icon_18.png","images/icon/blink/icon_19.png","images/icon/blink/icon_20.png","images/icon/blink/icon_21.png","images/icon/blink/icon_22.png","images/icon/blink/icon_23.png","images/icon/blink/icon_24.png","images/icon/blink/icon_25.png","images/icon/blink/icon_26.png","images/icon/blink/icon_27.png","images/icon/blink/icon_28.png","images/icon/blink/icon_29.png","images/icon/blink/icon_30.png","images/icon/blink/icon_31.png","images/icon/blink/icon_32.png","images/icon/blink/icon_33.png","images/icon/blink/icon_34.png","images/icon/blink/icon_35.png","images/icon/blink/icon_36.png","images/icon/blink/icon_37.png","images/icon/blink/icon_38.png","images/icon/blink/icon_39.png"],a=u.map(function(n){var t=new Image;return t.src=browser.runtime.getURL(n),t}),c=t.IconCanvas=function(){function n(){(0,e.default)(this,n),this.canvases=[]}return(0,i.default)(n,[{key:"createCanvas",value:function(n){this.canvases[n]||(this.canvases[n]=document.createElement("canvas"),this.canvases[n].getContext("2d").drawImage(a[n],0,0))}},{key:"draw",value:function(n){if(this.createCanvas(n),this.canvases[n]){var t=this.canvases[n].getContext("2d");browser.browserAction.setIcon({imageData:t.getImageData(0,0,32,32)})}}}]),n}(),f=t.Timer=function(){function n(t){(0,e.default)(this,n),this.timer=null,this.nextHandler=t(this.stop.bind(this))}return(0,i.default)(n,[{key:"stop",value:function(){this.timer&&window.clearInterval(this.timer)}},{key:"start",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,r=0,e=0;this.stop(),this.timer=window.setInterval(function(){r===u.length&&(r=0,e+=1),n.nextHandler(r,e,t),r+=1},50)}}]),n}(),s=(t.reset=function(){return browser.browserAction.setIcon({path:"images/icon/Red-18.png"})},t.green=function(){return browser.browserAction.setIcon({path:"images/icon/Green-18.png"})},t.block=function(){return browser.browserAction.setIcon({path:"images/icon/Permission.png"})},t.next=function(n){return function(t){return function(r,e,i){e===i?t():n.draw(r)}}}),l=void 0,v=function(){if(!l){var n=new c;l=new f(s({draw:function(t){return n.draw(t)}}))}return l};t.startBlink=function(n,t){return function(r){return t(r,n())}}(v,function(n,t){return t.start(n)}),t.stopBlink=function(n,t){return function(){return t(n())}}(v,function(n){return n.stop()})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(n,t,r){"use strict";var e=y(r(38));r(183);var i,o,u,a,c=y(r(364)),f=r(601),s=y(r(710)),l=y(r(19)),v=r(69),d=r(246),p=r(602),h=r(711),_=r(110),b=r(604),E=r(714),O=y(r(750));function y(n){return n&&n.__esModule?n:{default:n}}(0,b.initRaven)(),i=void 0,o=void 0,u=2,(a=new c.default).on("checkInstallOrUpgrade",function(){var n=void 0,t=0;function r(){return!(!i.getState().extension.sbExtId||!i.getState().cc||++t!==u+1||(n&&n(),"install"===o?i.dispatch((0,v.trackExtInstalled)()):i.dispatch((0,v.trackExtUpdated)()),a.removeAllListeners(),0))}return function(){++t!==u||r()||(n=i.subscribe(r))}}()),(0,E.createStoreAsync)().then(function(n){var t=(0,e.default)(n,2),r=t[0],o=t[1],u=void 0===o?{}:o;i=r;var c=!u.cc;c&&r.dispatch((0,h.generateShopBackExtId)()),r.dispatch((0,h.getExtensionSettings)()),c?r.dispatch((0,p.fetchCountryCode)()):r.dispatch((0,d.fetchSettings)(u.cc,!1)),c&&browser.tabs.query({active:!0,currentWindow:!0}).then(function(n){var t=new URL(n[0].url).search,r=l.default.URL_AFTER_INSTALL.concat(t);browser.tabs.create({active:!0,url:r})}),(0,O.default)(r),a.emit("checkInstallOrUpgrade"),(0,_.isLoggerEnabled)(r.getState())&&(0,f.addMiddleware)(s.default),browser.commands.onCommand.addListener(function(n){"toggle-logger"===n&&((0,_.isLoggerEnabled)(r.getState())?((0,f.removeMiddleware)(s.default),console.log("remove logger!")):((0,f.addMiddleware)(s.default),console.log("add logger!")),r.dispatch((0,h.toggleLogger)()))})}),browser.runtime.onInstalled.addListener(function(n){"install"===n.reason||"update"===n.reason?(o=n.reason,a.emit("checkInstallOrUpgrade")):a.removeAllListeners()}),browser.runtime.setUninstallURL(l.default.URL_AFTER_UNINSTALL)},function(n,t,r){(function(n){(function(t){"use strict";function r(n,t){n.super_=t,n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}function e(n,t){Object.defineProperty(this,"kind",{value:n,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function i(n,t,r){i.super_.call(this,"E",n),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:r,enumerable:!0})}function o(n,t){o.super_.call(this,"N",n),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function u(n,t){u.super_.call(this,"D",n),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function a(n,t,r){a.super_.call(this,"A",n),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:r,enumerable:!0})}function c(n,t,r){var e=n.slice((r||t)+1||n.length);return n.length=t<0?n.length+t:t,n.push.apply(n,e),n}function f(n){var t=void 0===n?"undefined":T(n);return"object"!==t?t:n===Math?"math":null===n?"null":Array.isArray(n)?"array":"[object Date]"===Object.prototype.toString.call(n)?"date":"function"==typeof n.toString&&/^\/.*\//.test(n.toString())?"regexp":"object"}function s(n,t,r,e,l,v,d){l=l||[],d=d||[];var p=l.slice(0);if(void 0!==v){if(e){if("function"==typeof e&&e(p,v))return;if("object"===(void 0===e?"undefined":T(e))){if(e.prefilter&&e.prefilter(p,v))return;if(e.normalize){var h=e.normalize(p,v,n,t);h&&(n=h[0],t=h[1])}}}p.push(v)}"regexp"===f(n)&&"regexp"===f(t)&&(n=n.toString(),t=t.toString());var _=void 0===n?"undefined":T(n),b=void 0===t?"undefined":T(t),E="undefined"!==_||d&&d[d.length-1].lhs&&d[d.length-1].lhs.hasOwnProperty(v),O="undefined"!==b||d&&d[d.length-1].rhs&&d[d.length-1].rhs.hasOwnProperty(v);if(!E&&O)r(new o(p,t));else if(!O&&E)r(new u(p,n));else if(f(n)!==f(t))r(new i(p,n,t));else if("date"===f(n)&&n-t!=0)r(new i(p,n,t));else if("object"===_&&null!==n&&null!==t)if(d.filter(function(t){return t.lhs===n}).length)n!==t&&r(new i(p,n,t));else{if(d.push({lhs:n,rhs:t}),Array.isArray(n)){var y;for(n.length,y=0;y<n.length;y++)y>=t.length?r(new a(p,y,new u(void 0,n[y]))):s(n[y],t[y],r,e,p,y,d);for(;y<t.length;)r(new a(p,y,new o(void 0,t[y++])))}else{var m=Object.keys(n),g=Object.keys(t);m.forEach(function(i,o){var u=g.indexOf(i);u>=0?(s(n[i],t[i],r,e,p,i,d),g=c(g,u)):s(n[i],void 0,r,e,p,i,d)}),g.forEach(function(n){s(void 0,t[n],r,e,p,n,d)})}d.length=d.length-1}else n!==t&&("number"===_&&isNaN(n)&&isNaN(t)||r(new i(p,n,t)))}function l(n,t,r,e){return e=e||[],s(n,t,function(n){n&&e.push(n)},r),e.length?e:void 0}function v(n,t,r){if(n&&t&&r&&r.kind){for(var e=n,i=-1,o=r.path?r.path.length-1:0;++i<o;)void 0===e[r.path[i]]&&(e[r.path[i]]="number"==typeof r.path[i]?[]:{}),e=e[r.path[i]];switch(r.kind){case"A":!function n(t,r,e){if(e.path&&e.path.length){var i,o=t[r],u=e.path.length-1;for(i=0;i<u;i++)o=o[e.path[i]];switch(e.kind){case"A":n(o[e.path[i]],e.index,e.item);break;case"D":delete o[e.path[i]];break;case"E":case"N":o[e.path[i]]=e.rhs}}else switch(e.kind){case"A":n(t[r],e.index,e.item);break;case"D":t=c(t,r);break;case"E":case"N":t[r]=e.rhs}return t}(r.path?e[r.path[i]]:e,r.index,r.item);break;case"D":delete e[r.path[i]];break;case"E":case"N":e[r.path[i]]=r.rhs}}}function d(n,t,r,e){var i=l(n,t);try{e?r.groupCollapsed("diff"):r.group("diff")}catch(n){r.log("diff")}i?i.forEach(function(n){var t=n.kind,e=function(n){var t=n.kind,r=n.path,e=n.lhs,i=n.rhs,o=n.index,u=n.item;switch(t){case"E":return[r.join("."),e,"→",i];case"N":return[r.join("."),i];case"D":return[r.join(".")];case"A":return[r.join(".")+"["+o+"]",u];default:return[]}}(n);r.log.apply(r,["%c "+A[t].text,function(n){return"color: "+A[n].color+"; font-weight: bold"}(t)].concat(g(e)))}):r.log("—— no diff ——");try{r.groupEnd()}catch(n){r.log("—— diff end —— ")}}function p(n,t,r,e){switch(void 0===n?"undefined":T(n)){case"object":return"function"==typeof n[e]?n[e].apply(n,g(r)):n[e];case"function":return n(t);default:return n}}function h(n,t){var r=t.logger,e=t.actionTransformer,i=t.titleFormatter,o=void 0===i?function(n){var t=n.timestamp,r=n.duration;return function(n,e,i){var o=["action"];return o.push("%c"+String(n.type)),t&&o.push("%c@ "+e),r&&o.push("%c(in "+i.toFixed(2)+" ms)"),o.join(" ")}}(t):i,u=t.collapsed,a=t.colors,c=t.level,f=t.diff,s=void 0===t.titleFormatter;n.forEach(function(i,l){var v=i.started,h=i.startedTime,_=i.action,b=i.prevState,E=i.error,O=i.took,m=i.nextState,T=n[l+1];T&&(m=T.prevState,O=T.started-v);var g=e(_),I="function"==typeof u?u(function(){return m},_,i):u,A=y(h),C=a.title?"color: "+a.title(g)+";":"",S=["color: gray; font-weight: lighter;"];S.push(C),t.timestamp&&S.push("color: gray; font-weight: lighter;"),t.duration&&S.push("color: gray; font-weight: lighter;");var w=o(g,A,O);try{I?a.title&&s?r.groupCollapsed.apply(r,["%c "+w].concat(S)):r.groupCollapsed(w):a.title&&s?r.group.apply(r,["%c "+w].concat(S)):r.group(w)}catch(n){r.log(w)}var N=p(c,g,[b],"prevState"),R=p(c,g,[g],"action"),P=p(c,g,[E,b],"error"),j=p(c,g,[m],"nextState");if(N)if(a.prevState){var k="color: "+a.prevState(b)+"; font-weight: bold";r[N]("%c prev state",k,b)}else r[N]("prev state",b);if(R)if(a.action){var D="color: "+a.action(g)+"; font-weight: bold";r[R]("%c action    ",D,g)}else r[R]("action    ",g);if(E&&P)if(a.error){var M="color: "+a.error(E,b)+"; font-weight: bold;";r[P]("%c error     ",M,E)}else r[P]("error     ",E);if(j)if(a.nextState){var L="color: "+a.nextState(m)+"; font-weight: bold";r[j]("%c next state",L,m)}else r[j]("next state",m);f&&d(b,m,r,I);try{r.groupEnd()}catch(n){r.log("—— log end ——")}})}function _(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},C,n),r=t.logger,e=t.stateTransformer,i=t.errorTransformer,o=t.predicate,u=t.logErrors,a=t.diffPredicate;if(void 0===r)return function(){return function(n){return function(t){return n(t)}}};if(n.getState&&n.dispatch)return console.error("[redux-logger] redux-logger not installed. Make sure to pass logger instance as middleware:\n// Logger with default options\nimport { logger } from 'redux-logger'\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n// Or you can create your own logger with custom options http://bit.ly/redux-logger-options\nimport createLogger from 'redux-logger'\nconst logger = createLogger({\n  // ...options\n});\nconst store = createStore(\n  reducer,\n  applyMiddleware(logger)\n)\n"),function(){return function(n){return function(t){return n(t)}}};var c=[];return function(n){var r=n.getState;return function(n){return function(f){if("function"==typeof o&&!o(r,f))return n(f);var s={};c.push(s),s.started=m.now(),s.startedTime=new Date,s.prevState=e(r()),s.action=f;var l=void 0;if(u)try{l=n(f)}catch(n){s.error=i(n)}else l=n(f);s.took=m.now()-s.started,s.nextState=e(r());var v=t.diff&&"function"==typeof a?a(r,f):t.diff;if(h(c,Object.assign({},t,{diff:v})),c.length=0,s.error)throw s.error;return l}}}}var b,E,O=function(n,t){return function(n,t){return new Array(t+1).join(n)}("0",t-n.toString().length)+n},y=function(n){return O(n.getHours(),2)+":"+O(n.getMinutes(),2)+":"+O(n.getSeconds(),2)+"."+O(n.getMilliseconds(),3)},m="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date,T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},g=function(n){if(Array.isArray(n)){for(var t=0,r=Array(n.length);t<n.length;t++)r[t]=n[t];return r}return Array.from(n)},I=[];b="object"===(void 0===n?"undefined":T(n))&&n?n:"undefined"!=typeof window?window:{},(E=b.DeepDiff)&&I.push(function(){void 0!==E&&b.DeepDiff===l&&(b.DeepDiff=E,E=void 0)}),r(i,e),r(o,e),r(u,e),r(a,e),Object.defineProperties(l,{diff:{value:l,enumerable:!0},observableDiff:{value:s,enumerable:!0},applyDiff:{value:function(n,t,r){n&&t&&s(n,t,function(e){r&&!r(n,t,e)||v(n,t,e)})},enumerable:!0},applyChange:{value:v,enumerable:!0},revertChange:{value:function(n,t,r){if(n&&t&&r&&r.kind){var e,i,o=n;for(i=r.path.length-1,e=0;e<i;e++)void 0===o[r.path[e]]&&(o[r.path[e]]={}),o=o[r.path[e]];switch(r.kind){case"A":!function n(t,r,e){if(e.path&&e.path.length){var i,o=t[r],u=e.path.length-1;for(i=0;i<u;i++)o=o[e.path[i]];switch(e.kind){case"A":n(o[e.path[i]],e.index,e.item);break;case"D":case"E":o[e.path[i]]=e.lhs;break;case"N":delete o[e.path[i]]}}else switch(e.kind){case"A":n(t[r],e.index,e.item);break;case"D":case"E":t[r]=e.lhs;break;case"N":t=c(t,r)}return t}(o[r.path[e]],r.index,r.item);break;case"D":case"E":o[r.path[e]]=r.lhs;break;case"N":delete o[r.path[e]]}}},enumerable:!0},isConflict:{value:function(){return void 0!==E},enumerable:!0},noConflict:{value:function(){return I&&(I.forEach(function(n){n()}),I=null),l},enumerable:!0}});var A={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}},C={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(n){return n},actionTransformer:function(n){return n},errorTransformer:function(n){return n},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},S=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.dispatch,r=n.getState;return"function"==typeof t||"function"==typeof r?_()({dispatch:t,getState:r}):void console.error("\n[redux-logger v3] BREAKING CHANGE\n[redux-logger v3] Since 3.0.0 redux-logger exports by default logger with default settings.\n[redux-logger v3] Change\n[redux-logger v3] import createLogger from 'redux-logger'\n[redux-logger v3] to\n[redux-logger v3] import { createLogger } from 'redux-logger'\n")};t.defaults=C,t.createLogger=_,t.logger=S,t.default=S,Object.defineProperty(t,"__esModule",{value:!0})})(t)}).call(t,r(20))},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExtensionSettings=function(){return function(n){return browser.management.getSelf().then(function(t){n(function(n){return{type:u.GET_EXTENSION_SETTINGS_SUCCEESS,payload:{id:n.id,name:n.name,version:n.version}}}(t))})}},t.generateShopBackExtId=function(){return{type:u.GEN_SB_EXT_ID,payload:{sbExtId:(0,o.default)()}}},t.toggleLogger=function(){return{type:u.TOGGLE_LOGGER}};var e,i=r(603),o=(e=i)&&e.__esModule?e:{default:e},u=r(0)},function(n,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var e=new Uint8Array(16);n.exports=function(){return r(e),e}}else{var i=new Array(16);n.exports=function(){for(var n,t=0;t<16;t++)0==(3&t)&&(n=4294967296*Math.random()),i[t]=n>>>((3&t)<<3)&255;return i}}},function(n,t){for(var r=[],e=0;e<256;++e)r[e]=(e+256).toString(16).substr(1);n.exports=function(n,t){var e=t||0,i=r;return i[n[e++]]+i[n[e++]]+i[n[e++]]+i[n[e++]]+"-"+i[n[e++]]+i[n[e++]]+"-"+i[n[e++]]+i[n[e++]]+"-"+i[n[e++]]+i[n[e++]]+"-"+i[n[e++]]+i[n[e++]]+i[n[e++]]+i[n[e++]]+i[n[e++]]+i[n[e++]]}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createStoreAsync=void 0;var e=P(r(715)),i=r(156),o=r(100),u=P(r(601)),a=P(r(104)),c=P(r(716));r(157);var f=r(101),s=r(158),l=r(177),v=r(159),d=r(350),p=r(365),h=r(255),_=r(717),b=r(246),E=r(45),O=r(352),y=r(604),m=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(69)),T=P(r(718)),g=P(r(737)),I=P(r(739)),A=P(r(740)),C=P(r(741)),S=P(r(742)),w=P(r(747)),N=P(r(748)),R=P(r(749));function P(n){return n&&n.__esModule?n:{default:n}}var j={SYNC_USER_FROM_SHOPBACK:h.syncUserFromShopBack,CLOSE_MERCHANT_NOTIFIER:f.closeMerchantNotifier,VISIT_ACTIVATED_MERCHANT_NOTIFIER:f.visitActivatedMerchantNotifier,CLOSE_ACTIVATED_MERCHANT_NOTIFIER:f.closeActivatedMerchantNotifier,FETCH_DEALS:_.fetchDeals,FETCH_TOP_MERCHANTS:f.fetchTopMerchants,START_ACTIVATE:f.startActivate,DETECT_SB_REDIRECT_PAGE:f.detectSBRedirectPage,DEEP_LINK_REDIRECT:E.deepLinkRedirect,FETCH_USER_INFO:h.fetchUser,LOGOUT:h.logout,SWITCH_USER:h.switchUser,DIRTY_LOGIN_FROM_MENU:E.dirtyLoginFromMenu,DE_ACTIVATE:f.deActivate,OPEN_POPUP_UI:E.popupOpen,TOGGLE_TRACKING:b.toggleEventTracking,CLOSE_PERMISSION_NOTIFIER:O.closePermissionNotifier,FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS:l.fetchTaoBaoProductCashbackStatus,START_ACTIVATE_TAOBAO_PRODUCT:l.startActivateTaoBaoProduct,DEACTIVATE_TAOBAO_PRODUCT:l.deactivateTaoBaoProduct,TAOBAO_TOGGLE_SEARCH_BOX:l.toggleTaoBaoSearchBox,TAOBAO_OPEN_NOTIFIER:l.openTaoBaoNotifier,TAOBAO_CLOSE_NOTIFIER:l.closeTaoBaoNotifier,TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED:l.setProductFromAiTaoBaoSearchToActivated,TAOBAO_OPEN_CONFIRMATION_NOTIFIER:l.openTaoBaoConfirmationNotifier,TAOBAO_CLOSE_CONFIRMATION_NOTIFIER:l.closeTaoBaoConfirmationNotifier,ACTIVATE_TAOBAO_PRODUCT_FROM_SB:l.activateTaoBaoProductFromSB,FINISH_APPLY_DISCOUNTS:v.finishApplyDiscounts,SET_BEST_PRICE_AND_CODE:v.setBestPriceAndCode,SET_ORIGINAL_PRICE:v.setOriginalPrice,APPLY_DISCOUNTS:v.applyDiscounts,OPEN_NEW_TAB:s.openNewTab,COUPON_OPEN_NOTIFIER:v.openCouponNotifier,COUPON_CLOSE_NOTIFIER:v.closeCouponNotifier,COUPON_OPEN_APPLY_RESULT:v.openApplyResult,COUPON_CLOSE_APPLY_RESULT:v.closeApplyResult,COUPON_OPEN_INTERMEDIATE_APPLY_RESULT:v.openIntermediateApplyResult,COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT:v.closeIntermediateApplyResult,COUPON_CLOSE_APPLIER:v.closeApplier,COUPON_DISAPPEAR_NOTIFIER:v.disappearCouponNotifier,FETCH_COUPONS_BY_MERCHANT:v.fetchCouponsByMerchant,OPEN_MENU_APPLY_CODE_BTN:v.openMenuApplyCodeBtn,CLOSE_MENU_APPLY_CODE_BTN:v.closeMenuApplyCodeBtn,COUPON_CHANGE_APPLY_DISCOUNTS_STATUS:v.changeApplyDiscountsStatus,COUPON_CHANGE_CODE_APPLY_STATUS:v.changeCouponCodeApplyStatus,INITIALIZE_APPLYING_META_DATA:v.initializeApplyingMetaData,MIGRATE_APPLYING_META_DATA:v.migrateApplyingMetaData,FETCH_TRENDING_COUPONS:v.fetchTrendingCoupons,PATCH_COUPON_STATS:v.patchCouponStats,OPEN_TARGETED_AD_NOTIFIER:d.openTargetedAdNotifier,CLOSE_TARGETED_AD_NOTIFIER:d.closeTargetedAdNotifier,CLICK_MENU_CAMPAIGN_NOTIFIER:p.clickMenuCampaignNotifier,EVENT_EXT_LOGIN:m.trackExtSwitchLogin,EVENT_EXT_CLICK:m.trackExtClick,EVENT_EXT_SEARCH:m.trackExtSearch,EVENT_EXT_REDIRECT:m.trackExtRedirect,EVENT_EXT_MENU_OPEN:m.trackExtMenuOpen,EVENT_EXT_PAGE_VISITED:m.trackExtPageVisited,EVENT_EXT_SERP_VISITED:m.trackExtSerpVisited,EVENT_EXT_SERP_CLICKED:m.trackExtSerpClicked,EVENT_EXT_NOTIFIER_PROMPT:m.trackExtNotifierPrompt,EVENT_EXT_APPLY_COUPON_CODE:m.trackExtApplyCouponCode,EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT:m.trackExtNotifierActivatedPrompt,EVENT_EXT_ERROR_OCCURED:m.trackExtErrorOccured,EVENT_EXT_MANUAL_APPLY_COUPON_CODE:m.trackExtManualSuccessfulCode},k=function(n){return(0,o.createStore)(T.default,n,(0,o.applyMiddleware)(e.default,I.default,g.default,C.default,N.default,w.default,S.default,A.default,R.default,(0,c.default)(a.default,y.ravenMiddlewareOptions),u.default))};t.createStoreAsync=function(){return browser.storage.local.get("shopback").then(function(n){var t=n.shopback;return t.extension.loggerEnabled&&console.log("shopback storage: ",t),Promise.resolve([(0,i.createBackgroundStore)({store:k(t),actions:j}),t])}).catch(function(){return Promise.resolve([(0,i.createBackgroundStore)({store:k(),actions:j})])})}},function(n,t,r){"use strict";function e(n){return function(t){var r=t.dispatch,e=t.getState;return function(t){return function(i){return"function"==typeof i?i(r,e,n):t(i)}}}}t.__esModule=!0;var i=e();i.withExtraArgument=e,t.default=i},function(n,t,r){"use strict";var e=function(n){return n},i=function(){},o=function(){return!0};n.exports=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.breadcrumbDataFromAction,u=void 0===r?i:r,a=t.actionTransformer,c=void 0===a?e:a,f=t.stateTransformer,s=void 0===f?e:f,l=t.breadcrumbCategory,v=void 0===l?"redux-action":l,d=t.filterBreadcrumbActions,p=void 0===d?o:d,h=t.getUserContext,_=t.getTags;return function(t){var r=void 0;return n.setDataCallback(function(n,e){var i=t.getState(),o={lastAction:c(r),state:s(i)};return n.extra=Object.assign(o,n.extra),h&&(n.user=h(i)),_&&(n.tags=_(i)),e?e(n):n}),function(t){return function(e){return p(e)&&n.captureBreadcrumb({category:v,message:e.type,data:u(e)}),r=e,t(e)}}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchDeals=function(n){var t=n.merchantId;return function(n,r){return fetch((0,u.getDealsAPI)(r().cc,t),{headers:{Authorization:"Bearer "+r().user.token}}).then(e.handleErrors).then(function(n){return n.json()}).then(function(t){var r;t.data&&n((r=t.data,{type:o.FETCH_DEALS_SUCCESS,payload:r}))}).catch(function(t){var r=t.message;n((0,i.apiError)({errorType:o.FETCH_DEALS_ERROR,message:r}))})}},t.uiFetchDeals=function(n){return{type:o.FETCH_DEALS,merchantId:n}};var e=r(63),i=r(45),o=r(0),u=r(19)},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(100),i=m(r(719)),o=m(r(720)),u=m(r(721)),a=m(r(722)),c=m(r(723)),f=m(r(724)),s=m(r(726)),l=m(r(727)),v=m(r(728)),d=m(r(729)),p=m(r(730)),h=m(r(731)),_=m(r(732)),b=m(r(733)),E=m(r(734)),O=m(r(735)),y=m(r(736));function m(n){return n&&n.__esModule?n:{default:n}}t.default=(0,e.combineReducers)({g:d.default,dirtyRedirect:s.default,activation:f.default,permission:p.default,extension:l.default,merchants:o.default,settings:i.default,deals:u.default,user:a.default,cc:c.default,popupUI:v.default,standDownAffiliateNetworks:h.default,taoBao:_.default,coupons:b.default,readyToBeClosedTabs:E.default,targetedAd:O.default,menuCampaign:y.default})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);var a={sbSitePattern:"https?://(?:[-\\w]*\\.)m?y?shopback\\.(?:(?:\\w{2,3}\\.)?\\w{2,3})",serp:u.SERP_LIST,disableTracking:!1,enableCheckStandDown:!1,standDownRules:{anUrls:["^https?://click\\.linksynergy.com","^https?://affiliate(\\.api)?\\.rakuten\\.com"],params:["afsrc=1"]},taoBao:{},serviceEnableCountry:{ironGate:["AU"],coupons:["SG"],taoBaoLink:["SG","MY","TW"]}};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case u.ENABLE_TRACKING:return(0,o.default)({},n,{disableTracking:!0});case u.DISABLE_TRACKING:return(0,o.default)({},n,{disableTracking:!1});case u.e:return(0,o.default)({},n,t.payload,{fetchedAt:(new Date).getTime()});default:return(0,o.default)({},a,n)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=c(r(75)),i=c(r(197)),o=c(r(5));t.getFormattedCashbackAmount=s,t.getFormattedSerpCashbackInfo=l;var u=r(0),a=r(366);function c(n){return n&&n.__esModule?n:{default:n}}var f={all:[],tops:[]};function s(n,t,r,e){if(n.cashback){var i=u.COUNTRY_LOCALES[e.toLowerCase()],o=u.COUNTRY_CURRENCY_CODES[e.toLowerCase()],c=n.cashback,f=c.modifier,s=c.sign,l=c.amount,v=n.symbol_frontend||"$";v="$"===v?v:v+" ";var d=(0,a.formatCurrency)(parseFloat(l),i,o,v),p="$"===s?""+d:parseFloat(l)+"%",h=r[f],_={"<%MODIFIER%>":(h=h?h.charAt(0).toUpperCase()+h.slice(1):"").trim(),"<%SIGNED_AMOUNT%>":p};return t.replace(/<%MODIFIER%>|<%SIGNED_AMOUNT%>/gi,function(n){return _[n]})}return n.cashback_amount}function l(n,t,r,e,i){var o=s(t,r,e,i),u=t.cashback_amount;return t.cashback&&t.cashback.amount.trim()&&(u=n.replace(/<%CASHBACK_HEADER%>/gi,o)),u}t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments[1];switch(t.type){case u.FETCH_MERCHANTS_SUCCESS:var r=t.payload,a=r.cc,c=r.merchants,v=r.activateX,d=r.loginToActivateX,p=r.cashbackHeader,h=r.reActivateX,_=r.cashbackModifiers,b=r.serpCashbackInfo;return(0,o.default)({},n,{fetchedAt:(new Date).getTime(),all:c.map(function(n){return(0,o.default)({},n,{partnership_stores:Object.assign.apply(Object,[{}].concat((0,i.default)(Object.keys(n.partnership_stores).map(function(t){return(0,e.default)({},t,(0,o.default)({},n.partnership_stores[t],{cashbackHeader:s((0,o.default)({},n.partnership_stores[t],{symbol_frontend:n.symbol_frontend}),p,_,a),reActivateX:s((0,o.default)({},n.partnership_stores[t],{symbol_frontend:n.symbol_frontend}),h,_,a)}))})))),x:s(n,v,_,a),reActivateX:s(n,h,_,a),loginToActivateX:s(n,d,_,a),cashbackHeader:s(n,p,_,a),serpCashbackInfo:l(b,n,p,_,a),closed:!1,isTaobao:"taobao"===n.shortname||"tmall"===n.shortname,isSerpEnabled:!1!==n.is_serp_enabled})})});case u.REFETCH_MERCHANTS_SUCCESS:var E=t.payload,O=E.cc,y=E.merchants,m=E.activateX,T=E.reActivateX,g=E.loginToActivateX,I=E.cashbackHeader,A=E.cashbackModifiers,C=E.serpCashbackInfo;return(0,o.default)({},n,{fetchedAt:(new Date).getTime(),all:y.map(function(t){var r=n.all.find(function(n){return n.id===t.id});return(0,o.default)({},t,{partnership_stores:Object.assign.apply(Object,[{}].concat((0,i.default)(Object.keys(t.partnership_stores).map(function(n){return(0,e.default)({},n,(0,o.default)({},t.partnership_stores[n],{cashbackHeader:s((0,o.default)({},t.partnership_stores[n],{symbol_frontend:t.symbol_frontend}),I,A,O),reActivateX:s((0,o.default)({},t.partnership_stores[n],{symbol_frontend:t.symbol_frontend}),T,A,O)}))})))),x:s(t,m,A,O),reActivateX:s(t,T,A,O),loginToActivateX:s(t,g,A,O),cashbackHeader:s(t,I,A,O),serpCashbackInfo:l(C,t,I,A,O),closed:!!r&&r.closed,isTaobao:"taobao"===t.shortname||"tmall"===t.shortname,isSerpEnabled:!1!==t.is_serp_enabled})})});case u.CLOSE_MERCHANT_NOTIFIER:var S=t.payload.merchantId;return(0,o.default)({},n,{all:n.all.map(function(n){return S===n.id?(0,o.default)({},n,{closed:!0}):n})});case u.DETECT_SB_REDIRECT_PAGE:var w=t.payload.merchantId;return(0,o.default)({},n,{all:n.all.map(function(n){return w===n.id?(0,o.default)({},n,{closed:!1}):n})});case u.STAND_DOWN_MERCHANT_NOTIFIER:var N=t.payload,R=N.merchantId,P=N.standDownTimerId;return(0,o.default)({},n,{all:n.all.map(function(n){return R===n.id?(0,o.default)({},n,{standDown:!0,standDownTimerId:P}):n})});case u.STAND_UP_MERCHANT_NOTIFIER:case u.START_ACTIVATE:var j=t.payload.merchantId;return(0,o.default)({},n,{all:n.all.map(function(n){if(j===n.id){var t=(0,o.default)({},n,{standDown:!1});return delete t.standDownTimerId,t}return n})});case u.OPEN_TAOBAO_SEARCH_BAR:var k=t.payload.merchantId;return(0,o.default)({},n,{all:n.all.map(function(n){return k===n.id&&n.isTaobao?(0,o.default)({},n,{closed:!1}):n})});case u.FETCH_TOP_MERCHANTS_SUCCESS:return(0,o.default)({},n,{tops:t.payload});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(0);t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case e.FETCH_DEALS_SUCCESS:return t.payload;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);var a={token:null,refreshToken:null,tokenDomain:null,info:null,profileId:null,loginHistories:{}};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case u.LOGIN_OK:var r=t.payload,e=r.token,i=r.refreshToken,c=r.tokenDomain,f=r.cc,s=r.profileId,l=(0,o.default)({},n.loginHistories);return l[f]={cc:f,profileId:s,token:e,refreshToken:i,tokenDomain:c},(0,o.default)({},n,{token:e,refreshToken:i,tokenDomain:c,profileId:s,loginHistories:l});case u.SWITCH_USER:var v=t.payload.cc,d=n.loginHistories[v];return d?(0,o.default)({},n,{token:d.token,refreshToken:d.refreshToken,tokenDomain:d.tokenDomain,profileId:d.profileId}):(0,o.default)({},n);case u.FETCH_USER_INFO_ERROR:return(0,o.default)({},n,{info:null});case u.FETCH_USER_INFO_SUCCESS:var p=t.payload.user;return(0,o.default)({},n,{info:p});case u.LOGOUT:var h=t.payload,_=h.cc,b=h.profileId,E=(0,o.default)({},n.loginHistories),O=n.profileId||b;return E[_]?(delete E[_],(0,o.default)({},n,{token:null,refreshToken:null,tokenDomain:null,profileId:O,loginHistories:E})):(0,o.default)({},n,{profileId:O});case u.REFRESH_ACCESS_TOKEN_SUCCESS:var y=t.payload.token;return(0,o.default)({},n,{token:y});default:return(0,o.default)({},a,n)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(0);t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case e.FETCH_CC_SUCCESS:return t.payload;case e.LOGIN_OK:case e.SWITCH_USER:case e.LOGIN_NOT_OK:return t.payload.cc;case e.FETCH_CC_ERROR:return e.DEFAULT_COUNTRY;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(100),o=r(725),u=(e=o)&&e.__esModule?e:{default:e};t.default=(0,i.combineReducers)({byExt:u.default})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(5)),i=u(r(105)),o=r(0);function u(n){return n&&n.__esModule?n:{default:n}}var a={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.LOGOUT:return{};case o.START_ACTIVATE:var r=t.payload,u=r.merchantId,c=r.tabId,f=(0,i.default)(r,["merchantId","tabId"]),s=(0,e.default)({},n);return s[u]=(0,e.default)({},f,{activated:!1,visited:o.ACTIVATED_NOTIFIER_NOT_YET_VISITED,redirectToDeeplink:!1,tabId:c}),s;case o.i:var l=t.payload,v=l.merchantId,d=l.focusing,p=(0,e.default)({},n);return p[v]&&(p[v]=(0,e.default)({},p[v],{activated:!1,disabled:!0,focusing:d})),p;case o.DETECT_SB_REDIRECT_PAGE:var h=t.payload,_=h.merchantId,b=h.referrer,E=(0,i.default)(h,["merchantId","referrer"]),O=n[_],y=(0,e.default)({},n);return y[_]=O?(0,e.default)({},O,E,{disabled:!1,activated:!0,activatedAt:(new Date).getTime(),visited:o.ACTIVATED_NOTIFIER_NOT_YET_VISITED,referrer:O.referrer||b}):(0,e.default)({activated:!0,activatedAt:(new Date).getTime(),visited:o.ACTIVATED_NOTIFIER_NOT_YET_VISITED,redirectToDeeplink:!1,referrer:b},E),y;case o.DE_ACTIVATE:var m=t.payload.merchantId,T=(0,e.default)({},n);return delete T[m],T;case o.DELETE_EXPIRED_ACTIVATED_MERCHANT:var g=t.payload.merchant,I=(0,e.default)({},n);return delete I[g.id],I;case o.DEEP_LINK_REDIRECT:var A=t.payload.merchantId,C=n[A],S=(0,e.default)({},n);return C&&(S[A]=(0,e.default)({},C,{redirectToDeeplink:!0})),S;case o.VISIT_ACTIVATED_MERCHANT_NOTIFIER:case o.OPEN_TAOBAO_SEARCH_BAR:var w=t.payload.merchantId,N=n[w],R=(0,e.default)({},n);return N&&(R[w]=(0,e.default)({},N,{visited:o.ACTIVATED_NOTIFIER_VISITED})),R;case o.CLOSE_ACTIVATED_MERCHANT_NOTIFIER:var P=t.payload.merchantId,j=n[P],k=(0,e.default)({},n);return j&&(k[P]=(0,e.default)({},j,{visited:o.ACTIVATED_NOTIFIER_CLOSED})),k;case o.CLEAN_ACTIVATION:return a;default:return(0,e.default)({},n)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(5)),i=u(r(105)),o=r(0);function u(n){return n&&n.__esModule?n:{default:n}}var a={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.ADD_DIRTY_REDIRECT:var r=t.payload,u=r.tabId,c=(0,i.default)(r,["tabId"]),f=(0,e.default)({},n);return f[u]=(0,e.default)({},c),f;case o.DETECT_SB_REDIRECT_PAGE:var s=t.payload,l=s.tabId,v=s.merchantId,d=(0,e.default)({},n);return d[l]&&d[l].merchantId===v&&delete d[l],d;case o.DIRTY_LOGIN_FROM_MENU:var p=t.payload.from,h=(0,e.default)({},n);return h[p]={},h;case o.CLEAR_DIRTY_LOGIN_FROM_MENU:var _=t.payload.from,b=(0,e.default)({},n);return delete b[_],b;case o.CLEAN_ACTIVATION:return a;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);var a={loggerEnabled:!1};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case u.GET_EXTENSION_SETTINGS_SUCCEESS:var r=t.payload,e=r.id,i=r.name,c=r.version;return(0,o.default)({},n,{id:e,name:i,version:c});case u.GEN_SB_EXT_ID:var f=t.payload.sbExtId;return(0,o.default)({},n,{sbExtId:f});case u.TOGGLE_LOGGER:return(0,o.default)({},n,{loggerEnabled:!n.loggerEnabled});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0);var a={topMerchants:{hasError:!1,loading:!1},myAccount:{hasError:!1,loading:!1}};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;switch(arguments[1].type){case u.FETCH_TOP_MERCHANTS_SUCCESS:return(0,o.default)({},n,{topMerchants:(0,o.default)({},n.topMerchants,{hasError:!1,loading:!1})});case u.FETCH_USER_INFO_SUCCESS:return(0,o.default)({},n,{myAccount:(0,o.default)({},n.myAccount,{hasError:!1,loading:!1})});case u.FETCH_TOP_MERCHANTS_ERROR:return(0,o.default)({},n,{topMerchants:(0,o.default)({},n.topMerchants,{hasError:!0,loading:!1})});case u.FETCH_USER_INFO_ERROR:return(0,o.default)({},n,{myAccount:(0,o.default)({},n.myAccount,{hasError:!0,loading:!1})});case u.SWITCH_USER:return(0,o.default)({},n,{myAccount:(0,o.default)({},n.myAccount,{hasError:!1,loading:!0})});case u.OPEN_POPUP_UI:return(0,o.default)({},n,{topMerchants:(0,o.default)({},n.topMerchants,{hasError:!1,loading:!0}),myAccount:(0,o.default)({},n.myAccount,{hasError:!1,loading:!0})});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(197)),i=u(r(5)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));function u(n){return n&&n.__esModule?n:{default:n}}var a={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.t:var r=t.payload,u=r.tabId,c=r.url,f=(0,i.default)({},n);return f[u]!==o.u&&(n[u]?f[u]=[].concat((0,e.default)(f[u]),[c]):f[u]=[c]),f;case o.r:case o.i:var s=t.payload.tabId,l=(0,i.default)({},n);return delete l[s],l;case o.n:var v=t.payload.tabId,d=(0,i.default)({},n);return d[v]=o.c,d;case o.o:var p=t.payload.tabId,h=(0,i.default)({},n);return h[p]=o.u,h;default:return(0,i.default)({},n)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a(r(75)),i=a(r(5)),o=a(r(105)),u=r(0);function a(n){return n&&n.__esModule?n:{default:n}}var c={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1];switch(t.type){case u.CLEAN_INVALID_PERMISSION:return{};case u.DETECCT_PERMISSION_CHANGE:var r=t.payload,a=r.merchantId,f=(0,o.default)(r,["merchantId"]);return(0,i.default)({},n,(0,e.default)({},a,(0,i.default)({},f)));case u.CLOSE_PERMISSION_NOTIFIER:var s=t.payload,l=s.merchantId,v=(0,o.default)(s,["merchantId"]),d=(0,i.default)({},n);return d[l]=(0,i.default)({},d[l],v),d;case u.RESET_PERMISSION_NOTIFIER:var p=t.payload.merchantId,h=(0,i.default)({},n);return delete h[p].ts,h;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(75)),i=u(r(5)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));function u(n){return n&&n.__esModule?n:{default:n}}var a={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.DETECT_STAND_DOWN_AFFILIATE_NETWORK:var r=t.payload,u=r.tabId,c=r.url;return(0,i.default)({},n,(0,e.default)({},u,c));case o.DETACH_STAND_DOWN_AFFILIATE_NETWORK:var f=t.payload.tabId,s=(0,i.default)({},n);return delete s[f],s;default:return(0,i.default)({},n)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(75)),i=u(r(5)),o=r(0);function u(n){return n&&n.__esModule?n:{default:n}}var a={activatedProductIdInTab:{},searchBoxOpened:!1,confirmationNotifierOpened:!1,taoBaoApiDown:!1,notifierOpened:!0,products:{}};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.FETCH_TAOBAO_PRODUCT_CASHBACK_STATUS_SUCCESS:var r=t.payload,u=r.productId,c=r.hasCashback,f=r.deepLink;return(0,i.default)({},n,{products:(0,i.default)({},n.products,(0,e.default)({},u,(0,i.default)({},n.products[u],{hasCashback:c&&!!f,deepLink:f,activateState:o.ACTIVATE_STATE_NOT_ACTIVATED,fromAiTaoBaoSearch:!1})))});case o.START_ACTIVATE_TAOBAO_PRODUCT:var s=t.payload,l=s.productId,v=s.tabId;return(0,i.default)({},n,{activatedProductIdInTab:(0,i.default)({},n.activatedProductIdInTab,(0,e.default)({},v,l)),products:(0,i.default)({},n.products,(0,e.default)({},l,(0,i.default)({},n.products[l],{activatedAt:(new Date).getTime(),activateState:o.ACTIVATE_STATE_ACTIVATING,redirectedToDeepLink:!1,fromAiTaoBaoSearch:!1,tabId:v})))});case o.START_ACTIVATE:var d=t.payload.tabId,p=(0,i.default)({},n,{activatedProductIdInTab:(0,i.default)({},n.activatedProductIdInTab)});return delete p.activatedProductIdInTab[d],p;case o.DEACTIVATE_TAOBAO_PRODUCT:var h=t.payload.productId,_=(0,i.default)({},n,{products:(0,i.default)({},n.products)});return delete _.products[h],_;case o.TAOBAO_TOGGLE_SEARCH_BOX:return(0,i.default)({},n,{searchBoxOpened:!n.searchBoxOpened});case o.TAOBAO_OPEN_NOTIFIER:var b=(0,i.default)({},n);return delete b.closeTaoBaoNotifierAt,(0,i.default)({},b,{notifierOpened:!0,searchBoxOpened:!1});case o.TAOBAO_CLOSE_NOTIFIER:return(0,i.default)({},n,{closeTaoBaoNotifierAt:(new Date).getTime(),notifierOpened:!1});case o.TAOBAO_OPEN_CONFIRMATION_NOTIFIER:return(0,i.default)({},n,{confirmationNotifierOpened:!0});case o.TAOBAO_CLOSE_CONFIRMATION_NOTIFIER:return(0,i.default)({},n,{confirmationNotifierOpened:!1});case o.TAOBAO_OPEN_API_DOWN_NOTIFIER:return(0,i.default)({},n,{taoBaoApiDown:!0});case o.TAOBAO_CLOSE_API_DOWN_NOTIFIER:return(0,i.default)({},n,{taoBaoApiDown:!1});case o.DEEP_LINK_REDIRECT:var E=t.payload,O=E.productId,y=E.tabId;if(!O)return n;var m=(0,i.default)({},n,{activatedProductIdInTab:(0,i.default)({},n.activatedProductIdInTab)});return delete m.activatedProductIdInTab[y],(0,i.default)({},m,{products:(0,i.default)({},n.products,(0,e.default)({},O,(0,i.default)({},n.products[O],{activateState:o.ACTIVATE_STATE_ACTIVATED,redirectedToDeepLink:!0})))});case o.TAOBAO_SET_PRODUCT_FROM_AI_TAOBAO_SEARCH_TO_ACTIVATED:var T=t.payload.productId;return T?(0,i.default)({},n,{products:(0,i.default)({},n.products,(0,e.default)({},T,(0,i.default)({},n.products[T],{activatedAt:(new Date).getTime(),activateState:o.ACTIVATE_STATE_ACTIVATED,fromAiTaoBaoSearch:!0})))}):n;case o.ACTIVATE_TAOBAO_PRODUCT_FROM_SB:var g=t.payload.productId;return(0,i.default)({},n,{products:(0,i.default)({},n.products,(0,e.default)({},g,(0,i.default)({},n.products[g],{activatedAt:(new Date).getTime(),activateState:o.ACTIVATE_STATE_ACTIVATED,activatedFromSB:!0})))});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=f(r(75)),i=f(r(197)),o=f(r(5)),u=f(r(603)),a=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(102)),c=r(0);function f(n){return n&&n.__esModule?n:{default:n}}var s={checkCodeUrlPatterns:[],merchants:{},deletedMerchants:{},applyingMetaData:{},trendingCouponCodes:[]};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case a.FETCH_TRENDING_COUPONS_SUCCESS:var r=t.payload.trendingCouponCodes;return(0,o.default)({},n,{trendingCouponCodes:r});case a.FETCH_COUPONS_BY_MERCHANT_SUCCESS:var f=t.payload,l=f.couponMerchant,v=f.tabId,d=l.merchantId,p=(0,o.default)({},n,{checkCodeUrlPatterns:[].concat((0,i.default)(n.checkCodeUrlPatterns.filter(function(n){return n.merchantId!==d})),[{merchantId:d,checkCodeUrlPattern:l.checkCodeUrlPattern,method:l.checkCodeUrlRequestMethod}]),merchants:(0,o.default)({},n.merchants,(0,e.default)({},d,(0,o.default)({},n.merchants[d],l,{originalPricePattern:l.pricePattern,expandPattern:l.expandCouponCodeMenuBtnPattern,fetchedAt:(new Date).getTime(),notifierOpened:!0,menuApplyCodeBtnOpened:!1,disappearNotifierSeconds:n.merchants[d]?n.merchants[d].disappearNotifierSeconds:NaN,couponCodesSorted:l.couponCodes.map(function(n){return n.code}),couponCodes:l.couponCodes.reduce(function(n,t){return n[t.code]=(0,o.default)({},t),n},{})}))),applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},v,{merchantId:d,applyingId:(0,u.default)(),applying:!1,applyDiscountsStatus:null,intermediateApplyResultOpened:!1,applyResultOpened:!1,applierOpened:!1,bestPrice:NaN,originalPrice:NaN,applyingCodeIndex:-1,couponCodes:l.couponCodes.reduce(function(n,t){return n[t.code]={applyStatus:a.COUPON_CODE_NOT_APPLIED},n},{})})),deletedMerchants:(0,o.default)({},n.deletedMerchants)});return delete p.merchants[d].pricePattern,delete p.merchants[d].expandCouponCodeMenuBtnPattern,delete p.deletedMerchants[d],p;case a.APPLY_DISCOUNTS:var h=t.payload,_=h.merchantId,b=h.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},b,(0,o.default)({},n.applyingMetaData[b],{merchantId:_,applying:!0,applyDiscountsStatus:a.GET_ORIGINAL_PRICE,applyingCode:"",applyingCodeIndex:-1,originalPrice:NaN,bestPrice:NaN,bestCode:"",applierOpened:!0,intermediateApplyResultOpened:!1,applyResultOpened:!1,couponCodes:Object.keys(n.merchants[_].couponCodes).reduce(function(n,t){return n[t]={applyStatus:a.COUPON_CODE_NOT_APPLIED},n},{})})))});case a.FINISH_APPLY_DISCOUNTS:var E=t.payload.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},E,(0,o.default)({},n.applyingMetaData[E],{applyingId:(0,u.default)(),applying:!1,applierOpened:!1,applyDiscountsStatus:null})))});case a.COUPON_CHANGE_CODE_APPLY_STATUS:var O=t.payload,y=O.tabId,m=O.couponCode,T=O.applyStatus,g=T===a.COUPON_CODE_APPLYING?n.applyingMetaData[y].applyingCodeIndex+1:n.applyingMetaData[y].applyingCodeIndex;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},y,(0,o.default)({},n.applyingMetaData[y],{couponCodes:(0,o.default)({},n.applyingMetaData[y].couponCodes,(0,e.default)({},m,(0,o.default)({},n.applyingMetaData[y].couponCodes[m],{applyStatus:T}))),applyingCode:m,applyingCodeIndex:g})))});case a.SET_BEST_PRICE_AND_CODE:var I=t.payload,A=I.tabId,C=I.bestPrice,S=I.bestCode;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},A,(0,o.default)({},n.applyingMetaData[A],{bestPrice:C,bestCode:S})))});case a.SET_ORIGINAL_PRICE:var w=t.payload,N=w.tabId,R=w.originalPrice;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},N,(0,o.default)({},n.applyingMetaData[N],{originalPrice:R,bestPrice:R})))});case a.COUPON_OPEN_NOTIFIER:var P=t.payload.merchantId;return(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants,(0,e.default)({},P,(0,o.default)({},n.merchants[P],{notifierOpened:!0})))});case a.COUPON_CLOSE_NOTIFIER:var j=t.payload.merchantId;return(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants,(0,e.default)({},j,(0,o.default)({},n.merchants[j],{notifierOpened:!1})))});case a.COUPON_OPEN_APPLY_RESULT:var k=t.payload.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},k,(0,o.default)({},n.applyingMetaData[k],{applyingCode:"",applyingCodeIndex:-1,applyResultOpened:!0})))});case a.COUPON_CLOSE_APPLY_RESULT:var D=t.payload.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},D,(0,o.default)({},n.applyingMetaData[D],{applyResultOpened:!1})))});case a.COUPON_OPEN_INTERMEDIATE_APPLY_RESULT:var M=t.payload.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},M,(0,o.default)({},n.applyingMetaData[M],{intermediateApplyResultOpened:!0})))});case a.COUPON_CLOSE_INTERMEDIATE_APPLY_RESULT:var L=t.payload.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},L,(0,o.default)({},n.applyingMetaData[L],{intermediateApplyResultOpened:!1})))});case a.COUPON_CLOSE_APPLIER:var U=t.payload,F=U.merchantId,H=U.tabId;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},H,(0,o.default)({},n.applyingMetaData[H],{applying:!1,applyingId:(0,u.default)(),applierOpened:!1,intermediateApplyResultOpened:!1,originalPrice:NaN,bestPrice:NaN,bestCode:"",applyDiscountsStatus:null,couponCodes:n.merchants[F].couponCodes})))});case a.OPEN_MENU_APPLY_CODE_BTN:var x=t.payload.merchantId;return(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants,(0,e.default)({},x,(0,o.default)({},n.merchants[x],{menuApplyCodeBtnOpened:!0})))});case a.CLOSE_MENU_APPLY_CODE_BTN:var B=t.payload.merchantId;return(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants,(0,e.default)({},B,(0,o.default)({},n.merchants[B],{menuApplyCodeBtnOpened:!1})))});case a.COUPON_DISAPPEAR_NOTIFIER:var G=t.payload,V=G.merchantId,X=G.disappearNotifierSeconds;return(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants,(0,e.default)({},V,(0,o.default)({},n.merchants[V],{notifierOpened:!1,disappearNotifierSeconds:X})))});case a.COUPON_CHANGE_APPLY_DISCOUNTS_STATUS:var K=t.payload,Y=K.tabId,W=K.applyDiscountsStatus;return(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},Y,(0,o.default)({},n.applyingMetaData[Y],{applyDiscountsStatus:W})))});case c.LOGOUT:case a.CLEAR_COUPONS:return s;case a.SAVE_NON_COUPON_MERCHANT:var z=t.payload.merchantId,Q=(0,o.default)({},n,{merchants:(0,o.default)({},n.merchants),deletedMerchants:(0,o.default)({},n.deletedMerchants,(0,e.default)({},z,{fetchedAt:(new Date).getTime()}))});return delete Q.merchants[z],Q;case a.INITIALIZE_APPLYING_META_DATA_SUCCESS:var $=t.payload,q=$.merchantId,J=$.tabId;return n.merchants[q]?(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData,(0,e.default)({},J,{merchantId:q,applyingId:(0,u.default)(),applying:!1,applyDiscountsStatus:null,intermediateApplyResultOpened:!1,applyResultOpened:!1,applierOpened:!1,bestPrice:NaN,originalPrice:NaN,applyingCodeIndex:-1,couponCodes:Object.keys(n.merchants[q].couponCodes).reduce(function(n,t){return n[t]={applyStatus:a.COUPON_CODE_NOT_APPLIED},n},{})}))}):n;case a.CLEAR_APPLYING_META_DATA:var Z=t.payload.tabId,nn=(0,o.default)({},n,{applyingMetaData:(0,o.default)({},n.applyingMetaData)});return delete nn.applyingMetaData[Z],nn;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=u(r(75)),i=u(r(5)),o=r(0);function u(n){return n&&n.__esModule?n:{default:n}}var a={};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments[1];switch(t.type){case o.OPEN_NEW_TAB:var r=t.payload.tabId;return(0,i.default)({},n,(0,e.default)({},r,!0));case o.CLOSE_TAB:var u=t.payload.tabId,c=(0,i.default)({},n);return delete c[u],c;default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a(r(5)),i=a(r(353)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(254)),u=r(0);function a(n){return n&&n.__esModule?n:{default:n}}var c={startAt:NaN,endAt:NaN,enable:!0,adLink:"",imgLink:"",imgAlt:"",shown:!1,targetedAdNotifierOpened:!1};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1];switch(t.type){case u.e:var r=t.payload.targetedAd,a=(0,e.default)({},n);return delete a.shown,delete a.targetedAdNotifierOpened,(0,i.default)(a,r)?n:(0,e.default)({},r,{shown:!1,targetedAdNotifierOpened:!1});case o.OPEN_TARGETED_AD_NOTIFIER:return(0,e.default)({},n,{shown:!0,targetedAdNotifierOpened:!0});case o.CLOSE_TARGETED_AD_NOTIFIER:return(0,e.default)({},n,{targetedAdNotifierOpened:!1});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=a(r(5)),i=a(r(353)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(351)),u=r(0);function a(n){return n&&n.__esModule?n:{default:n}}var c={startAt:NaN,endAt:NaN,enable:!0,adLink:"",imgLink:"",imgAlt:"",clicked:!1};t.default=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=arguments[1];switch(t.type){case u.e:var r=t.payload.menuCampaign,a=(0,e.default)({},n);return delete a.clicked,(0,i.default)(a,r)?n:(0,e.default)({},r,{clicked:!1});case o.CLICK_MENU_CAMPAIGN_NOTIFIER:return(0,e.default)({},n,{clicked:!0});default:return n}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=f(r(75)),i=f(r(5)),o=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0)),u=r(19),a=r(119),c=r(738);function f(n){return n&&n.__esModule?n:{default:n}}t.default=function(n){return function(t){return function(r){if(n.getState().settings.disableTracking||r.type!==o.EVENT_EXT_LOGIN&&r.type!==o.EVENT_EXT_CLICK&&r.type!==o.EVENT_EXT_SEARCH&&r.type!==o.EVENT_EXT_UPDATED&&r.type!==o.EVENT_EXT_REDIRECT&&r.type!==o.EVENT_EXT_MENU_OPEN&&r.type!==o.EVENT_EXT_INSTALLED&&r.type!==o.EVENT_EXT_PAGE_VISITED&&r.type!==o.EVENT_EXT_SERP_VISITED&&r.type!==o.EVENT_EXT_SERP_CLICKED&&r.type!==o.EVENT_EXT_NOTIFIER_PROMPT&&r.type!==o.EVENT_EXT_APPLY_COUPON_CODE&&r.type!==o.EVENT_EXT_NOTIFIER_ACTIVATED_PROMPT&&r.type!==o.EVENT_EXT_ERROR_OCCURED&&r.type!==o.EVENT_EXT_MANUAL_APPLY_COUPON_CODE)return t(r);var f,s=r.payload,l=n.getState(),v=(0,c.getEventReason)(l.cc,r.type),d={createdAt:Math.floor(Date.now()/1e3),browser:navigator.userAgent,extensionVersion:l.extension.version,extensionId:l.extension.sbExtId,profileId:l.user.profileId||"false",reason:v,uuid:(0,a.isLoggedIn)(l)?l.user.info.uuid:"false"},p=(0,u.getEventTrackingAPI)(l.cc,r.type),h=(0,i.default)({},d,{properties:(0,i.default)({},s)});fetch(p,{method:"POST",headers:(f={},(0,e.default)(f,o.HEADERS.X_SHOPBACK_LAST_CC,l.cc),(0,e.default)(f,o.HEADERS.CONTENT_TYPE,"application/json"),f),body:JSON.stringify(h)}).then(function(){return Promise.resolve()})}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEventReason=void 0;var e=r(0);t.getEventReason=function(n,t){var r=e.USER_DATA_POLICY_PAGE_URLS[n.toLowerCase()]||e.DEFAULT_USER_DATA_POLICY_URL;return(e.EVENT_REASONS_MAP[t]||e.DEFAULT_EVENT_REASON)+" "+r}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(0));var i=[e.GEN_SB_EXT_ID,e.FETCH_CC_SUCCESS,e.LOGIN_OK,e.LOGOUT,e.SWITCH_USER,e.LOGIN_NOT_OK,e.REFRESH_ACCESS_TOKEN_SUCCESS,e.ENABLE_TRACKING,e.DISABLE_TRACKING,e.GET_EXTENSION_SETTINGS_SUCCEESS,e.TOGGLE_LOGGER];t.default=function(n){return function(t){return function(r){return i.indexOf(r.type)>-1&&browser.storage.local.get("shopback").then(function(t){var r=t.shopback||{};r.cc=n.getState().cc,r.user=n.getState().user,r.extension=n.getState().extension,r.settings={},r.settings.disableTracking=n.getState().settings.disableTracking,browser.storage.local.set({shopback:r})}),t(r)}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(0);t.default=function(){return function(n){return function(t){return t.type===e.API_ERROR?(browser.storage.local.get("apiErrReport").then(function(n){var r=n.apiErrReport||[],e=Date.now();r.push({key:e,event:t.payload}),browser.storage.local.set({apiErrReport:r})}),n({type:t.payload.errorType,payload:t.payload.message})):n(t)}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0),a=r(43);t.default=function(n){return function(t){return function(r){if(r.type===u.DETECT_SB_REDIRECT_PAGE||r.type===u.START_ACTIVATE||r.type===u.DE_ACTIVATE){var e=r.payload.merchantId,i=(0,a.findMerchant)(n.getState(),{id:e});if(i&&i.isTaobao)return void(0,a.findTaobaoRelatedMerchant)(n.getState()).forEach(function(n){var e=n.id;t((0,o.default)({},r,{payload:(0,o.default)({},r.payload,{merchantId:e})}))})}return t(r)}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformCouponMerchant=void 0;var e=l(r(5)),i=r(206),o=l(r(226)),u=l(r(743)),a=r(0),c=r(102),f=r(605),s=r(250);function l(n){return n&&n.__esModule?n:{default:n}}var v=function(n){return JSON.parse(i.AES.decrypt(n,"WVd4dmFHOXRiM0po").toString(i.enc.Utf8))},d=t.transformCouponMerchant=function(n){var t=c.DEFAULT_APPLY_DISCOUNTS_PRESTEPS,r=c.DEFAULT_APPLY_CODE_STEPS;if(!(0,o.default)(n.applyDiscountsPreSteps))try{t=JSON.parse(n.applyDiscountsPreSteps)}catch(n){(0,s.noop)()}if(!(0,o.default)(n.applyCodeSteps))try{r=JSON.parse(n.applyCodeSteps)}catch(n){(0,s.noop)()}return(0,e.default)({},n,{couponCodes:(0,u.default)(n.couponCodes,"code"),applyDiscountsPreSteps:t,applyCodeSteps:r})};t.default=function(){return function(n){return function(t){var r=t.payload,e=t.type;switch(e){case a.e:r._=v(r._);break;case c.FETCH_COUPONS_BY_MERCHANT_SUCCESS:if(r.couponMerchant){r.couponMerchant=d(v(r.couponMerchant));var i=Array.isArray(r.couponMerchant.couponCodes)?r.couponMerchant.couponCodes.length:0;i>0&&(0,f.setIconBadgeText)(r.tabId,i.toString())}break;case c.FETCH_TRENDING_COUPONS_SUCCESS:r.trendingCouponCodes=v(r.trendingCouponCodes);break;default:return n(t)}return n({type:e,payload:r})}}}},function(n,t,r){var e=r(291),i=r(744);n.exports=function(n,t){return n&&n.length?i(n,e(t,2)):[]}},function(n,t,r){var e=r(248),i=r(306),o=r(745),u=r(249),a=r(746),c=r(215),f=200;n.exports=function(n,t,r){var s=-1,l=i,v=n.length,d=!0,p=[],h=p;if(r)d=!1,l=o;else if(v>=f){var _=t?null:a(n);if(_)return c(_);d=!1,l=u,h=new e}else h=t?[]:p;n:for(;++s<v;){var b=n[s],E=t?t(b):b;if(b=r||0!==b?b:0,d&&E==E){for(var O=h.length;O--;)if(h[O]===E)continue n;t&&h.push(E),p.push(b)}else l(h,E,r)||(h!==p&&h.push(E),p.push(b))}return p}},function(n,t){n.exports=function(n,t,r){for(var e=-1,i=null==n?0:n.length;++e<i;)if(r(t,n[e]))return!0;return!1}},function(n,t,r){var e=r(199),i=r(311),o=r(215),u=e&&1/o(new e([,-0]))[1]==1/0?function(n){return new e(n)}:i;n.exports=u},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(0),i=r(43),o=r(354);t.default=function(n){return function(t){return function(r){var u=t(r);if(r.type===e.i){var a=r.payload.merchantId;browser.tabs.query({}).then(function(t){return Promise.resolve(t.filter(function(t){var r=t.url,e=(0,i.matchMerchant)(n.getState(),{url:r});return e&&e.id===a}))}).then(function(t){return Promise.resolve(t.map(function(t){return n.dispatch((0,o.b)(t.id))}))}).catch(function(){})}return u}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0),a=r(43);t.default=function(n){return function(t){return function(r){if(r.type===u.DETECT_SB_REDIRECT_PAGE||r.type===u.START_ACTIVATE||r.type===u.DE_ACTIVATE){var e=r.payload.merchantId,i=(0,a.findPartnershipMerchant)(n.getState(),{id:e});if(i)return void t((0,o.default)({},r,{payload:(0,o.default)({},r.payload,{partnershipId:e,merchantId:i.id})}))}return t(r)}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(5),o=(e=i)&&e.__esModule?e:{default:e},u=r(0),a=r(101),c=r(43);t.default=function(n){return function(t){return function(r){switch(r.type){case u.STAND_DOWN_MERCHANT_NOTIFIER:var e=r.payload.merchantId,i=setTimeout(function(){return n.dispatch((0,a.standUpMerchantNotifier)({merchantId:e}))},u.STAND_DOWN_MERCHANT_NOTIFIER_TIMER_MS);return t((0,o.default)({},r,{payload:(0,o.default)({},r.payload,{standDownTimerId:i})}));case u.START_ACTIVATE:case u.STAND_UP_MERCHANT_NOTIFIER:var f=r.payload.merchantId,s=(0,c.getStandDownNotifierTimerId)(n.getState(),{id:f});return s&&clearTimeout(s),t(r);default:return t(r)}}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=r(19),i=s(r(606)),o=s(r(751)),u=r(752),a=r(753),c=r(755),f=s(r(757));function s(n){return n&&n.__esModule?n:{default:n}}t.default=function(n){browser.tabs.onActivated.addListener(i.default.handleActivated(n)),browser.tabs.onRemoved.addListener(i.default.handleRemove(n)),browser.webNavigation.onDOMContentLoaded.addListener(i.default.handleUpdated(n)),browser.webRequest.onHeadersReceived.addListener((0,u.handleRequestHeadersReceived)(n),{urls:(0,e.listWebsiteLoginAPIPatterns)()},["responseHeaders"]),browser.webRequest.onBeforeRedirect.addListener((0,u.onBeforeRedirect)(n),{urls:["http://*/*","https://*/*"],types:["main_frame"]},["responseHeaders"]),browser.webRequest.onResponseStarted.addListener((0,u.handleResponseStart)(n),{urls:["http://*/*","https://*/*"],types:["main_frame","xmlhttprequest"]},["responseHeaders"]),browser.webNavigation.onCommitted.addListener((0,a.onCommitFacade)(n)),browser.runtime.onMessage.addListener((0,c.handleOnMessage)(n)),(0,f.default)(n),browser.windows.onFocusChanged.addListener(o.default.handleFocusChanged(n))}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e,i=r(64),o=(e=i)&&e.__esModule?e:{default:e},u=r(606);var a,c=function(n){var t=n.tabs.find(function(n){return!0===n.active});return t&&t.url?Promise.resolve(t):Promise.reject()},f=(a=null,{handleFocusChanged:function(n){return function(t){return t&&-1!==t&&t!==a?(a=t,o.default.info(n,"window focus changes, windowId: "+t),browser.windows.getLastFocused({populate:!0}).then(c).then((0,u.resolveMerchantInTab)(n)).then((0,u.detectPermission)(n)).then((0,u.checkIcon)(n)).catch(function(t){return o.default.error(n,t)})):Promise.resolve()}}});t.default=f},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleResponseStart=t.checkCouponCodeRequests=t.onBeforeRedirect=t.checkStandDownAffiliateNetwork=t.I=t.handleRequestHeadersReceived=t.checkRedirect=void 0;var e=h(r(38)),i=r(43),o=r(69),u=r(45),a=r(354),c=r(607),f=r(19),s=r(0),l=r(159),v=r(167),d=r(102),p=h(r(64));function h(n){return n&&n.__esModule?n:{default:n}}var _=t.checkRedirect=function(n,t){var r=t.tabId,e=t.statusCode,a=t.responseHeaders,c=t.url,l=n.getState(),v=l.dirtyRedirect,d=Object.keys(v).find(function(n){return parseInt(n,10)===r});if(p.default.info("status code: "+e),200===e){var h=a.find(function(n){return"x-shopback-authenticated"===n.name});if(p.default.info(n,"authenticated: "+h),p.default.info(n,"authenticated.value: "+h.value),h&&"false"===h.value)return;if(d){p.default.info(n,"login successfully");var _=void 0,b=v[d],E=b.merchantId,O=b.searchItem,y=b.from,m=(0,i.findMerchant)(l,{id:E}),T=m.isTaobao,g=m.activation_url;if(n.dispatch((0,o.trackExtLogin)(y,new URL(c).host,"success",c)),T)return _=(0,f.getTaobaoActivatePage)(g,E,O),browser.tabs.update(r,{url:_})}else{if(v[s.MENU_ACCOUNT_LOGIN])return n.dispatch((0,o.trackExtLogin)(s.MENU_ACCOUNT_LOGIN.replace(/_/g," "),new URL(c).host,"success",c)),void n.dispatch((0,u.clearDirtyLoginFromMenu)(s.MENU_ACCOUNT_LOGIN));v[s.MENU_ACCOUNT_SWITCH_POPUP]&&(n.dispatch((0,o.trackExtLogin)(s.MENU_ACCOUNT_SWITCH_POPUP.replace(/_/g," "),new URL(c).host,"success",c)),n.dispatch((0,u.clearDirtyLoginFromMenu)(s.MENU_ACCOUNT_SWITCH_POPUP)))}}},b=(t.handleRequestHeadersReceived=function(n){return function(t){p.default.info("handle request headers received"),_(n,t)}},t.I=function(n,t){if(t&&t.url){var r=t.tabId,e=t.url,i=n.getState().settings._;if(i&&i.marketplace){var o=i.marketplace.find(function(n){return new RegExp(n).test(e)});if(o)return p.default.warn(n,"match affiliate network: "+o),void n.dispatch((0,a.m)(r,e))}if(i&&i.travel){var u=i.travel.find(function(n){return new RegExp(n).test(e)});u&&(p.default.warn(n,"match affiliate network travel: "+u),n.dispatch((0,a.m)(r,e)))}}}),E=t.checkStandDownAffiliateNetwork=function(n,t){if(t&&t.url){var r=t.tabId,i=t.url,o=n.getState().settings,u=o.enableCheckStandDown,a=o.standDownRules;if(u&&a&&(a.anUrls||a.params)){p.default.warn(n,"checkStandDownAffiliateNetwork:");var f=new URL(i);p.default.info(n,"url: "+i);var s=!!a.anUrls&&a.anUrls.some(function(n){return new RegExp(n).test(i)}),l=!!a.params&&a.params.some(function(n){var t=n.split("="),r=(0,e.default)(t,2),i=r[0],o=r[1];return f.searchParams.get(i)===o});p.default.warn(n,"matchedAnUrls - checkStandDown: "+s),p.default.warn(n,"matchedParams - checkStandDown: "+l),(s||l)&&n.dispatch((0,c.detectStandDownAffiliateNetwork)(r,i))}}},O=(t.onBeforeRedirect=function(n){return function(t){b(n,t),E(n,t)}},t.checkCouponCodeRequests=function(n,t){if(t&&t.url&&t.tabId>0){var r=n.getState(),e=t.url,i=t.method,o=t.tabId;if(!(0,v.isCheckCodeResponse)(r,{url:e,method:i,tabId:o}))return void p.default.info(n,"it is not checkCouponCodeRequest: "+e);if((0,v.isApplyingDiscounts)(r,{tabId:o})){p.default.info(n,"it is applying coupon code now");var u=(0,v.getApplyingStatusCode)(r,{tabId:o});u&&(p.default.info(n,u+" is being applied"),n.dispatch((0,l.changeCouponCodeApplyStatus)({tabId:o,couponCode:u,applyStatus:d.COUPON_CODE_VERIFIED})),n.dispatch((0,l.changeApplyDiscountsStatus)({tabId:o,applyDiscountsStatus:d.VERIFIED})))}else(0,v.isApplyResultOpened)(r,{tabId:o})||browser.tabs.query({active:!0,currentWindow:!0}).then(function(n){n.length>0&&n[0]&&browser.tabs.onUpdated.addListener(function t(r,e){"complete"===e.status&&r===n[0].id&&(browser.tabs.onUpdated.removeListener(t),browser.tabs.sendMessage(n[0].id,{action:d.MANUAL_APPLY_COUPON_CODE}))})})}});t.handleResponseStart=function(n){return function(t){O(n,t)}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onCommitFacade=t.checkStandDown=t.T=t.reloadWhenActivated=t.C=void 0;var e=d(r(38)),i=r(19),o=r(43),u=r(101),a=r(354),c=r(29),f=r(754),s=r(0),l=d(r(64)),v=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t.default=n,t}(r(608));function d(n){return n&&n.__esModule?n:{default:n}}var p=function(n,t,r){var e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];l.default.warn(n,"disable merchant - webNavigation: "+t.id),n.dispatch((0,u.h)(t,r,e)),v.startBlink()},h=t.C=function(n,t){var r=t.url,e=t.tabId;(0,i.isRedirectPage)(n.getState().cc,r)&&(l.default.info(n,"detect SB redirect page - webNavigation"),l.default.info(n,"url: "+r),n.dispatch((0,a.y)(e)))},_={reloadWhenActivated:t.reloadWhenActivated=function(n,t,r,e){var i=e.url,u=e.tabId,c=n.getState();if(t&&r&&(0,f.w)(c,{tabId:u})&&(0,o.isReloadNecessaryMerchant)(c,{merchant:t})){var v=new URL(i);return browser.tabs.query({}).then(function(n){return Promise.resolve(n.filter(function(n){var t=n.url,r=n.id,e=(0,o.matchMerchant)(c,{url:t});return(0,o.isReloadNecessaryMerchant)(c,{merchant:e})&&!(0,o.isInConfirmPage)(null,{url:t,merchant:e})&&r!==u}))}).then(function(t){return Promise.resolve(t.map(function(t){return n.dispatch((0,a.O)(t.id)),t}))}).then(function(n){return Promise.all([n.map(function(n){var t=n.id,r=n.url,e=c.cc.toLowerCase(),i=new URL(r),o=s.COUNTRY_BOOKING_IDENTIFIER[e]?s.COUNTRY_BOOKING_IDENTIFIER[e].aid:s.COUNTRY_BOOKING_IDENTIFIER.com.aid,u=v.searchParams.get("aid")||o;return i.searchParams.set("aid",u),i.searchParams.set("label",v.searchParams.get("label")),browser.tabs.update(t,{url:i.toString()})})])}).catch(function(t){return l.default.error(n,t)})}return Promise.resolve()},C:h,T:t.T=function(n,t,r,i){var s=i.tabId,v=n.getState();if(t&&r){if((0,f.j)(v,{tabId:s}))return browser.tabs.query({currentWindow:!0,active:!0}).then(function(r){var i=(0,e.default)(r,1)[0];p(n,t,s,i&&i.id===s)}).catch(function(){p(n,t,s)});if((0,f.k)(v,{tabId:s}))(0,o.isReloadNecessaryMerchant)(v,{merchant:t})?n.dispatch((0,a.O)(s)):n.dispatch((0,a.b)(s));else{if(!(0,f.w)(v,{tabId:s}))return browser.tabs.executeScript(s,{code:"document.referrer;"}).then(function(r){(0,o.p)(n.getState(),{referrer:r,merchant:t})&&(l.default.warn(n,"it is invalid travel merchant referrer"),l.default.warn(n,"referrer: "+r),l.default.warn(n,"merchant id: "+t.id+", tabId: "+s),p(n,t,s))}).catch(function(t){return l.default.error(n,t)});n.dispatch((0,a.b)(s))}}else t&&(0,c.d)(v,{merchant:t})?(l.default.warn(n,"it is merchant and is disabled and user is focusing"),n.dispatch((0,u.deActivate)({merchantId:t.id}))):t&&!r&&(l.default.warn(n,"it is merchant but not activated"),n.dispatch((0,a.b)(s)));return Promise.resolve()},checkStandDown:t.checkStandDown=function(n,t,r,e){var i=e.url,a=e.tabId;if((0,o.isInConfirmPage)(null,{merchant:t,url:i}))n.dispatch((0,u.standUpMerchantNotifier)({merchantId:t.id}));else{var c=n.getState(),s=c.standDownAffiliateNetworks[a];l.default.info(n,"anUrl: "+s),s&&t&&!r&&(0,f.j)(c,{tabId:a})&&n.dispatch((0,u.standDownMerchantNotifier)({merchantId:t.id}))}},onCommitFacade:t.onCommitFacade=function(n){return function(t){if(_.C(n,t),"auto_subframe"!==t.transitionType){var r=n.getState(),e=(0,o.matchMerchant)(r,{url:t.url}),i=(0,c.isActivated)(r,{merchant:e});_.checkStandDown(n,e,i,t),_.T(n,e,i,t),_.reloadWhenActivated(n,e,i,t)}}}};t.default=_},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.w=t.k=t.j=void 0;var e=r(17),i=r(0),o=function(n){return n.g},u=function(n,t){return t.tabId};t.j=(0,e.createSelector)([o,u],function(n,t){return void 0!==n[t]&&n[t]!==i.u&&n[t]!==i.c}),t.k=(0,e.createSelector)([o,u],function(n,t){return void 0!==n[t]&&n[t]===i.u}),t.w=(0,e.createSelector)([o,u],function(n,t){return void 0!==n[t]&&n[t]===i.c})},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleOnMessage=void 0;var e=r(101),i=r(605),o=f(r(104)),u=r(0),a=f(r(64)),c=f(r(756));function f(n){return n&&n.__esModule?n:{default:n}}t.handleOnMessage=function(n){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];switch(t.action){case u.CAPTURE_MERCHANT_PAGE_HTML:return a.default.info(n,u.CAPTURE_MERCHANT_PAGE_HTML),c.default.processCapturedHtml(n,t);case u.ACTIVATE_FROM_POPUP:a.default.info(n,u.ACTIVATE_FROM_POPUP);var f=t.nextUrl,s=t.prevUrl,l=t.fromTopMerchants,v=t.merchantId,d=function(){return n.dispatch((0,e.startActivate)({merchantId:v,prevUrl:s,forceToSetReferrer:!l,from:u.MENU_STORE}))};return l?(a.default.info(n,"activate from top merchant"),browser.tabs.create({url:f}).then(function(){return d()})):(d(),browser.tabs.update({url:f}));case u.SENTRY_ERROR_LOGGING:return a.default.error(n,u.SENTRY_ERROR_LOGGING),a.default.error(n,t.errorMessage),a.default.error(n,t.extra),o.default.captureMessage(t.errorMessage,{extra:t.extra}),Promise.reject(t);case u.OPEN_BROWESER_SETTING_PAGE:return a.default.info(n,u.OPEN_BROWESER_SETTING_PAGE),browser.runtime.getBrowserInfo?browser.runtime.openOptionsPage():browser.tabs.create({url:"chrome://extensions/?id="+browser.runtime.id});case u.GET_TAB_OF_CONTENT_SCRIPT:return a.default.info(n,u.GET_TAB_OF_CONTENT_SCRIPT),Promise.resolve(r.tab);case u.SET_ICON_BADGE_TEXT:a.default.info(n,u.SET_ICON_BADGE_TEXT);var p=r.tab.id,h=t.totalCodes;return(0,i.setIconBadgeText)(p,h.toString());default:return Promise.resolve(t)}}}},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=l(r(75)),i=r(29),o=r(43),u=r(101),a=r(19),c=r(0),f=r(149),s=l(r(64));function l(n){return n&&n.__esModule?n:{default:n}}var v={getActivationInfo:function(n,t){var r=(0,i.getActivatedMerchantInfo)(n,{merchant:t});if(r)return{shoppingTripId:r.shoppingtripId,activatedAt:r.activatedAt}},sendDataToParseService:function(n,t){var r,i=(0,a.getHtmlParseServiceUrl)(n),o=(r={},(0,e.default)(r,c.HEADERS.ACCEPT,"application/json"),(0,e.default)(r,c.HEADERS.CONTENT_TYPE,"application/json"),(0,e.default)(r,c.HEADERS.X_SHOPBACK_LAST_CC,n),r);s.default.info("fetch parse Service url ",i),fetch(i,{method:"POST",headers:o,body:JSON.stringify(t)}).then(function(n){return n.json()}).then(function(n){console.log(n)}).catch(function(n){return console.log(n)})},processCapturedHtml:function(n,t){s.default.info(n,"process capture html");var r=n.getState(),e=v.getActivationInfo(r,t.merchant),a=r.user.tokenDomain,l={action:c.CAPTURE_MERCHANT_PAGE_HTML,status:"skipped"};if(e&&a){var d={shoppingTripCreatedAt:(0,f.toSBFormat)(new Date(e.activatedAt)),url:t.url,extension_id:r.extension.id,domain:a,activatedAt:e.activatedAt,shoppingTripUUID:e.shoppingTripId,htmlSource:t.htmlSource};v.sendDataToParseService(r.cc,d),l.status="sent",l.data=d;var p=(0,o.matchConfirmPage)(r,{url:t.url});(0,i.isActivated)(r,{merchant:p})&&n.dispatch((0,u.deActivate)({merchantId:t.merchant.id}))}return Promise.resolve(l)}};t.default=v},function(n,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleChange=void 0,t.createCountryCodeListener=d;var e,i=r(101),o=r(246),u=r(602),a=r(45),c=r(159),f=r(119),s=r(109),l=r(64),v=(e=l)&&e.__esModule?e:{default:e};function d(n){var t=n.getState().cc;return function(r){if(v.default.info(n,"nextCC: "+r+", cc: "+t),r!==t){var e=!t;return t=r,n.dispatch((0,a.cleanActivation)()),n.dispatch((0,c.clearCoupons)()),(0,f.isLogoutAllSBAccount)(n.getState(),{cc:t})?n.dispatch((0,u.fetchCountryCode)()):((0,s.couponsEnabled)(n.getState())&&n.dispatch((0,c.fetchTrendingCoupons)()),n.dispatch((0,o.fetchSettings)(t,!e)),n.dispatch((0,i.fetchTopMerchants)(t)))}return Promise.resolve()}}var p=t.handleChange=function(n,t){return function(){t(n.getState().cc)}};t.default=function(n){n.subscribe(p(n,d(n)))}}],[709]);